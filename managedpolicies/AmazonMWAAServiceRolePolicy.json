{"name": "AmazonMWAAServiceRolePolicy", "deprecated": false, "createdate": "2020-11-24T14:13:41Z", "updatedate": "2020-11-24T14:13:41+00:00", "version": "v1", "malformed": false, "unknown_actions": [], "access_levels": ["Write", "Tagging", "List", "Permissions management"], "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["logs:CreateLogStream", "logs:CreateLogGroup", "logs:DescribeLogGroups"], "Resource": "arn:aws:logs:*:*:log-group:airflow-*:*"}, {"Effect": "Allow", "Action": ["ec2:AttachNetworkInterface", "ec2:CreateNetworkInterface", "ec2:CreateNetworkInterfacePermission", "ec2:DeleteNetworkInterface", "ec2:DeleteNetworkInterfacePermission", "ec2:DescribeDhcpOptions", "ec2:DescribeNetworkInterfaces", "ec2:DescribeSecurityGroups", "ec2:DescribeSubnets", "ec2:DescribeVpcEndpoints", "ec2:DescribeVpcs", "ec2:DetachNetworkInterface"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:CreateVpcEndpoint"], "Resource": "arn:aws:ec2:*:*:vpc-endpoint/*", "Condition": {"ForAnyValue:StringEquals": {"aws:TagKeys": "AmazonMWAAManaged"}}}, {"Effect": "Allow", "Action": ["ec2:ModifyVpcEndpoint", "ec2:DeleteVpcEndpoints"], "Resource": "arn:aws:ec2:*:*:vpc-endpoint/*", "Condition": {"Null": {"aws:ResourceTag/AmazonMWAAManaged": false}}}, {"Effect": "Allow", "Action": ["ec2:CreateVpcEndpoint", "ec2:ModifyVpcEndpoint"], "Resource": ["arn:aws:ec2:*:*:vpc/*", "arn:aws:ec2:*:*:security-group/*", "arn:aws:ec2:*:*:subnet/*"]}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": "arn:aws:ec2:*:*:vpc-endpoint/*", "Condition": {"StringEquals": {"ec2:CreateAction": "CreateVpcEndpoint"}, "ForAnyValue:StringEquals": {"aws:TagKeys": "AmazonMWAAManaged"}}}]}, "effective_actions": [{"action": "logs:CreateLogStream", "effective_action": "logs:CreateLogStream", "access_levels": "Write", "condition": null}, {"action": "logs:CreateLogGroup", "effective_action": "logs:CreateLogGroup", "access_levels": "Write", "condition": null}, {"action": "logs:DescribeLogGroups", "effective_action": "logs:DescribeLogGroups", "access_levels": "List", "condition": null}, {"action": "ec2:AttachNetworkInterface", "effective_action": "ec2:AttachNetworkInterface", "access_levels": "Write", "condition": null}, {"action": "ec2:CreateNetworkInterface", "effective_action": "ec2:CreateNetworkInterface", "access_levels": "Write", "condition": null}, {"action": "ec2:CreateNetworkInterfacePermission", "effective_action": "ec2:CreateNetworkInterfacePermission", "access_levels": "Permissions management", "condition": null}, {"action": "ec2:DeleteNetworkInterface", "effective_action": "ec2:DeleteNetworkInterface", "access_levels": "Write", "condition": null}, {"action": "ec2:DeleteNetworkInterfacePermission", "effective_action": "ec2:DeleteNetworkInterfacePermission", "access_levels": "Permissions management", "condition": null}, {"action": "ec2:DescribeDhcpOptions", "effective_action": "ec2:DescribeDhcpOptions", "access_levels": "List", "condition": null}, {"action": "ec2:DescribeNetworkInterfaces", "effective_action": "ec2:DescribeNetworkInterfaces", "access_levels": "List", "condition": null}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_levels": "List", "condition": null}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_levels": "List", "condition": null}, {"action": "ec2:DescribeVpcEndpoints", "effective_action": "ec2:DescribeVpcEndpoints", "access_levels": "List", "condition": null}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_levels": "List", "condition": null}, {"action": "ec2:DetachNetworkInterface", "effective_action": "ec2:DetachNetworkInterface", "access_levels": "Write", "condition": null}, {"action": "ec2:CreateVpcEndpoint", "effective_action": "ec2:CreateVpcEndpoint", "access_levels": "Write", "condition": {"ForAnyValue:StringEquals": {"aws:TagKeys": "AmazonMWAAManaged"}}}, {"action": "ec2:ModifyVpcEndpoint", "effective_action": "ec2:ModifyVpcEndpoint", "access_levels": "Write", "condition": {"Null": {"aws:ResourceTag/AmazonMWAAManaged": false}}}, {"action": "ec2:DeleteVpcEndpoints", "effective_action": "ec2:DeleteVpcEndpoints", "access_levels": "Write", "condition": {"Null": {"aws:ResourceTag/AmazonMWAAManaged": false}}}, {"action": "ec2:CreateVpcEndpoint", "effective_action": "ec2:CreateVpcEndpoint", "access_levels": "Write", "condition": null}, {"action": "ec2:ModifyVpcEndpoint", "effective_action": "ec2:ModifyVpcEndpoint", "access_levels": "Write", "condition": null}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_levels": "Tagging", "condition": {"StringEquals": {"ec2:CreateAction": "CreateVpcEndpoint"}, "ForAnyValue:StringEquals": {"aws:TagKeys": "AmazonMWAAManaged"}}}]}