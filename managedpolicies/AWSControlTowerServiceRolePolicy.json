{"name": "AWSControlTowerServiceRolePolicy", "deprecated": false, "createdate": "2021-06-04T23:00:46Z", "updatedate": "2021-06-04T23:00:46+00:00", "version": "v7", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write"], "privesc": true, "resource_exposure": true, "credentials_exposure": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["cloudformation:CreateStack", "cloudformation:CreateStackInstances", "cloudformation:CreateStackSet", "cloudformation:DeleteStack", "cloudformation:DeleteStackInstances", "cloudformation:DeleteStackSet", "cloudformation:DescribeStackInstance", "cloudformation:DescribeStacks", "cloudformation:DescribeStackSet", "cloudformation:DescribeStackSetOperation", "cloudformation:ListStackInstances", "cloudformation:UpdateStack", "cloudformation:UpdateStackInstances", "cloudformation:UpdateStackSet"], "Resource": ["arn:aws:cloudformation:*:*:type/resource/AWS-IAM-Role"]}, {"Effect": "Allow", "Action": ["cloudformation:CreateStack", "cloudformation:CreateStackInstances", "cloudformation:CreateStackSet", "cloudformation:DeleteStack", "cloudformation:DeleteStackInstances", "cloudformation:DeleteStackSet", "cloudformation:DescribeStackInstance", "cloudformation:DescribeStacks", "cloudformation:DescribeStackSet", "cloudformation:DescribeStackSetOperation", "cloudformation:GetTemplate", "cloudformation:ListStackInstances", "cloudformation:UpdateStack", "cloudformation:UpdateStackInstances", "cloudformation:UpdateStackSet"], "Resource": ["arn:aws:cloudformation:*:*:stack/AWSControlTower*/*", "arn:aws:cloudformation:*:*:stack/StackSet-AWSControlTower*/*", "arn:aws:cloudformation:*:*:stackset/AWSControlTower*:*", "arn:aws:cloudformation:*:*:stackset-target/AWSControlTower*/*"]}, {"Effect": "Allow", "Action": ["cloudtrail:CreateTrail", "cloudtrail:DeleteTrail", "cloudtrail:GetTrailStatus", "cloudtrail:StartLogging", "cloudtrail:StopLogging", "cloudtrail:UpdateTrail", "cloudtrail:PutEventSelectors", "logs:CreateLogStream", "logs:PutLogEvents", "logs:PutRetentionPolicy"], "Resource": ["arn:aws:logs:*:*:log-group:aws-controltower/CloudTrailLogs:*", "arn:aws:cloudtrail:*:*:trail/aws-controltower*"]}, {"Effect": "Allow", "Action": ["s3:GetObject"], "Resource": ["arn:aws:s3:::aws-controltower*/*"]}, {"Effect": "Allow", "Action": ["sts:AssumeRole"], "Resource": ["arn:aws:iam::*:role/AWSControlTowerExecution"]}, {"Effect": "Allow", "Action": ["cloudtrail:DescribeTrails", "ec2:DescribeAvailabilityZones", "iam:ListRoles", "logs:CreateLogGroup", "logs:DescribeLogGroups", "organizations:CreateAccount", "organizations:DescribeAccount", "organizations:DescribeCreateAccountStatus", "organizations:DescribeOrganization", "organizations:DescribeOrganizationalUnit", "organizations:DescribePolicy", "organizations:ListAccounts", "organizations:ListAccountsForParent", "organizations:ListAWSServiceAccessForOrganization", "organizations:ListChildren", "organizations:ListOrganizationalUnitsForParent", "organizations:ListParents", "organizations:ListPoliciesForTarget", "organizations:ListTargetsForPolicy", "organizations:ListRoots", "organizations:MoveAccount", "servicecatalog:AssociatePrincipalWithPortfolio"], "Resource": "*"}, {"Effect": "Allow", "Action": ["iam:GetRole", "iam:GetUser", "iam:ListAttachedRolePolicies", "iam:GetRolePolicy"], "Resource": "*"}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": ["arn:aws:iam::*:role/service-role/AWSControlTowerStackSetRole", "arn:aws:iam::*:role/service-role/AWSControlTowerCloudTrailRole", "arn:aws:iam::*:role/service-role/AWSControlTowerConfigAggregatorRoleForOrganizations"]}, {"Effect": "Allow", "Action": ["config:DeleteConfigurationAggregator", "config:PutConfigurationAggregator", "config:TagResource"], "Resource": "*", "Condition": {"StringEquals": {"aws:ResourceTag/aws-control-tower": "managed-by-control-tower"}}}, {"Effect": "Allow", "Action": ["organizations:EnableAWSServiceAccess"], "Resource": "*", "Condition": {"StringLike": {"organizations:ServicePrincipal": "config.amazonaws.com"}}}]}, "effective_actions": [{"action": "cloudformation:CreateStack", "effective_action": "cloudformation:CreateStack", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:CreateStackInstances", "effective_action": "cloudformation:CreateStackInstances", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:CreateStackSet", "effective_action": "cloudformation:CreateStackSet", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DeleteStack", "effective_action": "cloudformation:DeleteStack", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DeleteStackInstances", "effective_action": "cloudformation:DeleteStackInstances", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DeleteStackSet", "effective_action": "cloudformation:DeleteStackSet", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DescribeStackInstance", "effective_action": "cloudformation:DescribeStackInstance", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DescribeStacks", "effective_action": "cloudformation:DescribeStacks", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DescribeStackSet", "effective_action": "cloudformation:DescribeStackSet", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DescribeStackSetOperation", "effective_action": "cloudformation:DescribeStackSetOperation", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:ListStackInstances", "effective_action": "cloudformation:ListStackInstances", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:UpdateStack", "effective_action": "cloudformation:UpdateStack", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:UpdateStackInstances", "effective_action": "cloudformation:UpdateStackInstances", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:UpdateStackSet", "effective_action": "cloudformation:UpdateStackSet", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:CreateStack", "effective_action": "cloudformation:CreateStack", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:CreateStackInstances", "effective_action": "cloudformation:CreateStackInstances", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:CreateStackSet", "effective_action": "cloudformation:CreateStackSet", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DeleteStack", "effective_action": "cloudformation:DeleteStack", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DeleteStackInstances", "effective_action": "cloudformation:DeleteStackInstances", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DeleteStackSet", "effective_action": "cloudformation:DeleteStackSet", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DescribeStackInstance", "effective_action": "cloudformation:DescribeStackInstance", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DescribeStacks", "effective_action": "cloudformation:DescribeStacks", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DescribeStackSet", "effective_action": "cloudformation:DescribeStackSet", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:DescribeStackSetOperation", "effective_action": "cloudformation:DescribeStackSetOperation", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:GetTemplate", "effective_action": "cloudformation:GetTemplate", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:ListStackInstances", "effective_action": "cloudformation:ListStackInstances", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:UpdateStack", "effective_action": "cloudformation:UpdateStack", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:UpdateStackInstances", "effective_action": "cloudformation:UpdateStackInstances", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudformation:UpdateStackSet", "effective_action": "cloudformation:UpdateStackSet", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:CreateTrail", "effective_action": "cloudtrail:CreateTrail", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:DeleteTrail", "effective_action": "cloudtrail:DeleteTrail", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:GetTrailStatus", "effective_action": "cloudtrail:GetTrailStatus", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:StartLogging", "effective_action": "cloudtrail:StartLogging", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:StopLogging", "effective_action": "cloudtrail:StopLogging", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:UpdateTrail", "effective_action": "cloudtrail:UpdateTrail", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:PutEventSelectors", "effective_action": "cloudtrail:PutEventSelectors", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "logs:CreateLogStream", "effective_action": "logs:CreateLogStream", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "logs:PutLogEvents", "effective_action": "logs:PutLogEvents", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "logs:PutRetentionPolicy", "effective_action": "logs:PutRetentionPolicy", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "sts:AssumeRole", "effective_action": "sts:AssumeRole", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": true}, {"action": "cloudtrail:DescribeTrails", "effective_action": "cloudtrail:DescribeTrails", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeAvailabilityZones", "effective_action": "ec2:DescribeAvailabilityZones", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:ListRoles", "effective_action": "iam:ListRoles", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "logs:CreateLogGroup", "effective_action": "logs:CreateLogGroup", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "logs:DescribeLogGroups", "effective_action": "logs:DescribeLogGroups", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:CreateAccount", "effective_action": "organizations:CreateAccount", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:DescribeAccount", "effective_action": "organizations:DescribeAccount", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:DescribeCreateAccountStatus", "effective_action": "organizations:DescribeCreateAccountStatus", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:DescribeOrganization", "effective_action": "organizations:DescribeOrganization", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:DescribeOrganizationalUnit", "effective_action": "organizations:DescribeOrganizationalUnit", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:DescribePolicy", "effective_action": "organizations:DescribePolicy", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:ListAccounts", "effective_action": "organizations:ListAccounts", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:ListAccountsForParent", "effective_action": "organizations:ListAccountsForParent", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:ListAWSServiceAccessForOrganization", "effective_action": "organizations:ListAWSServiceAccessForOrganization", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:ListChildren", "effective_action": "organizations:ListChildren", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:ListOrganizationalUnitsForParent", "effective_action": "organizations:ListOrganizationalUnitsForParent", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:ListParents", "effective_action": "organizations:ListParents", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:ListPoliciesForTarget", "effective_action": "organizations:ListPoliciesForTarget", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:ListTargetsForPolicy", "effective_action": "organizations:ListTargetsForPolicy", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:ListRoots", "effective_action": "organizations:ListRoots", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:MoveAccount", "effective_action": "organizations:MoveAccount", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "servicecatalog:AssociatePrincipalWithPortfolio", "effective_action": "servicecatalog:AssociatePrincipalWithPortfolio", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:GetRole", "effective_action": "iam:GetRole", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:GetUser", "effective_action": "iam:GetUser", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:ListAttachedRolePolicies", "effective_action": "iam:ListAttachedRolePolicies", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:GetRolePolicy", "effective_action": "iam:GetRolePolicy", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": null, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "config:DeleteConfigurationAggregator", "effective_action": "config:DeleteConfigurationAggregator", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/aws-control-tower": "managed-by-control-tower"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "config:PutConfigurationAggregator", "effective_action": "config:PutConfigurationAggregator", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/aws-control-tower": "managed-by-control-tower"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "config:TagResource", "effective_action": "config:TagResource", "access_level": "Tagging", "condition": {"StringEquals": {"aws:ResourceTag/aws-control-tower": "managed-by-control-tower"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "organizations:EnableAWSServiceAccess", "effective_action": "organizations:EnableAWSServiceAccess", "access_level": "Write", "condition": {"StringLike": {"organizations:ServicePrincipal": "config.amazonaws.com"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}]}