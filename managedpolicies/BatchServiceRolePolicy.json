{"name": "BatchServiceRolePolicy", "deprecated": false, "createdate": "2021-03-25T22:50:04Z", "updatedate": "2021-03-25T22:50:04+00:00", "version": "v3", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["ec2:DescribeAccountAttributes", "ec2:DescribeInstances", "ec2:DescribeInstanceAttribute", "ec2:DescribeSubnets", "ec2:DescribeSecurityGroups", "ec2:DescribeKeyPairs", "ec2:DescribeImages", "ec2:DescribeImageAttribute", "ec2:DescribeSpotInstanceRequests", "ec2:DescribeSpotFleetInstances", "ec2:DescribeSpotFleetRequests", "ec2:DescribeSpotPriceHistory", "ec2:DescribeVpcClassicLink", "ec2:DescribeLaunchTemplateVersions", "ec2:RequestSpotFleet", "autoscaling:DescribeAccountLimits", "autoscaling:DescribeAutoScalingGroups", "autoscaling:DescribeLaunchConfigurations", "autoscaling:DescribeAutoScalingInstances", "ecs:DescribeClusters", "ecs:DescribeContainerInstances", "ecs:DescribeTaskDefinition", "ecs:DescribeTasks", "ecs:ListClusters", "ecs:ListContainerInstances", "ecs:ListTaskDefinitionFamilies", "ecs:ListTaskDefinitions", "ecs:ListTasks", "ecs:DeregisterTaskDefinition", "ecs:TagResource", "ecs:ListAccountSettings", "logs:DescribeLogGroups", "iam:GetInstanceProfile", "iam:GetRole"], "Resource": "*"}, {"Effect": "Allow", "Action": ["logs:CreateLogGroup", "logs:CreateLogStream"], "Resource": "arn:aws:logs:*:*:log-group:/aws/batch/job*"}, {"Effect": "Allow", "Action": ["logs:PutLogEvents"], "Resource": "arn:aws:logs:*:*:log-group:/aws/batch/job*:log-stream:*"}, {"Effect": "Allow", "Action": ["autoscaling:CreateOrUpdateTags"], "Resource": "*", "Condition": {"Null": {"aws:RequestTag/AWSBatchServiceTag": "false"}}}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": ["*"], "Condition": {"StringEquals": {"iam:PassedToService": ["ec2.amazonaws.com", "ec2.amazonaws.com.cn", "ecs-tasks.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["iam:CreateServiceLinkedRole"], "Resource": "*", "Condition": {"StringEquals": {"iam:AWSServiceName": ["spot.amazonaws.com", "spotfleet.amazonaws.com", "autoscaling.amazonaws.com", "ecs.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["ec2:CreateLaunchTemplate"], "Resource": "*", "Condition": {"Null": {"aws:RequestTag/AWSBatchServiceTag": "false"}}}, {"Effect": "Allow", "Action": ["ec2:TerminateInstances", "ec2:CancelSpotFleetRequests", "ec2:ModifySpotFleetRequest", "ec2:DeleteLaunchTemplate"], "Resource": "*", "Condition": {"Null": {"aws:ResourceTag/AWSBatchServiceTag": "false"}}}, {"Effect": "Allow", "Action": ["autoscaling:CreateLaunchConfiguration", "autoscaling:DeleteLaunchConfiguration"], "Resource": "arn:aws:autoscaling:*:*:launchConfiguration:*:launchConfigurationName/AWSBatch*"}, {"Effect": "Allow", "Action": ["autoscaling:CreateAutoScalingGroup", "autoscaling:UpdateAutoScalingGroup", "autoscaling:SetDesiredCapacity", "autoscaling:DeleteAutoScalingGroup", "autoscaling:SuspendProcesses", "autoscaling:PutNotificationConfiguration", "autoscaling:TerminateInstanceInAutoScalingGroup"], "Resource": "arn:aws:autoscaling:*:*:autoScalingGroup:*:autoScalingGroupName/AWSBatch*"}, {"Effect": "Allow", "Action": ["ecs:DeleteCluster", "ecs:DeregisterContainerInstance", "ecs:RunTask", "ecs:StartTask", "ecs:StopTask"], "Resource": "arn:aws:ecs:*:*:cluster/AWSBatch*"}, {"Effect": "Allow", "Action": ["ecs:RunTask", "ecs:StartTask", "ecs:StopTask"], "Resource": "arn:aws:ecs:*:*:task-definition/*"}, {"Effect": "Allow", "Action": ["ecs:StopTask"], "Resource": "arn:aws:ecs:*:*:task/*/*"}, {"Effect": "Allow", "Action": ["ecs:CreateCluster", "ecs:RegisterTaskDefinition"], "Resource": "*", "Condition": {"Null": {"aws:RequestTag/AWSBatchServiceTag": "false"}}}, {"Effect": "Allow", "Action": ["ec2:RunInstances"], "Resource": ["arn:aws:ec2:*::image/*", "arn:aws:ec2:*::snapshot/*", "arn:aws:ec2:*:*:subnet/*", "arn:aws:ec2:*:*:network-interface/*", "arn:aws:ec2:*:*:security-group/*", "arn:aws:ec2:*:*:volume/*", "arn:aws:ec2:*:*:key-pair/*", "arn:aws:ec2:*:*:launch-template/*", "arn:aws:ec2:*:*:placement-group/*", "arn:aws:ec2:*:*:capacity-reservation/*", "arn:aws:ec2:*:*:elastic-gpu/*", "arn:aws:elastic-inference:*:*:elastic-inference-accelerator/*"]}, {"Effect": "Allow", "Action": ["ec2:RunInstances"], "Resource": "arn:aws:ec2:*:*:instance/*", "Condition": {"Null": {"aws:RequestTag/AWSBatchServiceTag": "false"}}}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["*"], "Condition": {"StringEquals": {"ec2:CreateAction": ["RunInstances", "CreateLaunchTemplate", "RequestSpotFleet"]}}}]}, "effective_actions": [{"action": "ec2:DescribeAccountAttributes", "effective_action": "ec2:DescribeAccountAttributes", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstanceAttribute", "effective_action": "ec2:DescribeInstanceAttribute", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeKeyPairs", "effective_action": "ec2:DescribeKeyPairs", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeImageAttribute", "effective_action": "ec2:DescribeImageAttribute", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSpotInstanceRequests", "effective_action": "ec2:DescribeSpotInstanceRequests", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSpotFleetInstances", "effective_action": "ec2:DescribeSpotFleetInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSpotFleetRequests", "effective_action": "ec2:DescribeSpotFleetRequests", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSpotPriceHistory", "effective_action": "ec2:DescribeSpotPriceHistory", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcClassicLink", "effective_action": "ec2:DescribeVpcClassicLink", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeLaunchTemplateVersions", "effective_action": "ec2:DescribeLaunchTemplateVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:RequestSpotFleet", "effective_action": "ec2:RequestSpotFleet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "autoscaling:DescribeAccountLimits", "effective_action": "autoscaling:DescribeAccountLimits", "access_level": "List", "condition": null, "privesc": false}, {"action": "autoscaling:DescribeAutoScalingGroups", "effective_action": "autoscaling:DescribeAutoScalingGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "autoscaling:DescribeLaunchConfigurations", "effective_action": "autoscaling:DescribeLaunchConfigurations", "access_level": "List", "condition": null, "privesc": false}, {"action": "autoscaling:DescribeAutoScalingInstances", "effective_action": "autoscaling:DescribeAutoScalingInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ecs:DescribeClusters", "effective_action": "ecs:DescribeClusters", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ecs:DescribeContainerInstances", "effective_action": "ecs:DescribeContainerInstances", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ecs:DescribeTaskDefinition", "effective_action": "ecs:DescribeTaskDefinition", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ecs:DescribeTasks", "effective_action": "ecs:DescribeTasks", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ecs:ListClusters", "effective_action": "ecs:ListClusters", "access_level": "List", "condition": null, "privesc": false}, {"action": "ecs:ListContainerInstances", "effective_action": "ecs:ListContainerInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ecs:ListTaskDefinitionFamilies", "effective_action": "ecs:ListTaskDefinitionFamilies", "access_level": "List", "condition": null, "privesc": false}, {"action": "ecs:ListTaskDefinitions", "effective_action": "ecs:ListTaskDefinitions", "access_level": "List", "condition": null, "privesc": false}, {"action": "ecs:ListTasks", "effective_action": "ecs:ListTasks", "access_level": "List", "condition": null, "privesc": false}, {"action": "ecs:DeregisterTaskDefinition", "effective_action": "ecs:DeregisterTaskDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:TagResource", "effective_action": "ecs:TagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "ecs:ListAccountSettings", "effective_action": "ecs:ListAccountSettings", "access_level": "Read", "condition": null, "privesc": false}, {"action": "logs:DescribeLogGroups", "effective_action": "logs:DescribeLogGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "iam:GetInstanceProfile", "effective_action": "iam:GetInstanceProfile", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:GetRole", "effective_action": "iam:GetRole", "access_level": "Read", "condition": null, "privesc": false}, {"action": "logs:CreateLogGroup", "effective_action": "logs:CreateLogGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "logs:CreateLogStream", "effective_action": "logs:CreateLogStream", "access_level": "Write", "condition": null, "privesc": false}, {"action": "logs:PutLogEvents", "effective_action": "logs:PutLogEvents", "access_level": "Write", "condition": null, "privesc": false}, {"action": "autoscaling:CreateOrUpdateTags", "effective_action": "autoscaling:CreateOrUpdateTags", "access_level": "Tagging", "condition": {"Null": {"aws:RequestTag/AWSBatchServiceTag": "false"}}, "privesc": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": ["ec2.amazonaws.com", "ec2.amazonaws.com.cn", "ecs-tasks.amazonaws.com"]}}, "privesc": true}, {"action": "iam:CreateServiceLinkedRole", "effective_action": "iam:CreateServiceLinkedRole", "access_level": "Write", "condition": {"StringEquals": {"iam:AWSServiceName": ["spot.amazonaws.com", "spotfleet.amazonaws.com", "autoscaling.amazonaws.com", "ecs.amazonaws.com"]}}, "privesc": false}, {"action": "ec2:CreateLaunchTemplate", "effective_action": "ec2:CreateLaunchTemplate", "access_level": "Write", "condition": {"Null": {"aws:RequestTag/AWSBatchServiceTag": "false"}}, "privesc": false}, {"action": "ec2:TerminateInstances", "effective_action": "ec2:TerminateInstances", "access_level": "Write", "condition": {"Null": {"aws:ResourceTag/AWSBatchServiceTag": "false"}}, "privesc": false}, {"action": "ec2:CancelSpotFleetRequests", "effective_action": "ec2:CancelSpotFleetRequests", "access_level": "Write", "condition": {"Null": {"aws:ResourceTag/AWSBatchServiceTag": "false"}}, "privesc": false}, {"action": "ec2:ModifySpotFleetRequest", "effective_action": "ec2:ModifySpotFleetRequest", "access_level": "Write", "condition": {"Null": {"aws:ResourceTag/AWSBatchServiceTag": "false"}}, "privesc": false}, {"action": "ec2:DeleteLaunchTemplate", "effective_action": "ec2:DeleteLaunchTemplate", "access_level": "Write", "condition": {"Null": {"aws:ResourceTag/AWSBatchServiceTag": "false"}}, "privesc": false}, {"action": "autoscaling:CreateLaunchConfiguration", "effective_action": "autoscaling:CreateLaunchConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "autoscaling:DeleteLaunchConfiguration", "effective_action": "autoscaling:DeleteLaunchConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "autoscaling:CreateAutoScalingGroup", "effective_action": "autoscaling:CreateAutoScalingGroup", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "autoscaling:UpdateAutoScalingGroup", "effective_action": "autoscaling:UpdateAutoScalingGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "autoscaling:SetDesiredCapacity", "effective_action": "autoscaling:SetDesiredCapacity", "access_level": "Write", "condition": null, "privesc": false}, {"action": "autoscaling:DeleteAutoScalingGroup", "effective_action": "autoscaling:DeleteAutoScalingGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "autoscaling:SuspendProcesses", "effective_action": "autoscaling:SuspendProcesses", "access_level": "Write", "condition": null, "privesc": false}, {"action": "autoscaling:PutNotificationConfiguration", "effective_action": "autoscaling:PutNotificationConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "autoscaling:TerminateInstanceInAutoScalingGroup", "effective_action": "autoscaling:TerminateInstanceInAutoScalingGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:DeleteCluster", "effective_action": "ecs:DeleteCluster", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:DeregisterContainerInstance", "effective_action": "ecs:DeregisterContainerInstance", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:RunTask", "effective_action": "ecs:RunTask", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:StartTask", "effective_action": "ecs:StartTask", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:StopTask", "effective_action": "ecs:StopTask", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:RunTask", "effective_action": "ecs:RunTask", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:StartTask", "effective_action": "ecs:StartTask", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:StopTask", "effective_action": "ecs:StopTask", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:StopTask", "effective_action": "ecs:StopTask", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ecs:CreateCluster", "effective_action": "ecs:CreateCluster", "access_level": "Write", "condition": {"Null": {"aws:RequestTag/AWSBatchServiceTag": "false"}}, "privesc": false}, {"action": "ecs:RegisterTaskDefinition", "effective_action": "ecs:RegisterTaskDefinition", "access_level": "Write", "condition": {"Null": {"aws:RequestTag/AWSBatchServiceTag": "false"}}, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": {"Null": {"aws:RequestTag/AWSBatchServiceTag": "false"}}, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringEquals": {"ec2:CreateAction": ["RunInstances", "CreateLaunchTemplate", "RequestSpotFleet"]}}, "privesc": false}]}