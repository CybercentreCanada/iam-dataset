{"name": "AmazonEKSConnectorServiceRolePolicy", "deprecated": false, "createdate": "2021-09-04T20:31:08Z", "updatedate": "2021-09-04T20:31:08+00:00", "version": "v1", "malformed": false, "unknown_actions": [], "access_levels": ["Read", "Write"], "privesc": true, "resource_exposure": true, "credentials_exposure": false, "undocumented_actions": false, "document": {"Version": "2012-10-17", "Statement": [{"Sid": "AccessSSMService", "Effect": "Allow", "Action": ["ssm:CreateActivation", "ssm:DescribeInstanceInformation", "ssm:DeleteActivation"], "Resource": "*"}, {"Sid": "ConnectorAgentStartSession", "Effect": "Allow", "Action": ["ssm:StartSession"], "Resource": ["arn:aws:eks:*:*:cluster/*", "arn:aws:ssm:*::document/AmazonEKS-ExecuteNonInteractiveCommand"]}, {"Sid": "ConnectorAgentDeregister", "Effect": "Allow", "Action": ["ssm:DeregisterManagedInstance"], "Resource": ["arn:aws:eks:*:*:cluster/*"]}, {"Sid": "PassAnyRoleToSsm", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "*", "Condition": {"StringEquals": {"iam:PassedToService": ["ssm.amazonaws.com"]}}}, {"Sid": "PutManagedEventRule", "Effect": "Allow", "Action": ["events:PutRule"], "Resource": "*", "Condition": {"StringEquals": {"events:ManagedBy": "eks-connector.amazonaws.com", "events:source": "aws.ssm"}}}, {"Sid": "PutManagedEventTarget", "Effect": "Allow", "Action": ["events:PutTargets"], "Resource": "*", "Condition": {"StringEquals": {"events:ManagedBy": "eks-connector.amazonaws.com"}}}]}, "effective_actions": [{"action": "ssm:CreateActivation", "effective_action": "ssm:CreateActivation", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ssm:DescribeInstanceInformation", "effective_action": "ssm:DescribeInstanceInformation", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ssm:DeleteActivation", "effective_action": "ssm:DeleteActivation", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ssm:StartSession", "effective_action": "ssm:StartSession", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ssm:DeregisterManagedInstance", "effective_action": "ssm:DeregisterManagedInstance", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": ["ssm.amazonaws.com"]}}, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "events:PutRule", "effective_action": "events:PutRule", "access_level": "Write", "condition": {"StringEquals": {"events:ManagedBy": "eks-connector.amazonaws.com", "events:source": "aws.ssm"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "events:PutTargets", "effective_action": "events:PutTargets", "access_level": "Write", "condition": {"StringEquals": {"events:ManagedBy": "eks-connector.amazonaws.com"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}]}