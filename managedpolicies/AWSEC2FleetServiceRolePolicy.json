{"name": "AWSEC2FleetServiceRolePolicy", "deprecated": false, "createdate": "2020-05-04T20:10:31Z", "updatedate": "2020-05-04T20:10:31+00:00", "version": "v3", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Tagging", "Write"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["ec2:DescribeImages", "ec2:DescribeSubnets", "ec2:RequestSpotInstances", "ec2:DescribeInstanceStatus", "ec2:RunInstances"], "Resource": ["*"]}, {"Sid": "EC2SpotManagement", "Effect": "Allow", "Action": ["iam:CreateServiceLinkedRole"], "Resource": "*", "Condition": {"StringEquals": {"iam:AWSServiceName": "spot.amazonaws.com"}}}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": ["*"], "Condition": {"StringEquals": {"iam:PassedToService": ["ec2.amazonaws.com", "ec2.amazonaws.com.cn"]}}}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*:*:instance/*", "arn:aws:ec2:*:*:spot-instances-request/*"]}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*:*:volume/*"], "Condition": {"StringEquals": {"ec2:CreateAction": "RunInstances"}}}, {"Effect": "Allow", "Action": ["ec2:TerminateInstances"], "Resource": "*", "Condition": {"StringLike": {"ec2:ResourceTag/aws:ec2:fleet-id": "*"}}}]}, "effective_actions": [{"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_level": "List", "condition": null}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null}, {"action": "ec2:RequestSpotInstances", "effective_action": "ec2:RequestSpotInstances", "access_level": "Write", "condition": null}, {"action": "ec2:DescribeInstanceStatus", "effective_action": "ec2:DescribeInstanceStatus", "access_level": "List", "condition": null}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": null}, {"action": "iam:CreateServiceLinkedRole", "effective_action": "iam:CreateServiceLinkedRole", "access_level": "Write", "condition": {"StringEquals": {"iam:AWSServiceName": "spot.amazonaws.com"}}}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": ["ec2.amazonaws.com", "ec2.amazonaws.com.cn"]}}}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": null}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringEquals": {"ec2:CreateAction": "RunInstances"}}}, {"action": "ec2:TerminateInstances", "effective_action": "ec2:TerminateInstances", "access_level": "Write", "condition": {"StringLike": {"ec2:ResourceTag/aws:ec2:fleet-id": "*"}}}]}