{"name": "AWSThinkboxDeadlineResourceTrackerAdminPolicy", "deprecated": false, "createdate": "2020-10-06T19:06:57Z", "updatedate": "2020-10-06T19:06:57+00:00", "version": "v2", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["application-autoscaling:DeleteScalingPolicy", "application-autoscaling:DeregisterScalableTarget", "application-autoscaling:DescribeScalableTargets", "application-autoscaling:DescribeScalingPolicies", "application-autoscaling:PutScalingPolicy", "application-autoscaling:RegisterScalableTarget"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["cloudformation:ListStacks"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["cloudformation:CreateStack", "cloudformation:DeleteStack", "cloudformation:UpdateStack", "cloudformation:DescribeStacks", "cloudformation:UpdateTerminationProtection"], "Resource": ["arn:aws:cloudformation:*:*:stack/DeadlineResourceTracker*"]}, {"Effect": "Allow", "Action": ["dynamodb:CreateTable", "dynamodb:DeleteTable", "dynamodb:DescribeTable", "dynamodb:ListTagsOfResource", "dynamodb:TagResource", "dynamodb:UntagResource"], "Resource": ["arn:aws:dynamodb:*:*:table/DeadlineEC2ComputeNodeHealth*", "arn:aws:dynamodb:*:*:table/DeadlineEC2ComputeNodeInfo*", "arn:aws:dynamodb:*:*:table/DeadlineFleetHealth*"]}, {"Effect": "Allow", "Action": ["dynamodb:BatchWriteItem", "dynamodb:Scan"], "Resource": ["arn:aws:dynamodb:*:*:table/DeadlineFleetHealth*"]}, {"Effect": "Allow", "Action": ["events:DeleteRule", "events:DescribeRule", "events:PutRule", "events:PutTargets", "events:RemoveTargets"], "Resource": ["arn:aws:events:*:*:rule/DeadlineResourceTracker*"]}, {"Effect": "Allow", "Action": ["iam:GetRole", "iam:ListAttachedRolePolicies"], "Resource": ["arn:aws:iam::*:role/DeadlineResourceTracker*"]}, {"Effect": "Allow", "Action": ["iam:GetUser"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["iam:CreateServiceLinkedRole"], "Resource": ["arn:aws:iam::*:role/aws-service-role/*"], "Condition": {"StringEquals": {"iam:AWSServiceName": ["dynamodb.application-autoscaling.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": ["arn:aws:iam::*:role/DeadlineResourceTrackerAccess*"], "Condition": {"StringEquals": {"iam:PassedToService": ["lambda.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": ["arn:aws:iam::*:role/aws-service-role/dynamodb.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_DynamoDBTable"], "Condition": {"StringEquals": {"iam:PassedToService": ["application-autoscaling.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["lambda:GetEventSourceMapping"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["lambda:CreateEventSourceMapping", "lambda:DeleteEventSourceMapping"], "Resource": ["*"], "Condition": {"StringLike": {"lambda:FunctionArn": ["arn:aws:lambda:*:*:function:DeadlineResourceTracker*"]}}}, {"Effect": "Allow", "Action": ["lambda:AddPermission", "lambda:RemovePermission"], "Resource": ["arn:aws:lambda:*:*:function:DeadlineResourceTracker*"], "Condition": {"StringLike": {"lambda:Principal": "events.amazonaws.com"}}}, {"Effect": "Allow", "Action": ["lambda:CreateFunction", "lambda:DeleteFunction", "lambda:GetFunction", "lambda:GetFunctionConfiguration"], "Resource": ["arn:aws:lambda:*:*:function:DeadlineResourceTracker*"]}, {"Effect": "Allow", "Action": ["s3:GetObject"], "Resource": ["arn:aws:s3:::*/deadline_aws_resource_tracker-*.zip", "arn:aws:s3:::*/DeadlineAWSResourceTrackerTemplate-*.yaml"]}, {"Effect": "Allow", "Action": ["sqs:CreateQueue", "sqs:DeleteQueue", "sqs:GetQueueAttributes", "sqs:ListQueueTags", "sqs:TagQueue", "sqs:UntagQueue"], "Resource": ["arn:aws:sqs:*:*:DeadlineAWSComputeNodeState*", "arn:aws:sqs:*:*:DeadlineResourceTracker*"]}]}, "effective_actions": [{"action": "application-autoscaling:DeleteScalingPolicy", "effective_action": "application-autoscaling:DeleteScalingPolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "application-autoscaling:DeregisterScalableTarget", "effective_action": "application-autoscaling:DeregisterScalableTarget", "access_level": "Write", "condition": null, "privesc": false}, {"action": "application-autoscaling:DescribeScalableTargets", "effective_action": "application-autoscaling:DescribeScalableTargets", "access_level": "Read", "condition": null, "privesc": false}, {"action": "application-autoscaling:DescribeScalingPolicies", "effective_action": "application-autoscaling:DescribeScalingPolicies", "access_level": "Read", "condition": null, "privesc": false}, {"action": "application-autoscaling:PutScalingPolicy", "effective_action": "application-autoscaling:PutScalingPolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "application-autoscaling:RegisterScalableTarget", "effective_action": "application-autoscaling:RegisterScalableTarget", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:ListStacks", "effective_action": "cloudformation:ListStacks", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:CreateStack", "effective_action": "cloudformation:CreateStack", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:DeleteStack", "effective_action": "cloudformation:DeleteStack", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:UpdateStack", "effective_action": "cloudformation:UpdateStack", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeStacks", "effective_action": "cloudformation:DescribeStacks", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:UpdateTerminationProtection", "effective_action": "cloudformation:UpdateTerminationProtection", "access_level": "Write", "condition": null, "privesc": false}, {"action": "dynamodb:CreateTable", "effective_action": "dynamodb:CreateTable", "access_level": "Write", "condition": null, "privesc": false}, {"action": "dynamodb:DeleteTable", "effective_action": "dynamodb:DeleteTable", "access_level": "Write", "condition": null, "privesc": false}, {"action": "dynamodb:DescribeTable", "effective_action": "dynamodb:DescribeTable", "access_level": "Read", "condition": null, "privesc": false}, {"action": "dynamodb:ListTagsOfResource", "effective_action": "dynamodb:ListTagsOfResource", "access_level": "Read", "condition": null, "privesc": false}, {"action": "dynamodb:TagResource", "effective_action": "dynamodb:TagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "dynamodb:UntagResource", "effective_action": "dynamodb:UntagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "dynamodb:BatchWriteItem", "effective_action": "dynamodb:BatchWriteItem", "access_level": "Write", "condition": null, "privesc": false}, {"action": "dynamodb:Scan", "effective_action": "dynamodb:Scan", "access_level": "Read", "condition": null, "privesc": false}, {"action": "events:DeleteRule", "effective_action": "events:DeleteRule", "access_level": "Write", "condition": null, "privesc": false}, {"action": "events:DescribeRule", "effective_action": "events:DescribeRule", "access_level": "Read", "condition": null, "privesc": false}, {"action": "events:PutRule", "effective_action": "events:PutRule", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "events:PutTargets", "effective_action": "events:PutTargets", "access_level": "Write", "condition": null, "privesc": false}, {"action": "events:RemoveTargets", "effective_action": "events:RemoveTargets", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iam:GetRole", "effective_action": "iam:GetRole", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:ListAttachedRolePolicies", "effective_action": "iam:ListAttachedRolePolicies", "access_level": "List", "condition": null, "privesc": false}, {"action": "iam:GetUser", "effective_action": "iam:GetUser", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:CreateServiceLinkedRole", "effective_action": "iam:CreateServiceLinkedRole", "access_level": "Write", "condition": {"StringEquals": {"iam:AWSServiceName": ["dynamodb.application-autoscaling.amazonaws.com"]}}, "privesc": true}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": ["lambda.amazonaws.com"]}}, "privesc": true}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": ["application-autoscaling.amazonaws.com"]}}, "privesc": true}, {"action": "lambda:GetEventSourceMapping", "effective_action": "lambda:GetEventSourceMapping", "access_level": "Read", "condition": null, "privesc": false}, {"action": "lambda:CreateEventSourceMapping", "effective_action": "lambda:CreateEventSourceMapping", "access_level": "Write", "condition": {"StringLike": {"lambda:FunctionArn": ["arn:aws:lambda:*:*:function:DeadlineResourceTracker*"]}}, "privesc": false}, {"action": "lambda:DeleteEventSourceMapping", "effective_action": "lambda:DeleteEventSourceMapping", "access_level": "Write", "condition": {"StringLike": {"lambda:FunctionArn": ["arn:aws:lambda:*:*:function:DeadlineResourceTracker*"]}}, "privesc": false}, {"action": "lambda:AddPermission", "effective_action": "lambda:AddPermission", "access_level": "Permissions management", "condition": {"StringLike": {"lambda:Principal": "events.amazonaws.com"}}, "privesc": false}, {"action": "lambda:RemovePermission", "effective_action": "lambda:RemovePermission", "access_level": "Permissions management", "condition": {"StringLike": {"lambda:Principal": "events.amazonaws.com"}}, "privesc": false}, {"action": "lambda:CreateFunction", "effective_action": "lambda:CreateFunction", "access_level": "Write", "condition": null, "privesc": false}, {"action": "lambda:DeleteFunction", "effective_action": "lambda:DeleteFunction", "access_level": "Write", "condition": null, "privesc": false}, {"action": "lambda:GetFunction", "effective_action": "lambda:GetFunction", "access_level": "Read", "condition": null, "privesc": false}, {"action": "lambda:GetFunctionConfiguration", "effective_action": "lambda:GetFunctionConfiguration", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null, "privesc": false}, {"action": "sqs:CreateQueue", "effective_action": "sqs:CreateQueue", "access_level": "Write", "condition": null, "privesc": false}, {"action": "sqs:DeleteQueue", "effective_action": "sqs:DeleteQueue", "access_level": "Write", "condition": null, "privesc": false}, {"action": "sqs:GetQueueAttributes", "effective_action": "sqs:GetQueueAttributes", "access_level": "Read", "condition": null, "privesc": false}, {"action": "sqs:ListQueueTags", "effective_action": "sqs:ListQueueTags", "access_level": "Read", "condition": null, "privesc": false}, {"action": "sqs:TagQueue", "effective_action": "sqs:TagQueue", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "sqs:UntagQueue", "effective_action": "sqs:UntagQueue", "access_level": "Tagging", "condition": null, "privesc": false}]}