{"name": "AmazonEMRServicePolicy_v2", "deprecated": false, "createdate": "2021-03-12T01:11:08Z", "updatedate": "2021-03-12T01:11:08+00:00", "version": "v1", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Sid": "CreateInTaggedNetwork", "Effect": "Allow", "Action": ["ec2:CreateNetworkInterface", "ec2:RunInstances", "ec2:CreateFleet", "ec2:CreateLaunchTemplate", "ec2:CreateLaunchTemplateVersion"], "Resource": ["arn:aws:ec2:*:*:subnet/*", "arn:aws:ec2:*:*:security-group/*"], "Condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "CreateWithEMRTaggedLaunchTemplate", "Effect": "Allow", "Action": ["ec2:CreateFleet", "ec2:RunInstances", "ec2:CreateLaunchTemplateVersion"], "Resource": "arn:aws:ec2:*:*:launch-template/*", "Condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "CreateEMRTaggedLaunchTemplate", "Effect": "Allow", "Action": ["ec2:CreateLaunchTemplate"], "Resource": "arn:aws:ec2:*:*:launch-template/*", "Condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "CreateEMRTaggedInstancesAndVolumes", "Effect": "Allow", "Action": ["ec2:RunInstances", "ec2:CreateFleet"], "Resource": ["arn:aws:ec2:*:*:instance/*", "arn:aws:ec2:*:*:volume/*"], "Condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "ResourcesToLaunchEC2", "Effect": "Allow", "Action": ["ec2:RunInstances", "ec2:CreateFleet", "ec2:CreateLaunchTemplate", "ec2:CreateLaunchTemplateVersion"], "Resource": ["arn:aws:ec2:*:*:network-interface/*", "arn:aws:ec2:*::image/ami-*", "arn:aws:ec2:*:*:key-pair/*", "arn:aws:ec2:*:*:capacity-reservation/*", "arn:aws:ec2:*:*:placement-group/EMR_*", "arn:aws:ec2:*:*:fleet/*", "arn:aws:ec2:*:*:dedicated-host/*", "arn:aws:resource-groups:*:*:group/*"]}, {"Sid": "ManageEMRTaggedResources", "Effect": "Allow", "Action": ["ec2:CreateLaunchTemplateVersion", "ec2:DeleteLaunchTemplate", "ec2:DeleteNetworkInterface", "ec2:ModifyInstanceAttribute", "ec2:TerminateInstances"], "Resource": "*", "Condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "ManageTagsOnEMRTaggedResources", "Effect": "Allow", "Action": ["ec2:CreateTags", "ec2:DeleteTags"], "Resource": ["arn:aws:ec2:*:*:instance/*", "arn:aws:ec2:*:*:volume/*", "arn:aws:ec2:*:*:network-interface/*", "arn:aws:ec2:*:*:launch-template/*"], "Condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "CreateNetworkInterfaceNeededForPrivateSubnet", "Effect": "Allow", "Action": ["ec2:CreateNetworkInterface"], "Resource": ["arn:aws:ec2:*:*:network-interface/*"], "Condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "TagOnCreateTaggedEMRResources", "Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*:*:network-interface/*", "arn:aws:ec2:*:*:instance/*", "arn:aws:ec2:*:*:volume/*", "arn:aws:ec2:*:*:launch-template/*"], "Condition": {"StringEquals": {"ec2:CreateAction": ["RunInstances", "CreateFleet", "CreateLaunchTemplate", "CreateNetworkInterface"]}}}, {"Sid": "TagPlacementGroups", "Effect": "Allow", "Action": ["ec2:CreateTags", "ec2:DeleteTags"], "Resource": ["arn:aws:ec2:*:*:placement-group/EMR_*"]}, {"Sid": "ListActionsForEC2Resources", "Effect": "Allow", "Action": ["ec2:DescribeAccountAttributes", "ec2:DescribeCapacityReservations", "ec2:DescribeDhcpOptions", "ec2:DescribeInstances", "ec2:DescribeLaunchTemplates", "ec2:DescribeNetworkAcls", "ec2:DescribeNetworkInterfaces", "ec2:DescribePlacementGroups", "ec2:DescribeRouteTables", "ec2:DescribeSecurityGroups", "ec2:DescribeSubnets", "ec2:DescribeVolumes", "ec2:DescribeVolumeStatus", "ec2:DescribeVpcAttribute", "ec2:DescribeVpcEndpoints", "ec2:DescribeVpcs"], "Resource": "*"}, {"Sid": "CreateDefaultSecurityGroupWithEMRTags", "Effect": "Allow", "Action": ["ec2:CreateSecurityGroup"], "Resource": ["arn:aws:ec2:*:*:security-group/*"], "Condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "CreateDefaultSecurityGroupInVPCWithEMRTags", "Effect": "Allow", "Action": ["ec2:CreateSecurityGroup"], "Resource": ["arn:aws:ec2:*:*:vpc/*"], "Condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "TagOnCreateDefaultSecurityGroupWithEMRTags", "Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": "arn:aws:ec2:*:*:security-group/*", "Condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true", "ec2:CreateAction": "CreateSecurityGroup"}}}, {"Sid": "ManageSecurityGroups", "Effect": "Allow", "Action": ["ec2:AuthorizeSecurityGroupEgress", "ec2:AuthorizeSecurityGroupIngress", "ec2:RevokeSecurityGroupEgress", "ec2:RevokeSecurityGroupIngress"], "Resource": "*", "Condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "CreateEMRPlacementGroups", "Effect": "Allow", "Action": ["ec2:CreatePlacementGroup"], "Resource": "arn:aws:ec2:*:*:placement-group/EMR_*"}, {"Sid": "DeletePlacementGroups", "Effect": "Allow", "Action": ["ec2:DeletePlacementGroup"], "Resource": "*"}, {"Sid": "AutoScaling", "Effect": "Allow", "Action": ["application-autoscaling:DeleteScalingPolicy", "application-autoscaling:DeregisterScalableTarget", "application-autoscaling:DescribeScalableTargets", "application-autoscaling:DescribeScalingPolicies", "application-autoscaling:PutScalingPolicy", "application-autoscaling:RegisterScalableTarget"], "Resource": "*"}, {"Sid": "ResourceGroupsForCapacityReservations", "Effect": "Allow", "Action": ["resource-groups:ListGroupResources"], "Resource": "*"}, {"Sid": "AutoScalingCloudWatch", "Effect": "Allow", "Action": ["cloudwatch:PutMetricAlarm", "cloudwatch:DeleteAlarms", "cloudwatch:DescribeAlarms"], "Resource": "arn:aws:cloudwatch:*:*:alarm:*_EMR_Auto_Scaling"}, {"Sid": "PassRoleForAutoScaling", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "arn:aws:iam::*:role/EMR_AutoScaling_DefaultRole", "Condition": {"StringLike": {"iam:PassedToService": "application-autoscaling.amazonaws.com*"}}}, {"Sid": "PassRoleForEC2", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "arn:aws:iam::*:role/EMR_EC2_DefaultRole", "Condition": {"StringLike": {"iam:PassedToService": "ec2.amazonaws.com*"}}}]}, "effective_actions": [{"action": "ec2:CreateNetworkInterface", "effective_action": "ec2:CreateNetworkInterface", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateFleet", "effective_action": "ec2:CreateFleet", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateLaunchTemplate", "effective_action": "ec2:CreateLaunchTemplate", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateLaunchTemplateVersion", "effective_action": "ec2:CreateLaunchTemplateVersion", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateFleet", "effective_action": "ec2:CreateFleet", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateLaunchTemplateVersion", "effective_action": "ec2:CreateLaunchTemplateVersion", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateLaunchTemplate", "effective_action": "ec2:CreateLaunchTemplate", "access_level": "Write", "condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateFleet", "effective_action": "ec2:CreateFleet", "access_level": "Write", "condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateFleet", "effective_action": "ec2:CreateFleet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateLaunchTemplate", "effective_action": "ec2:CreateLaunchTemplate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateLaunchTemplateVersion", "effective_action": "ec2:CreateLaunchTemplateVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateLaunchTemplateVersion", "effective_action": "ec2:CreateLaunchTemplateVersion", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:DeleteLaunchTemplate", "effective_action": "ec2:DeleteLaunchTemplate", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:DeleteNetworkInterface", "effective_action": "ec2:DeleteNetworkInterface", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:ModifyInstanceAttribute", "effective_action": "ec2:ModifyInstanceAttribute", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:TerminateInstances", "effective_action": "ec2:TerminateInstances", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:DeleteTags", "effective_action": "ec2:DeleteTags", "access_level": "Tagging", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateNetworkInterface", "effective_action": "ec2:CreateNetworkInterface", "access_level": "Write", "condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringEquals": {"ec2:CreateAction": ["RunInstances", "CreateFleet", "CreateLaunchTemplate", "CreateNetworkInterface"]}}, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "ec2:DeleteTags", "effective_action": "ec2:DeleteTags", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "ec2:DescribeAccountAttributes", "effective_action": "ec2:DescribeAccountAttributes", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeCapacityReservations", "effective_action": "ec2:DescribeCapacityReservations", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeDhcpOptions", "effective_action": "ec2:DescribeDhcpOptions", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeLaunchTemplates", "effective_action": "ec2:DescribeLaunchTemplates", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeNetworkAcls", "effective_action": "ec2:DescribeNetworkAcls", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeNetworkInterfaces", "effective_action": "ec2:DescribeNetworkInterfaces", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribePlacementGroups", "effective_action": "ec2:DescribePlacementGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeRouteTables", "effective_action": "ec2:DescribeRouteTables", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVolumes", "effective_action": "ec2:DescribeVolumes", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVolumeStatus", "effective_action": "ec2:DescribeVolumeStatus", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcAttribute", "effective_action": "ec2:DescribeVpcAttribute", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcEndpoints", "effective_action": "ec2:DescribeVpcEndpoints", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:CreateSecurityGroup", "effective_action": "ec2:CreateSecurityGroup", "access_level": "Write", "condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateSecurityGroup", "effective_action": "ec2:CreateSecurityGroup", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true", "ec2:CreateAction": "CreateSecurityGroup"}}, "privesc": false}, {"action": "ec2:AuthorizeSecurityGroupEgress", "effective_action": "ec2:AuthorizeSecurityGroupEgress", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:AuthorizeSecurityGroupIngress", "effective_action": "ec2:AuthorizeSecurityGroupIngress", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:RevokeSecurityGroupEgress", "effective_action": "ec2:RevokeSecurityGroupEgress", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:RevokeSecurityGroupIngress", "effective_action": "ec2:RevokeSecurityGroupIngress", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false}, {"action": "ec2:CreatePlacementGroup", "effective_action": "ec2:CreatePlacementGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeletePlacementGroup", "effective_action": "ec2:DeletePlacementGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "application-autoscaling:DeleteScalingPolicy", "effective_action": "application-autoscaling:DeleteScalingPolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "application-autoscaling:DeregisterScalableTarget", "effective_action": "application-autoscaling:DeregisterScalableTarget", "access_level": "Write", "condition": null, "privesc": false}, {"action": "application-autoscaling:DescribeScalableTargets", "effective_action": "application-autoscaling:DescribeScalableTargets", "access_level": "Read", "condition": null, "privesc": false}, {"action": "application-autoscaling:DescribeScalingPolicies", "effective_action": "application-autoscaling:DescribeScalingPolicies", "access_level": "Read", "condition": null, "privesc": false}, {"action": "application-autoscaling:PutScalingPolicy", "effective_action": "application-autoscaling:PutScalingPolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "application-autoscaling:RegisterScalableTarget", "effective_action": "application-autoscaling:RegisterScalableTarget", "access_level": "Write", "condition": null, "privesc": false}, {"action": "resource-groups:ListGroupResources", "effective_action": "resource-groups:ListGroupResources", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudwatch:PutMetricAlarm", "effective_action": "cloudwatch:PutMetricAlarm", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudwatch:DeleteAlarms", "effective_action": "cloudwatch:DeleteAlarms", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudwatch:DescribeAlarms", "effective_action": "cloudwatch:DescribeAlarms", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringLike": {"iam:PassedToService": "application-autoscaling.amazonaws.com*"}}, "privesc": true}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringLike": {"iam:PassedToService": "ec2.amazonaws.com*"}}, "privesc": true}]}