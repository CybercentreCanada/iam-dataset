{"name": "AmazonFSxServiceRolePolicy", "deprecated": false, "createdate": "2021-08-20T12:51:29Z", "updatedate": "2021-08-20T12:51:29+00:00", "version": "v5", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": false, "resource_exposure": true, "credentials_exposure": false, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["cloudwatch:PutMetricData", "ds:AuthorizeApplication", "ds:GetAuthorizedApplicationDetails", "ds:UnauthorizeApplication", "ec2:CreateNetworkInterface", "ec2:CreateNetworkInterfacePermission", "ec2:DeleteNetworkInterface", "ec2:DescribeAddresses", "ec2:DescribeDhcpOptions", "ec2:DescribeNetworkInterfaces", "ec2:DescribeRouteTables", "ec2:DescribeSecurityGroups", "ec2:DescribeSubnets", "ec2:DescribeVpcs", "ec2:DisassociateAddress", "route53:AssociateVPCWithHostedZone"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*:*:network-interface/*"], "Condition": {"StringEquals": {"ec2:CreateAction": "CreateNetworkInterface"}, "ForAllValues:StringEquals": {"aws:TagKeys": "AmazonFSx.FileSystemId"}}}, {"Effect": "Allow", "Action": ["ec2:AssignPrivateIpAddresses", "ec2:ModifyNetworkInterfaceAttribute", "ec2:UnassignPrivateIpAddresses"], "Resource": ["arn:aws:ec2:*:*:network-interface/*"], "Condition": {"Null": {"aws:ResourceTag/AmazonFSx.FileSystemId": "false"}}}, {"Effect": "Allow", "Action": ["ec2:CreateRoute", "ec2:ReplaceRoute", "ec2:DeleteRoute"], "Resource": ["arn:aws:ec2:*:*:route-table/*"], "Condition": {"StringEquals": {"aws:ResourceTag/AmazonFSx": "ManagedByAmazonFSx"}}}, {"Effect": "Allow", "Action": ["logs:DescribeLogGroups", "logs:DescribeLogStreams", "logs:PutLogEvents"], "Resource": "arn:aws:logs:*:*:log-group:/aws/fsx/*"}, {"Effect": "Allow", "Action": ["firehose:DescribeDeliveryStream", "firehose:PutRecord", "firehose:PutRecordBatch"], "Resource": "arn:aws:firehose:*:*:deliverystream/aws-fsx-*"}]}, "effective_actions": [{"action": "cloudwatch:PutMetricData", "effective_action": "cloudwatch:PutMetricData", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ds:AuthorizeApplication", "effective_action": "ds:AuthorizeApplication", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ds:GetAuthorizedApplicationDetails", "effective_action": "ds:GetAuthorizedApplicationDetails", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ds:UnauthorizeApplication", "effective_action": "ds:UnauthorizeApplication", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateNetworkInterface", "effective_action": "ec2:CreateNetworkInterface", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateNetworkInterfacePermission", "effective_action": "ec2:CreateNetworkInterfacePermission", "access_level": "Permissions management", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "ec2:DeleteNetworkInterface", "effective_action": "ec2:DeleteNetworkInterface", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeAddresses", "effective_action": "ec2:DescribeAddresses", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeDhcpOptions", "effective_action": "ec2:DescribeDhcpOptions", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeNetworkInterfaces", "effective_action": "ec2:DescribeNetworkInterfaces", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeRouteTables", "effective_action": "ec2:DescribeRouteTables", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DisassociateAddress", "effective_action": "ec2:DisassociateAddress", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "route53:AssociateVPCWithHostedZone", "effective_action": "route53:AssociateVPCWithHostedZone", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringEquals": {"ec2:CreateAction": "CreateNetworkInterface"}, "ForAllValues:StringEquals": {"aws:TagKeys": "AmazonFSx.FileSystemId"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:AssignPrivateIpAddresses", "effective_action": "ec2:AssignPrivateIpAddresses", "access_level": "Write", "condition": {"Null": {"aws:ResourceTag/AmazonFSx.FileSystemId": "false"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:ModifyNetworkInterfaceAttribute", "effective_action": "ec2:ModifyNetworkInterfaceAttribute", "access_level": "Write", "condition": {"Null": {"aws:ResourceTag/AmazonFSx.FileSystemId": "false"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:UnassignPrivateIpAddresses", "effective_action": "ec2:UnassignPrivateIpAddresses", "access_level": "Write", "condition": {"Null": {"aws:ResourceTag/AmazonFSx.FileSystemId": "false"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateRoute", "effective_action": "ec2:CreateRoute", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/AmazonFSx": "ManagedByAmazonFSx"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:ReplaceRoute", "effective_action": "ec2:ReplaceRoute", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/AmazonFSx": "ManagedByAmazonFSx"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DeleteRoute", "effective_action": "ec2:DeleteRoute", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/AmazonFSx": "ManagedByAmazonFSx"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "logs:DescribeLogGroups", "effective_action": "logs:DescribeLogGroups", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "logs:DescribeLogStreams", "effective_action": "logs:DescribeLogStreams", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "logs:PutLogEvents", "effective_action": "logs:PutLogEvents", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "firehose:DescribeDeliveryStream", "effective_action": "firehose:DescribeDeliveryStream", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "firehose:PutRecord", "effective_action": "firehose:PutRecord", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "firehose:PutRecordBatch", "effective_action": "firehose:PutRecordBatch", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}]}