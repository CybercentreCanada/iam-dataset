{"name": "AWSAgentlessDiscoveryService", "deprecated": false, "createdate": "2020-02-24T23:08:23Z", "updatedate": "2020-02-24T23:08:23+00:00", "version": "v2", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": false, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["awsconnector:RegisterConnector", "awsconnector:GetConnectorHealth"], "Resource": "*"}, {"Effect": "Allow", "Action": ["iam:GetUser"], "Resource": "*"}, {"Effect": "Allow", "Action": ["s3:GetObject", "s3:ListBucket"], "Resource": ["arn:aws:s3:::connector-platform-upgrade-info/*", "arn:aws:s3:::connector-platform-upgrade-info", "arn:aws:s3:::connector-platform-upgrade-bundles/*", "arn:aws:s3:::connector-platform-upgrade-bundles", "arn:aws:s3:::connector-platform-release-notes/*", "arn:aws:s3:::connector-platform-release-notes", "arn:aws:s3:::prod.agentless.discovery.connector.upgrade/*", "arn:aws:s3:::prod.agentless.discovery.connector.upgrade"]}, {"Effect": "Allow", "Action": ["s3:PutObject", "s3:PutObjectAcl"], "Resource": ["arn:aws:s3:::import-to-ec2-connector-debug-logs/*"]}, {"Effect": "Allow", "Action": ["SNS:Publish"], "Resource": "arn:aws:sns:*:*:metrics-sns-topic-for-*"}, {"Sid": "Discovery", "Effect": "Allow", "Action": ["Discovery:*"], "Resource": "*"}, {"Sid": "arsenal", "Effect": "Allow", "Action": ["arsenal:RegisterOnPremisesAgent"], "Resource": "*"}, {"Effect": "Allow", "Action": ["mgh:GetHomeRegion"], "Resource": "*"}]}, "effective_actions": [{"action": "awsconnector:RegisterConnector", "effective_action": "awsconnector:RegisterConnector", "access_level": "Write", "condition": null}, {"action": "awsconnector:GetConnectorHealth", "effective_action": "awsconnector:GetConnectorHealth", "access_level": "Read", "condition": null}, {"action": "iam:GetUser", "effective_action": "iam:GetUser", "access_level": "Read", "condition": null}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null}, {"action": "s3:ListBucket", "effective_action": "s3:ListBucket", "access_level": "List", "condition": null}, {"action": "s3:PutObject", "effective_action": "s3:PutObject", "access_level": "Write", "condition": null}, {"action": "s3:PutObjectAcl", "effective_action": "s3:PutObjectAcl", "access_level": "Permissions management", "condition": null}, {"action": "SNS:Publish", "effective_action": "sns:Publish", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:AssociateConfigurationItemsToApplication", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:BatchDeleteImportData", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:CreateApplication", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:CreateTags", "access_level": "Tagging", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:DeleteApplications", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:DeleteTags", "access_level": "Tagging", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:DescribeAgents", "access_level": "Read", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:DescribeConfigurations", "access_level": "Read", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:DescribeContinuousExports", "access_level": "Read", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:DescribeExportConfigurations", "access_level": "Read", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:DescribeExportTasks", "access_level": "Read", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:DescribeImportTasks", "access_level": "List", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:DescribeTags", "access_level": "Read", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:DisassociateConfigurationItemsFromApplication", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:ExportConfigurations", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:GetDiscoverySummary", "access_level": "Read", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:ListConfigurations", "access_level": "List", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:ListServerNeighbors", "access_level": "List", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:StartContinuousExport", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:StartDataCollectionByAgentIds", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:StartExportTask", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:StartImportTask", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:StopContinuousExport", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:StopDataCollectionByAgentIds", "access_level": "Write", "condition": null}, {"action": "Discovery:*", "effective_action": "discovery:UpdateApplication", "access_level": "Write", "condition": null}, {"action": "arsenal:RegisterOnPremisesAgent", "effective_action": "arsenal:RegisterOnPremisesAgent", "access_level": "Write", "condition": null}, {"action": "mgh:GetHomeRegion", "effective_action": "mgh:GetHomeRegion", "access_level": "Read", "condition": null}]}