{"name": "AWSBackupOperatorAccess", "deprecated": false, "createdate": "2021-03-10T18:31:50Z", "updatedate": "2021-03-10T18:31:50+00:00", "version": "v7", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Write"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["backup:Get*", "backup:List*", "backup:Describe*", "backup:CreateBackupSelection", "backup:DeleteBackupSelection", "backup:GetRecoveryPointRestoreMetadata", "backup:StartBackupJob", "backup:StartRestoreJob", "backup:StartCopyJob"], "Resource": "*"}, {"Action": ["rds:DescribeDBSnapshots", "rds:ListTagsForResource", "rds:DescribeDBInstances", "rds:describeDBSnapshots", "rds:describeDBEngineVersions", "rds:describeOptionGroups", "rds:describeOrderableDBInstanceOptions", "rds:describeDBSubnetGroups", "rds:DescribeDBClusterSnapshots", "rds:DescribeDBClusters", "rds:DescribeDBParameterGroups", "rds:DescribeDBClusterParameterGroups", "rds:DescribeDBInstanceAutomatedBackups"], "Effect": "Allow", "Resource": "*"}, {"Action": ["dynamodb:ListBackups", "dynamodb:ListTables"], "Effect": "Allow", "Resource": "*"}, {"Action": ["elasticfilesystem:DescribeFilesystems"], "Resource": "arn:aws:elasticfilesystem:*:*:file-system/*", "Effect": "Allow"}, {"Action": ["ec2:DescribeSnapshots", "ec2:DescribeVolumes", "ec2:describeAvailabilityZones", "ec2:DescribeVpcs", "ec2:DescribeAccountAttributes", "ec2:DescribeSecurityGroups", "ec2:DescribeImages", "ec2:DescribeSubnets", "ec2:DescribePlacementGroups", "ec2:DescribeInstances", "ec2:DescribeInstanceTypes"], "Effect": "Allow", "Resource": "*"}, {"Action": ["tag:GetTagKeys", "tag:GetTagValues", "tag:GetResources"], "Effect": "Allow", "Resource": "*"}, {"Effect": "Allow", "Action": ["storagegateway:DescribeCachediSCSIVolumes", "storagegateway:DescribeStorediSCSIVolumes"], "Resource": "arn:aws:storagegateway:*:*:gateway/*/volume/*"}, {"Effect": "Allow", "Action": ["storagegateway:ListGateways"], "Resource": "arn:aws:storagegateway:*:*:*"}, {"Effect": "Allow", "Action": ["storagegateway:DescribeGatewayInformation", "storagegateway:ListVolumes", "storagegateway:ListLocalDisks"], "Resource": "arn:aws:storagegateway:*:*:gateway/*"}, {"Action": ["iam:ListRoles", "iam:GetRole"], "Effect": "Allow", "Resource": "*"}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": ["arn:aws:iam::*:role/*AwsBackup*", "arn:aws:iam::*:role/*AWSBackup*"], "Condition": {"StringLike": {"iam:PassedToService": "backup.amazonaws.com"}}}, {"Effect": "Allow", "Action": ["organizations:DescribeOrganization"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ssm:CancelCommand", "ssm:GetCommandInvocation"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ssm:SendCommand"], "Resource": ["arn:aws:ssm:*:*:document/AWSEC2-CreateVssSnapshot", "arn:aws:ec2:*:*:instance/*"]}, {"Action": ["fsx:DescribeBackups"], "Effect": "Allow", "Resource": "arn:aws:fsx:*:*:backup/*"}, {"Action": ["fsx:DescribeFileSystems"], "Effect": "Allow", "Resource": "arn:aws:fsx:*:*:file-system/*"}, {"Action": ["ds:DescribeDirectories"], "Effect": "Allow", "Resource": "*"}]}, "effective_actions": [{"action": "backup:Get*", "effective_action": "backup:GetBackupPlan", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Get*", "effective_action": "backup:GetBackupPlanFromJSON", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Get*", "effective_action": "backup:GetBackupPlanFromTemplate", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Get*", "effective_action": "backup:GetBackupSelection", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Get*", "effective_action": "backup:GetBackupVaultAccessPolicy", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Get*", "effective_action": "backup:GetBackupVaultNotifications", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Get*", "effective_action": "backup:GetRecoveryPointRestoreMetadata", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Get*", "effective_action": "backup:GetSupportedResourceTypes", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListBackupJobs", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListBackupPlanTemplates", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListBackupPlanVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListBackupPlans", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListBackupSelections", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListBackupVaults", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListCopyJobs", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListFrameworks", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListProtectedResources", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListRecoveryPointsByBackupVault", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListRecoveryPointsByResource", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListReportJobs", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListReportPlans", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListRestoreJobs", "access_level": "List", "condition": null, "privesc": false}, {"action": "backup:List*", "effective_action": "backup:ListTags", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeBackupJob", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeBackupVault", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeCopyJob", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeFramework", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeGlobalSettings", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeProtectedResource", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeRecoveryPoint", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeRegionSettings", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeReportJob", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeReportPlan", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:Describe*", "effective_action": "backup:DescribeRestoreJob", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:CreateBackupSelection", "effective_action": "backup:CreateBackupSelection", "access_level": "Write", "condition": null, "privesc": false}, {"action": "backup:DeleteBackupSelection", "effective_action": "backup:DeleteBackupSelection", "access_level": "Write", "condition": null, "privesc": false}, {"action": "backup:GetRecoveryPointRestoreMetadata", "effective_action": "backup:GetRecoveryPointRestoreMetadata", "access_level": "Read", "condition": null, "privesc": false}, {"action": "backup:StartBackupJob", "effective_action": "backup:StartBackupJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "backup:StartRestoreJob", "effective_action": "backup:StartRestoreJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "backup:StartCopyJob", "effective_action": "backup:StartCopyJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "rds:DescribeDBSnapshots", "effective_action": "rds:DescribeDBSnapshots", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:ListTagsForResource", "effective_action": "rds:ListTagsForResource", "access_level": "Read", "condition": null, "privesc": false}, {"action": "rds:DescribeDBInstances", "effective_action": "rds:DescribeDBInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:describeDBSnapshots", "effective_action": "rds:DescribeDBSnapshots", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:describeDBEngineVersions", "effective_action": "rds:DescribeDBEngineVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:describeOptionGroups", "effective_action": "rds:DescribeOptionGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:describeOrderableDBInstanceOptions", "effective_action": "rds:DescribeOrderableDBInstanceOptions", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:describeDBSubnetGroups", "effective_action": "rds:DescribeDBSubnetGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:DescribeDBClusterSnapshots", "effective_action": "rds:DescribeDBClusterSnapshots", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:DescribeDBClusters", "effective_action": "rds:DescribeDBClusters", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:DescribeDBParameterGroups", "effective_action": "rds:DescribeDBParameterGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:DescribeDBClusterParameterGroups", "effective_action": "rds:DescribeDBClusterParameterGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "rds:DescribeDBInstanceAutomatedBackups", "effective_action": "rds:DescribeDBInstanceAutomatedBackups", "access_level": "List", "condition": null, "privesc": false}, {"action": "dynamodb:ListBackups", "effective_action": "dynamodb:ListBackups", "access_level": "List", "condition": null, "privesc": false}, {"action": "dynamodb:ListTables", "effective_action": "dynamodb:ListTables", "access_level": "List", "condition": null, "privesc": false}, {"action": "elasticfilesystem:DescribeFilesystems", "effective_action": "elasticfilesystem:DescribeFileSystems", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSnapshots", "effective_action": "ec2:DescribeSnapshots", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVolumes", "effective_action": "ec2:DescribeVolumes", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:describeAvailabilityZones", "effective_action": "ec2:DescribeAvailabilityZones", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeAccountAttributes", "effective_action": "ec2:DescribeAccountAttributes", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribePlacementGroups", "effective_action": "ec2:DescribePlacementGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstanceTypes", "effective_action": "ec2:DescribeInstanceTypes", "access_level": "List", "condition": null, "privesc": false}, {"action": "tag:GetTagKeys", "effective_action": "tag:GetTagKeys", "access_level": "Read", "condition": null, "privesc": false}, {"action": "tag:GetTagValues", "effective_action": "tag:GetTagValues", "access_level": "Read", "condition": null, "privesc": false}, {"action": "tag:GetResources", "effective_action": "tag:GetResources", "access_level": "Read", "condition": null, "privesc": false}, {"action": "storagegateway:DescribeCachediSCSIVolumes", "effective_action": "storagegateway:DescribeCachediSCSIVolumes", "access_level": "Read", "condition": null, "privesc": false}, {"action": "storagegateway:DescribeStorediSCSIVolumes", "effective_action": "storagegateway:DescribeStorediSCSIVolumes", "access_level": "Read", "condition": null, "privesc": false}, {"action": "storagegateway:ListGateways", "effective_action": "storagegateway:ListGateways", "access_level": "List", "condition": null, "privesc": false}, {"action": "storagegateway:DescribeGatewayInformation", "effective_action": "storagegateway:DescribeGatewayInformation", "access_level": "Read", "condition": null, "privesc": false}, {"action": "storagegateway:ListVolumes", "effective_action": "storagegateway:ListVolumes", "access_level": "List", "condition": null, "privesc": false}, {"action": "storagegateway:ListLocalDisks", "effective_action": "storagegateway:ListLocalDisks", "access_level": "List", "condition": null, "privesc": false}, {"action": "iam:ListRoles", "effective_action": "iam:ListRoles", "access_level": "List", "condition": null, "privesc": false}, {"action": "iam:GetRole", "effective_action": "iam:GetRole", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringLike": {"iam:PassedToService": "backup.amazonaws.com"}}, "privesc": true}, {"action": "organizations:DescribeOrganization", "effective_action": "organizations:DescribeOrganization", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ssm:CancelCommand", "effective_action": "ssm:CancelCommand", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ssm:GetCommandInvocation", "effective_action": "ssm:GetCommandInvocation", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ssm:SendCommand", "effective_action": "ssm:SendCommand", "access_level": "Write", "condition": null, "privesc": false}, {"action": "fsx:DescribeBackups", "effective_action": "fsx:DescribeBackups", "access_level": "Read", "condition": null, "privesc": false}, {"action": "fsx:DescribeFileSystems", "effective_action": "fsx:DescribeFileSystems", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ds:DescribeDirectories", "effective_action": "ds:DescribeDirectories", "access_level": "List", "condition": null, "privesc": false}]}