{"name": "EC2InstanceProfileForImageBuilderECRContainerBuilds", "deprecated": false, "createdate": "2020-12-11T19:48:15Z", "updatedate": "2020-12-11T19:48:15+00:00", "version": "v1", "malformed": false, "unknown_actions": [], "access_levels": ["Read", "Write"], "privesc": false, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["imagebuilder:GetComponent", "imagebuilder:GetContainerRecipe", "ecr:GetAuthorizationToken", "ecr:BatchGetImage", "ecr:InitiateLayerUpload", "ecr:UploadLayerPart", "ecr:CompleteLayerUpload", "ecr:BatchCheckLayerAvailability", "ecr:GetDownloadUrlForLayer", "ecr:PutImage"], "Resource": "*"}, {"Effect": "Allow", "Action": ["kms:Decrypt"], "Resource": "*", "Condition": {"ForAnyValue:StringEquals": {"kms:EncryptionContextKeys": "aws:imagebuilder:arn", "aws:CalledVia": ["imagebuilder.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["s3:GetObject"], "Resource": "arn:aws:s3:::ec2imagebuilder*"}, {"Effect": "Allow", "Action": ["logs:CreateLogStream", "logs:CreateLogGroup", "logs:PutLogEvents"], "Resource": "arn:aws:logs:*:*:log-group:/aws/imagebuilder/*"}]}, "effective_actions": [{"action": "imagebuilder:GetComponent", "effective_action": "imagebuilder:GetComponent", "access_level": "Read", "condition": null}, {"action": "imagebuilder:GetContainerRecipe", "effective_action": "imagebuilder:GetContainerRecipe", "access_level": "Read", "condition": null}, {"action": "ecr:GetAuthorizationToken", "effective_action": "ecr:GetAuthorizationToken", "access_level": "Read", "condition": null}, {"action": "ecr:BatchGetImage", "effective_action": "ecr:BatchGetImage", "access_level": "Read", "condition": null}, {"action": "ecr:InitiateLayerUpload", "effective_action": "ecr:InitiateLayerUpload", "access_level": "Write", "condition": null}, {"action": "ecr:UploadLayerPart", "effective_action": "ecr:UploadLayerPart", "access_level": "Write", "condition": null}, {"action": "ecr:CompleteLayerUpload", "effective_action": "ecr:CompleteLayerUpload", "access_level": "Write", "condition": null}, {"action": "ecr:BatchCheckLayerAvailability", "effective_action": "ecr:BatchCheckLayerAvailability", "access_level": "Read", "condition": null}, {"action": "ecr:GetDownloadUrlForLayer", "effective_action": "ecr:GetDownloadUrlForLayer", "access_level": "Read", "condition": null}, {"action": "ecr:PutImage", "effective_action": "ecr:PutImage", "access_level": "Write", "condition": null}, {"action": "kms:Decrypt", "effective_action": "kms:Decrypt", "access_level": "Write", "condition": {"ForAnyValue:StringEquals": {"kms:EncryptionContextKeys": "aws:imagebuilder:arn", "aws:CalledVia": ["imagebuilder.amazonaws.com"]}}}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null}, {"action": "logs:CreateLogStream", "effective_action": "logs:CreateLogStream", "access_level": "Write", "condition": null}, {"action": "logs:CreateLogGroup", "effective_action": "logs:CreateLogGroup", "access_level": "Write", "condition": null}, {"action": "logs:PutLogEvents", "effective_action": "logs:PutLogEvents", "access_level": "Write", "condition": null}]}