{"name": "MemoryDBServiceRolePolicy", "deprecated": false, "createdate": "2021-08-18T23:48:16Z", "updatedate": "2021-08-18T23:48:16+00:00", "version": "v2", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Tagging", "Write"], "privesc": false, "resource_exposure": false, "credentials_exposure": false, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": "arn:aws:ec2:*:*:network-interface/*", "Condition": {"StringEquals": {"ec2:CreateAction": "CreateNetworkInterface"}, "ForAllValues:StringEquals": {"aws:TagKeys": ["AmazonMemoryDBManaged"]}}}, {"Effect": "Allow", "Action": ["ec2:CreateNetworkInterface"], "Resource": ["arn:aws:ec2:*:*:network-interface/*", "arn:aws:ec2:*:*:subnet/*", "arn:aws:ec2:*:*:security-group/*"]}, {"Effect": "Allow", "Action": ["ec2:DeleteNetworkInterface", "ec2:ModifyNetworkInterfaceAttribute"], "Resource": "arn:aws:ec2:*:*:network-interface/*", "Condition": {"StringEquals": {"ec2:ResourceTag/AmazonMemoryDBManaged": "true"}}}, {"Effect": "Allow", "Action": ["ec2:DeleteNetworkInterface", "ec2:ModifyNetworkInterfaceAttribute"], "Resource": "arn:aws:ec2:*:*:security-group/*"}, {"Effect": "Allow", "Action": ["ec2:DescribeSecurityGroups", "ec2:DescribeNetworkInterfaces", "ec2:DescribeAvailabilityZones", "ec2:DescribeSubnets", "ec2:DescribeVpcs"], "Resource": "*"}, {"Effect": "Allow", "Action": ["cloudwatch:PutMetricData"], "Resource": "*", "Condition": {"StringEquals": {"cloudwatch:namespace": "AWS/MemoryDB"}}}]}, "effective_actions": [{"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringEquals": {"ec2:CreateAction": "CreateNetworkInterface"}, "ForAllValues:StringEquals": {"aws:TagKeys": ["AmazonMemoryDBManaged"]}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateNetworkInterface", "effective_action": "ec2:CreateNetworkInterface", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DeleteNetworkInterface", "effective_action": "ec2:DeleteNetworkInterface", "access_level": "Write", "condition": {"StringEquals": {"ec2:ResourceTag/AmazonMemoryDBManaged": "true"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:ModifyNetworkInterfaceAttribute", "effective_action": "ec2:ModifyNetworkInterfaceAttribute", "access_level": "Write", "condition": {"StringEquals": {"ec2:ResourceTag/AmazonMemoryDBManaged": "true"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DeleteNetworkInterface", "effective_action": "ec2:DeleteNetworkInterface", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:ModifyNetworkInterfaceAttribute", "effective_action": "ec2:ModifyNetworkInterfaceAttribute", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeNetworkInterfaces", "effective_action": "ec2:DescribeNetworkInterfaces", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeAvailabilityZones", "effective_action": "ec2:DescribeAvailabilityZones", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudwatch:PutMetricData", "effective_action": "cloudwatch:PutMetricData", "access_level": "Write", "condition": {"StringEquals": {"cloudwatch:namespace": "AWS/MemoryDB"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}]}