{"name": "AWSIoTDeviceTesterForGreengrassFullAccess", "deprecated": false, "createdate": "2020-06-25T17:01:56Z", "updatedate": "2020-06-25T17:01:56+00:00", "version": "v4", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Sid": "VisualEditor1", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "arn:aws:iam::*:role/idt-*", "Condition": {"StringEquals": {"iam:PassedToService": ["iot.amazonaws.com", "lambda.amazonaws.com", "greengrass.amazonaws.com"]}}}, {"Sid": "VisualEditor2", "Effect": "Allow", "Action": ["lambda:CreateFunction", "iot:DeleteCertificate", "lambda:DeleteFunction", "execute-api:Invoke", "iot:UpdateCertificate"], "Resource": ["arn:aws:execute-api:us-east-1:098862408343:9xpmnvs5h4/prod/POST/metrics", "arn:aws:lambda:*:*:function:idt-*", "arn:aws:iot:*:*:cert/*"]}, {"Sid": "VisualEditor3", "Effect": "Allow", "Action": ["iot:CreateThing", "iot:DeleteThing"], "Resource": ["arn:aws:iot:*:*:thing/idt-*", "arn:aws:iot:*:*:cert/*"]}, {"Sid": "VisualEditor4", "Effect": "Allow", "Action": ["iot:AttachPolicy", "iot:DetachPolicy", "iot:DeletePolicy"], "Resource": ["arn:aws:iot:*:*:policy/idt-*", "arn:aws:iot:*:*:cert/*"]}, {"Sid": "VisualEditor5", "Effect": "Allow", "Action": ["iot:CreateJob", "iot:DescribeJob", "iot:DescribeJobExecution", "iot:DeleteJob"], "Resource": ["arn:aws:iot:*:*:thing/idt-*", "arn:aws:iot:*:*:job/*"]}, {"Sid": "VisualEditor6", "Effect": "Allow", "Action": ["iot:DescribeEndpoint", "greengrass:*", "iam:ListAttachedRolePolicies", "iot:CreatePolicy", "iot:GetThingShadow", "iot:CreateKeysAndCertificate", "iot:ListThings", "iot:UpdateThingShadow", "iot:CreateCertificateFromCsr", "iot-device-tester:SendMetrics", "iot-device-tester:SupportedVersion", "iot-device-tester:LatestIdt", "iot-device-tester:CheckVersion", "iot-device-tester:DownloadTestSuite"], "Resource": "*"}, {"Sid": "VisualEditor7", "Effect": "Allow", "Action": ["iot:DetachThingPrincipal", "iot:AttachThingPrincipal"], "Resource": ["arn:aws:iot:*:*:thing/idt-*", "arn:aws:iot:*:*:cert/*"]}, {"Sid": "VisualEditor8", "Effect": "Allow", "Action": ["s3:PutObject", "s3:DeleteObjectVersion", "s3:ListBucketVersions", "s3:CreateBucket", "s3:DeleteObject", "s3:DeleteBucket"], "Resource": "arn:aws:s3:::idt*"}]}, "effective_actions": [{"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": ["iot.amazonaws.com", "lambda.amazonaws.com", "greengrass.amazonaws.com"]}}, "privesc": true}, {"action": "lambda:CreateFunction", "effective_action": "lambda:CreateFunction", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DeleteCertificate", "effective_action": "iot:DeleteCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "lambda:DeleteFunction", "effective_action": "lambda:DeleteFunction", "access_level": "Write", "condition": null, "privesc": false}, {"action": "execute-api:Invoke", "effective_action": "execute-api:Invoke", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:UpdateCertificate", "effective_action": "iot:UpdateCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:CreateThing", "effective_action": "iot:CreateThing", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DeleteThing", "effective_action": "iot:DeleteThing", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:AttachPolicy", "effective_action": "iot:AttachPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "iot:DetachPolicy", "effective_action": "iot:DetachPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "iot:DeletePolicy", "effective_action": "iot:DeletePolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:CreateJob", "effective_action": "iot:CreateJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DescribeJob", "effective_action": "iot:DescribeJob", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:DescribeJobExecution", "effective_action": "iot:DescribeJobExecution", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:DeleteJob", "effective_action": "iot:DeleteJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DescribeEndpoint", "effective_action": "iot:DescribeEndpoint", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:AssociateRoleToGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:AssociateServiceRoleToAccount", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateConnectorDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateConnectorDefinitionVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateCoreDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateCoreDefinitionVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateDeployment", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateDeviceDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateDeviceDefinitionVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateFunctionDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateFunctionDefinitionVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateGroupCertificateAuthority", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateGroupVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateLoggerDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateLoggerDefinitionVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateResourceDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateResourceDefinitionVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateSoftwareUpdateJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateSubscriptionDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateSubscriptionDefinitionVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DeleteConnectorDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DeleteCoreDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DeleteDeviceDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DeleteFunctionDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DeleteGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DeleteLoggerDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DeleteResourceDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DeleteSubscriptionDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DisassociateRoleFromGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DisassociateServiceRoleFromAccount", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:Discover", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetAssociatedRole", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetBulkDeploymentStatus", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetConnectivityInfo", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetConnectorDefinition", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetConnectorDefinitionVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetCoreDefinition", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetCoreDefinitionVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetDeploymentStatus", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetDeviceDefinition", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetDeviceDefinitionVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetFunctionDefinition", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetFunctionDefinitionVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetGroup", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetGroupCertificateAuthority", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetGroupCertificateConfiguration", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetGroupVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetLoggerDefinition", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetLoggerDefinitionVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetResourceDefinition", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetResourceDefinitionVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetServiceRoleForAccount", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetSubscriptionDefinition", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetSubscriptionDefinitionVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetThingRuntimeConfiguration", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListBulkDeploymentDetailedReports", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListBulkDeployments", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListConnectorDefinitionVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListConnectorDefinitions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListCoreDefinitionVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListCoreDefinitions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListDeployments", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListDeviceDefinitionVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListDeviceDefinitions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListFunctionDefinitionVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListFunctionDefinitions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListGroupCertificateAuthorities", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListGroupVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListLoggerDefinitionVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListLoggerDefinitions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListResourceDefinitionVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListResourceDefinitions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListSubscriptionDefinitionVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListSubscriptionDefinitions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListTagsForResource", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ResetDeployments", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:StartBulkDeployment", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:StopBulkDeployment", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:TagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UntagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateConnectivityInfo", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateConnectorDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateCoreDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateDeviceDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateFunctionDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateGroupCertificateConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateLoggerDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateResourceDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateSubscriptionDefinition", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:UpdateThingRuntimeConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CancelDeployment", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:CreateComponentVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DeleteComponent", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DeleteCoreDevice", "access_level": "Write", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:DescribeComponent", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetComponent", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetComponentVersionArtifact", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetCoreDevice", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:GetDeployment", "access_level": "Read", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListComponentVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListComponents", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListCoreDevices", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListEffectiveDeployments", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ListInstalledComponents", "access_level": "List", "condition": null, "privesc": false}, {"action": "greengrass:*", "effective_action": "greengrass:ResolveComponentCandidates", "access_level": "List", "condition": null, "privesc": false}, {"action": "iam:ListAttachedRolePolicies", "effective_action": "iam:ListAttachedRolePolicies", "access_level": "List", "condition": null, "privesc": false}, {"action": "iot:CreatePolicy", "effective_action": "iot:CreatePolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:GetThingShadow", "effective_action": "iot:GetThingShadow", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:CreateKeysAndCertificate", "effective_action": "iot:CreateKeysAndCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:ListThings", "effective_action": "iot:ListThings", "access_level": "List", "condition": null, "privesc": false}, {"action": "iot:UpdateThingShadow", "effective_action": "iot:UpdateThingShadow", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:CreateCertificateFromCsr", "effective_action": "iot:CreateCertificateFromCsr", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot-device-tester:SendMetrics", "effective_action": "iot-device-tester:SendMetrics", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot-device-tester:SupportedVersion", "effective_action": "iot-device-tester:SupportedVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot-device-tester:LatestIdt", "effective_action": "iot-device-tester:LatestIdt", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot-device-tester:CheckVersion", "effective_action": "iot-device-tester:CheckVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot-device-tester:DownloadTestSuite", "effective_action": "iot-device-tester:DownloadTestSuite", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:DetachThingPrincipal", "effective_action": "iot:DetachThingPrincipal", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:AttachThingPrincipal", "effective_action": "iot:AttachThingPrincipal", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:PutObject", "effective_action": "s3:PutObject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:DeleteObjectVersion", "effective_action": "s3:DeleteObjectVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:ListBucketVersions", "effective_action": "s3:ListBucketVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "s3:CreateBucket", "effective_action": "s3:CreateBucket", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:DeleteObject", "effective_action": "s3:DeleteObject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:DeleteBucket", "effective_action": "s3:DeleteBucket", "access_level": "Write", "condition": null, "privesc": false}]}