{"name": "AWSServiceRoleForGammaInternalAmazonEKSNodegroup", "deprecated": true, "createdate": "2020-01-16T21:47:47Z", "updatedate": null, "version": "v1", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write"], "privesc": true, "resource_exposure": true, "credentials_exposure": false, "document": {"Version": "2012-10-17", "Statement": [{"Sid": "SharedSecurityGroupRelatedPermissions", "Effect": "Allow", "Action": ["ec2:RevokeSecurityGroupIngress", "ec2:AuthorizeSecurityGroupEgress", "ec2:AuthorizeSecurityGroupIngress", "ec2:DescribeInstances", "ec2:RevokeSecurityGroupEgress", "ec2:DeleteSecurityGroup"], "Resource": "*", "Condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks": "*"}}}, {"Sid": "EKSCreatedSecurityGroupRelatedPermissions", "Effect": "Allow", "Action": ["ec2:RevokeSecurityGroupIngress", "ec2:AuthorizeSecurityGroupEgress", "ec2:AuthorizeSecurityGroupIngress", "ec2:DescribeInstances", "ec2:RevokeSecurityGroupEgress", "ec2:DeleteSecurityGroup"], "Resource": "*", "Condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks:nodegroup-name": "*"}}}, {"Sid": "LaunchTemplateRelatedPermissions", "Effect": "Allow", "Action": ["ec2:DeleteLaunchTemplate", "ec2:CreateLaunchTemplateVersion"], "Resource": "*", "Condition": {"StringLike": {"ec2:ResourceTag/eks:nodegroup-name": "*"}}}, {"Sid": "AutoscalingRelatedPermissions", "Effect": "Allow", "Action": ["autoscaling:UpdateAutoScalingGroup", "autoscaling:DeleteAutoScalingGroup", "autoscaling:TerminateInstanceInAutoScalingGroup", "autoscaling:CompleteLifecycleAction", "autoscaling:PutLifecycleHook", "autoscaling:PutNotificationConfiguration"], "Resource": "arn:aws:autoscaling:*:*:*:autoScalingGroupName/eks-*"}, {"Sid": "AllowAutoscalingToCreateSLR", "Effect": "Allow", "Condition": {"StringEquals": {"iam:AWSServiceName": "autoscaling.amazonaws.com"}}, "Action": ["iam:CreateServiceLinkedRole"], "Resource": "*"}, {"Sid": "AllowASGCreationByEKS", "Effect": "Allow", "Action": ["autoscaling:CreateOrUpdateTags", "autoscaling:CreateAutoScalingGroup"], "Resource": "*", "Condition": {"ForAnyValue:StringEquals": {"aws:TagKeys": ["eks", "eks:cluster-name", "eks:nodegroup-name"]}}}, {"Sid": "AllowPassRoleToIAM", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "*", "Condition": {"StringEqualsIfExists": {"iam:PassedToService": "iam.amazonaws.com"}}}, {"Sid": "AllowPassRoleToAutoscaling", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "*", "Condition": {"StringEqualsIfExists": {"iam:PassedToService": "autoscaling.amazonaws.com"}}}, {"Sid": "AllowPassRoleToEC2", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "*", "Condition": {"StringEqualsIfExists": {"iam:PassedToService": "ec2.amazonaws.com"}}}, {"Sid": "PermissionsToManageResourcesForNodegroups", "Effect": "Allow", "Action": ["iam:GetRole", "ec2:CreateLaunchTemplate", "ec2:DescribeInstances", "iam:GetInstanceProfile", "ec2:DescribeLaunchTemplates", "autoscaling:DescribeAutoScalingGroups", "ec2:CreateSecurityGroup", "ec2:DescribeLaunchTemplateVersions", "ec2:RunInstances", "ec2:DescribeSecurityGroups", "ec2:GetConsoleOutput", "ec2:DescribeSubnets"], "Resource": "*"}, {"Sid": "PermissionsToCreateAndManageInstanceProfiles", "Effect": "Allow", "Action": ["iam:CreateInstanceProfile", "iam:DeleteInstanceProfile", "iam:RemoveRoleFromInstanceProfile", "iam:AddRoleToInstanceProfile"], "Resource": "arn:aws:iam::*:instance-profile/eks-*"}, {"Sid": "PermissionsToManageEKSAndKubernetesTags", "Effect": "Allow", "Action": ["ec2:CreateTags", "ec2:DeleteTags"], "Resource": "*", "Condition": {"ForAnyValue:StringLike": {"aws:TagKeys": ["eks", "eks:cluster-name", "eks:nodegroup-name", "kubernetes.io/cluster/*"]}}}]}, "effective_actions": [{"action": "ec2:RevokeSecurityGroupIngress", "effective_action": "ec2:RevokeSecurityGroupIngress", "access_level": "Write", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:AuthorizeSecurityGroupEgress", "effective_action": "ec2:AuthorizeSecurityGroupEgress", "access_level": "Write", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:AuthorizeSecurityGroupIngress", "effective_action": "ec2:AuthorizeSecurityGroupIngress", "access_level": "Write", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:RevokeSecurityGroupEgress", "effective_action": "ec2:RevokeSecurityGroupEgress", "access_level": "Write", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DeleteSecurityGroup", "effective_action": "ec2:DeleteSecurityGroup", "access_level": "Write", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:RevokeSecurityGroupIngress", "effective_action": "ec2:RevokeSecurityGroupIngress", "access_level": "Write", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks:nodegroup-name": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:AuthorizeSecurityGroupEgress", "effective_action": "ec2:AuthorizeSecurityGroupEgress", "access_level": "Write", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks:nodegroup-name": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:AuthorizeSecurityGroupIngress", "effective_action": "ec2:AuthorizeSecurityGroupIngress", "access_level": "Write", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks:nodegroup-name": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks:nodegroup-name": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:RevokeSecurityGroupEgress", "effective_action": "ec2:RevokeSecurityGroupEgress", "access_level": "Write", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks:nodegroup-name": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DeleteSecurityGroup", "effective_action": "ec2:DeleteSecurityGroup", "access_level": "Write", "condition": {"ForAnyValue:StringLike": {"ec2:ResourceTag/eks:nodegroup-name": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DeleteLaunchTemplate", "effective_action": "ec2:DeleteLaunchTemplate", "access_level": "Write", "condition": {"StringLike": {"ec2:ResourceTag/eks:nodegroup-name": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateLaunchTemplateVersion", "effective_action": "ec2:CreateLaunchTemplateVersion", "access_level": "Write", "condition": {"StringLike": {"ec2:ResourceTag/eks:nodegroup-name": "*"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "autoscaling:UpdateAutoScalingGroup", "effective_action": "autoscaling:UpdateAutoScalingGroup", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "autoscaling:DeleteAutoScalingGroup", "effective_action": "autoscaling:DeleteAutoScalingGroup", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "autoscaling:TerminateInstanceInAutoScalingGroup", "effective_action": "autoscaling:TerminateInstanceInAutoScalingGroup", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "autoscaling:CompleteLifecycleAction", "effective_action": "autoscaling:CompleteLifecycleAction", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "autoscaling:PutLifecycleHook", "effective_action": "autoscaling:PutLifecycleHook", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "autoscaling:PutNotificationConfiguration", "effective_action": "autoscaling:PutNotificationConfiguration", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:CreateServiceLinkedRole", "effective_action": "iam:CreateServiceLinkedRole", "access_level": "Write", "condition": {"StringEquals": {"iam:AWSServiceName": "autoscaling.amazonaws.com"}}, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "autoscaling:CreateOrUpdateTags", "effective_action": "autoscaling:CreateOrUpdateTags", "access_level": "Tagging", "condition": {"ForAnyValue:StringEquals": {"aws:TagKeys": ["eks", "eks:cluster-name", "eks:nodegroup-name"]}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "autoscaling:CreateAutoScalingGroup", "effective_action": "autoscaling:CreateAutoScalingGroup", "access_level": "Write", "condition": {"ForAnyValue:StringEquals": {"aws:TagKeys": ["eks", "eks:cluster-name", "eks:nodegroup-name"]}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEqualsIfExists": {"iam:PassedToService": "iam.amazonaws.com"}}, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEqualsIfExists": {"iam:PassedToService": "autoscaling.amazonaws.com"}}, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEqualsIfExists": {"iam:PassedToService": "ec2.amazonaws.com"}}, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "iam:GetRole", "effective_action": "iam:GetRole", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateLaunchTemplate", "effective_action": "ec2:CreateLaunchTemplate", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:GetInstanceProfile", "effective_action": "iam:GetInstanceProfile", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeLaunchTemplates", "effective_action": "ec2:DescribeLaunchTemplates", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "autoscaling:DescribeAutoScalingGroups", "effective_action": "autoscaling:DescribeAutoScalingGroups", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateSecurityGroup", "effective_action": "ec2:CreateSecurityGroup", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeLaunchTemplateVersions", "effective_action": "ec2:DescribeLaunchTemplateVersions", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:GetConsoleOutput", "effective_action": "ec2:GetConsoleOutput", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:CreateInstanceProfile", "effective_action": "iam:CreateInstanceProfile", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "iam:DeleteInstanceProfile", "effective_action": "iam:DeleteInstanceProfile", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "iam:RemoveRoleFromInstanceProfile", "effective_action": "iam:RemoveRoleFromInstanceProfile", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "iam:AddRoleToInstanceProfile", "effective_action": "iam:AddRoleToInstanceProfile", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"ForAnyValue:StringLike": {"aws:TagKeys": ["eks", "eks:cluster-name", "eks:nodegroup-name", "kubernetes.io/cluster/*"]}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DeleteTags", "effective_action": "ec2:DeleteTags", "access_level": "Tagging", "condition": {"ForAnyValue:StringLike": {"aws:TagKeys": ["eks", "eks:cluster-name", "eks:nodegroup-name", "kubernetes.io/cluster/*"]}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}]}