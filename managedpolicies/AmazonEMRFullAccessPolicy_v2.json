{"name": "AmazonEMRFullAccessPolicy_v2", "deprecated": false, "createdate": "2021-03-23T16:57:10Z", "updatedate": "2021-03-23T16:57:10+00:00", "version": "v2", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": true, "resource_exposure": true, "credentials_exposure": false, "document": {"Version": "2012-10-17", "Statement": [{"Sid": "RunJobFlowExplicitlyWithEMRManagedTag", "Effect": "Allow", "Action": ["elasticmapreduce:RunJobFlow"], "Resource": "*", "Condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}}, {"Sid": "ElasticMapReduceActions", "Effect": "Allow", "Action": ["elasticmapreduce:AddInstanceFleet", "elasticmapreduce:AddInstanceGroups", "elasticmapreduce:AddJobFlowSteps", "elasticmapreduce:AddTags", "elasticmapreduce:CancelSteps", "elasticmapreduce:CreateEditor", "elasticmapreduce:CreateSecurityConfiguration", "elasticmapreduce:DeleteEditor", "elasticmapreduce:DeleteSecurityConfiguration", "elasticmapreduce:DescribeCluster", "elasticmapreduce:DescribeEditor", "elasticmapreduce:DescribeJobFlows", "elasticmapreduce:DescribeSecurityConfiguration", "elasticmapreduce:DescribeStep", "elasticmapreduce:GetBlockPublicAccessConfiguration", "elasticmapreduce:GetManagedScalingPolicy", "elasticmapreduce:ListBootstrapActions", "elasticmapreduce:ListClusters", "elasticmapreduce:ListEditors", "elasticmapreduce:ListInstanceFleets", "elasticmapreduce:ListInstanceGroups", "elasticmapreduce:ListInstances", "elasticmapreduce:ListSecurityConfigurations", "elasticmapreduce:ListSteps", "elasticmapreduce:ModifyCluster", "elasticmapreduce:ModifyInstanceFleet", "elasticmapreduce:ModifyInstanceGroups", "elasticmapreduce:OpenEditorInConsole", "elasticmapreduce:PutAutoScalingPolicy", "elasticmapreduce:PutBlockPublicAccessConfiguration", "elasticmapreduce:PutManagedScalingPolicy", "elasticmapreduce:RemoveAutoScalingPolicy", "elasticmapreduce:RemoveManagedScalingPolicy", "elasticmapreduce:RemoveTags", "elasticmapreduce:SetTerminationProtection", "elasticmapreduce:StartEditor", "elasticmapreduce:StopEditor", "elasticmapreduce:TerminateJobFlows", "elasticmapreduce:ViewEventsFromAllClustersInConsole"], "Resource": "*"}, {"Sid": "ViewMetricsInEMRConsole", "Effect": "Allow", "Action": ["cloudwatch:GetMetricStatistics"], "Resource": "*"}, {"Sid": "PassRoleForElasticMapReduce", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "arn:aws:iam::*:role/EMR_DefaultRole", "Condition": {"StringLike": {"iam:PassedToService": "elasticmapreduce.amazonaws.com*"}}}, {"Sid": "PassRoleForEC2", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "arn:aws:iam::*:role/EMR_EC2_DefaultRole", "Condition": {"StringLike": {"iam:PassedToService": "ec2.amazonaws.com*"}}}, {"Sid": "PassRoleForAutoScaling", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "arn:aws:iam::*:role/EMR_AutoScaling_DefaultRole", "Condition": {"StringLike": {"iam:PassedToService": "application-autoscaling.amazonaws.com*"}}}, {"Sid": "ElasticMapReduceServiceLinkedRole", "Effect": "Allow", "Action": ["iam:CreateServiceLinkedRole"], "Resource": "arn:aws:iam::*:role/aws-service-role/elasticmapreduce.amazonaws.com*/AWSServiceRoleForEMRCleanup*", "Condition": {"StringEquals": {"iam:AWSServiceName": ["elasticmapreduce.amazonaws.com", "elasticmapreduce.amazonaws.com.cn"]}}}, {"Sid": "ConsoleUIActions", "Effect": "Allow", "Action": ["ec2:DescribeAccountAttributes", "ec2:DescribeAvailabilityZones", "ec2:DescribeImages", "ec2:DescribeKeyPairs", "ec2:DescribeNatGateways", "ec2:DescribeRouteTables", "ec2:DescribeSecurityGroups", "ec2:DescribeSubnets", "ec2:DescribeVpcs", "ec2:DescribeVpcEndpoints", "s3:ListAllMyBuckets", "iam:ListRoles"], "Resource": "*"}]}, "effective_actions": [{"action": "elasticmapreduce:RunJobFlow", "effective_action": "elasticmapreduce:RunJobFlow", "access_level": "Write", "condition": {"StringEquals": {"aws:RequestTag/for-use-with-amazon-emr-managed-policies": "true"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:AddInstanceFleet", "effective_action": "elasticmapreduce:AddInstanceFleet", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:AddInstanceGroups", "effective_action": "elasticmapreduce:AddInstanceGroups", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:AddJobFlowSteps", "effective_action": "elasticmapreduce:AddJobFlowSteps", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:AddTags", "effective_action": "elasticmapreduce:AddTags", "access_level": "Tagging", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:CancelSteps", "effective_action": "elasticmapreduce:CancelSteps", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:CreateEditor", "effective_action": "elasticmapreduce:CreateEditor", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:CreateSecurityConfiguration", "effective_action": "elasticmapreduce:CreateSecurityConfiguration", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:DeleteEditor", "effective_action": "elasticmapreduce:DeleteEditor", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:DeleteSecurityConfiguration", "effective_action": "elasticmapreduce:DeleteSecurityConfiguration", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:DescribeCluster", "effective_action": "elasticmapreduce:DescribeCluster", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:DescribeEditor", "effective_action": "elasticmapreduce:DescribeEditor", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:DescribeJobFlows", "effective_action": "elasticmapreduce:DescribeJobFlows", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:DescribeSecurityConfiguration", "effective_action": "elasticmapreduce:DescribeSecurityConfiguration", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:DescribeStep", "effective_action": "elasticmapreduce:DescribeStep", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:GetBlockPublicAccessConfiguration", "effective_action": "elasticmapreduce:GetBlockPublicAccessConfiguration", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:GetManagedScalingPolicy", "effective_action": "elasticmapreduce:GetManagedScalingPolicy", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ListBootstrapActions", "effective_action": "elasticmapreduce:ListBootstrapActions", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ListClusters", "effective_action": "elasticmapreduce:ListClusters", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ListEditors", "effective_action": "elasticmapreduce:ListEditors", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ListInstanceFleets", "effective_action": "elasticmapreduce:ListInstanceFleets", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ListInstanceGroups", "effective_action": "elasticmapreduce:ListInstanceGroups", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ListInstances", "effective_action": "elasticmapreduce:ListInstances", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ListSecurityConfigurations", "effective_action": "elasticmapreduce:ListSecurityConfigurations", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ListSteps", "effective_action": "elasticmapreduce:ListSteps", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ModifyCluster", "effective_action": "elasticmapreduce:ModifyCluster", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ModifyInstanceFleet", "effective_action": "elasticmapreduce:ModifyInstanceFleet", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ModifyInstanceGroups", "effective_action": "elasticmapreduce:ModifyInstanceGroups", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:OpenEditorInConsole", "effective_action": "elasticmapreduce:OpenEditorInConsole", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:PutAutoScalingPolicy", "effective_action": "elasticmapreduce:PutAutoScalingPolicy", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:PutBlockPublicAccessConfiguration", "effective_action": "elasticmapreduce:PutBlockPublicAccessConfiguration", "access_level": "Permissions management", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "elasticmapreduce:PutManagedScalingPolicy", "effective_action": "elasticmapreduce:PutManagedScalingPolicy", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:RemoveAutoScalingPolicy", "effective_action": "elasticmapreduce:RemoveAutoScalingPolicy", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:RemoveManagedScalingPolicy", "effective_action": "elasticmapreduce:RemoveManagedScalingPolicy", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:RemoveTags", "effective_action": "elasticmapreduce:RemoveTags", "access_level": "Tagging", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:SetTerminationProtection", "effective_action": "elasticmapreduce:SetTerminationProtection", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:StartEditor", "effective_action": "elasticmapreduce:StartEditor", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:StopEditor", "effective_action": "elasticmapreduce:StopEditor", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:TerminateJobFlows", "effective_action": "elasticmapreduce:TerminateJobFlows", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticmapreduce:ViewEventsFromAllClustersInConsole", "effective_action": "elasticmapreduce:ViewEventsFromAllClustersInConsole", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudwatch:GetMetricStatistics", "effective_action": "cloudwatch:GetMetricStatistics", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringLike": {"iam:PassedToService": "elasticmapreduce.amazonaws.com*"}}, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringLike": {"iam:PassedToService": "ec2.amazonaws.com*"}}, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringLike": {"iam:PassedToService": "application-autoscaling.amazonaws.com*"}}, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "iam:CreateServiceLinkedRole", "effective_action": "iam:CreateServiceLinkedRole", "access_level": "Write", "condition": {"StringEquals": {"iam:AWSServiceName": ["elasticmapreduce.amazonaws.com", "elasticmapreduce.amazonaws.com.cn"]}}, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "ec2:DescribeAccountAttributes", "effective_action": "ec2:DescribeAccountAttributes", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeAvailabilityZones", "effective_action": "ec2:DescribeAvailabilityZones", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeKeyPairs", "effective_action": "ec2:DescribeKeyPairs", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeNatGateways", "effective_action": "ec2:DescribeNatGateways", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeRouteTables", "effective_action": "ec2:DescribeRouteTables", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeVpcEndpoints", "effective_action": "ec2:DescribeVpcEndpoints", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "s3:ListAllMyBuckets", "effective_action": "s3:ListAllMyBuckets", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:ListRoles", "effective_action": "iam:ListRoles", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}]}