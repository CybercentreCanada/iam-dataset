{"name": "AmazonRedshiftDataFullAccess", "deprecated": false, "createdate": "2021-07-27T20:05:33Z", "updatedate": "2021-07-27T20:05:33+00:00", "version": "v2", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Write"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Sid": "DataAPIPermissions", "Effect": "Allow", "Action": ["redshift-data:BatchExecuteStatement", "redshift-data:ExecuteStatement", "redshift-data:CancelStatement", "redshift-data:ListStatements", "redshift-data:GetStatementResult", "redshift-data:DescribeStatement", "redshift-data:ListDatabases", "redshift-data:ListSchemas", "redshift-data:ListTables", "redshift-data:DescribeTable"], "Resource": "*"}, {"Sid": "SecretsManagerPermissions", "Effect": "Allow", "Action": ["secretsmanager:GetSecretValue"], "Resource": "*", "Condition": {"StringLike": {"secretsmanager:ResourceTag/RedshiftDataFullAccess": "*"}}}, {"Sid": "GetCredentialsForAPIUser", "Effect": "Allow", "Action": ["redshift:GetClusterCredentials"], "Resource": ["arn:aws:redshift:*:*:dbname:*/*", "arn:aws:redshift:*:*:dbuser:*/redshift_data_api_user"]}, {"Sid": "DenyCreateAPIUser", "Effect": "Deny", "Action": "redshift:CreateClusterUser", "Resource": ["arn:aws:redshift:*:*:dbuser:*/redshift_data_api_user"]}, {"Sid": "ServiceLinkedRole", "Effect": "Allow", "Action": ["iam:CreateServiceLinkedRole"], "Resource": "arn:aws:iam::*:role/aws-service-role/redshift-data.amazonaws.com/AWSServiceRoleForRedshift", "Condition": {"StringLike": {"iam:AWSServiceName": "redshift-data.amazonaws.com"}}}]}, "effective_actions": [{"action": "redshift-data:BatchExecuteStatement", "effective_action": "redshift-data:BatchExecuteStatement", "access_level": "Write", "condition": null, "privesc": false}, {"action": "redshift-data:ExecuteStatement", "effective_action": "redshift-data:ExecuteStatement", "access_level": "Write", "condition": null, "privesc": false}, {"action": "redshift-data:CancelStatement", "effective_action": "redshift-data:CancelStatement", "access_level": "Write", "condition": null, "privesc": false}, {"action": "redshift-data:ListStatements", "effective_action": "redshift-data:ListStatements", "access_level": "List", "condition": null, "privesc": false}, {"action": "redshift-data:GetStatementResult", "effective_action": "redshift-data:GetStatementResult", "access_level": "Read", "condition": null, "privesc": false}, {"action": "redshift-data:DescribeStatement", "effective_action": "redshift-data:DescribeStatement", "access_level": "Read", "condition": null, "privesc": false}, {"action": "redshift-data:ListDatabases", "effective_action": "redshift-data:ListDatabases", "access_level": "Read", "condition": null, "privesc": false}, {"action": "redshift-data:ListSchemas", "effective_action": "redshift-data:ListSchemas", "access_level": "Read", "condition": null, "privesc": false}, {"action": "redshift-data:ListTables", "effective_action": "redshift-data:ListTables", "access_level": "List", "condition": null, "privesc": false}, {"action": "redshift-data:DescribeTable", "effective_action": "redshift-data:DescribeTable", "access_level": "Read", "condition": null, "privesc": false}, {"action": "secretsmanager:GetSecretValue", "effective_action": "secretsmanager:GetSecretValue", "access_level": "Read", "condition": {"StringLike": {"secretsmanager:ResourceTag/RedshiftDataFullAccess": "*"}}, "privesc": false}, {"action": "redshift:GetClusterCredentials", "effective_action": "redshift:GetClusterCredentials", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iam:CreateServiceLinkedRole", "effective_action": "iam:CreateServiceLinkedRole", "access_level": "Write", "condition": {"StringLike": {"iam:AWSServiceName": "redshift-data.amazonaws.com"}}, "privesc": true}]}