{"name": "AWSBackupServiceRolePolicyForBackup", "deprecated": false, "createdate": "2021-04-12T18:07:46Z", "updatedate": "2021-04-12T18:07:46+00:00", "version": "v10", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "document": {"Version": "2012-10-17", "Statement": [{"Action": ["dynamodb:DescribeTable", "dynamodb:CreateBackup"], "Resource": "arn:aws:dynamodb:*:*:table/*", "Effect": "Allow"}, {"Action": ["dynamodb:DescribeBackup", "dynamodb:DeleteBackup"], "Resource": "arn:aws:dynamodb:*:*:table/*/backup/*", "Effect": "Allow"}, {"Effect": "Allow", "Action": ["rds:AddTagsToResource", "rds:ListTagsForResource", "rds:DescribeDBSnapshots", "rds:CreateDBSnapshot", "rds:CopyDBSnapshot", "rds:DescribeDBInstances", "rds:CreateDBClusterSnapshot", "rds:DescribeDBClusters", "rds:DescribeDBClusterSnapshots", "rds:CopyDBClusterSnapshot"], "Resource": "*"}, {"Effect": "Allow", "Action": ["rds:ModifyDBInstance"], "Resource": ["arn:aws:rds:*:*:db:*"]}, {"Effect": "Allow", "Action": ["rds:DeleteDBSnapshot", "rds:ModifyDBSnapshotAttribute"], "Resource": ["arn:aws:rds:*:*:snapshot:awsbackup:*"]}, {"Effect": "Allow", "Action": ["rds:DeleteDBClusterSnapshot", "rds:ModifyDBClusterSnapshotAttribute"], "Resource": ["arn:aws:rds:*:*:cluster-snapshot:awsbackup:*"]}, {"Effect": "Allow", "Action": ["storagegateway:CreateSnapshot", "storagegateway:ListTagsForResource"], "Resource": "arn:aws:storagegateway:*:*:gateway/*/volume/*"}, {"Effect": "Allow", "Action": ["ec2:CopySnapshot"], "Resource": "arn:aws:ec2:*::snapshot/*"}, {"Effect": "Allow", "Action": ["ec2:CopyImage"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:CreateTags", "ec2:DeleteSnapshot"], "Resource": "arn:aws:ec2:*::snapshot/*"}, {"Effect": "Allow", "Action": ["ec2:CreateImage", "ec2:DeregisterImage"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": "arn:aws:ec2:*:*:image/*"}, {"Effect": "Allow", "Action": ["ec2:DescribeSnapshots", "ec2:DescribeTags", "ec2:DescribeImages", "ec2:DescribeInstances", "ec2:DescribeInstanceAttribute", "ec2:DescribeInstanceCreditSpecifications", "ec2:DescribeNetworkInterfaces", "ec2:DescribeElasticGpus", "ec2:DescribeSpotInstanceRequests"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:ModifySnapshotAttribute", "ec2:ModifyImageAttribute"], "Resource": "*", "Condition": {"Null": {"aws:ResourceTag/aws:backup:source-resource": "false"}}}, {"Effect": "Allow", "Action": ["backup:DescribeBackupVault", "backup:CopyIntoBackupVault"], "Resource": "arn:aws:backup:*:*:backup-vault:*"}, {"Effect": "Allow", "Action": ["backup:CopyFromBackupVault"], "Resource": "*"}, {"Action": ["elasticfilesystem:Backup", "elasticfilesystem:DescribeTags"], "Resource": "arn:aws:elasticfilesystem:*:*:file-system/*", "Effect": "Allow"}, {"Effect": "Allow", "Action": ["ec2:CreateSnapshot", "ec2:DeleteSnapshot", "ec2:DescribeVolumes", "ec2:DescribeSnapshots"], "Resource": ["arn:aws:ec2:*::snapshot/*", "arn:aws:ec2:*:*:volume/*"]}, {"Action": ["kms:Decrypt", "kms:GenerateDataKey"], "Effect": "Allow", "Resource": "*", "Condition": {"StringLike": {"kms:ViaService": ["dynamodb.*.amazonaws.com"]}}}, {"Action": ["kms:DescribeKey"], "Effect": "Allow", "Resource": "*"}, {"Action": ["kms:CreateGrant"], "Effect": "Allow", "Resource": "*", "Condition": {"Bool": {"kms:GrantIsForAWSResource": "true"}}}, {"Action": ["kms:GenerateDataKeyWithoutPlaintext"], "Effect": "Allow", "Resource": "arn:aws:kms:*:*:key/*", "Condition": {"StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com"]}}}, {"Action": ["tag:GetResources"], "Resource": "*", "Effect": "Allow"}, {"Effect": "Allow", "Action": ["ssm:CancelCommand", "ssm:GetCommandInvocation"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ssm:SendCommand"], "Resource": ["arn:aws:ssm:*:*:document/AWSEC2-CreateVssSnapshot", "arn:aws:ec2:*:*:instance/*"]}, {"Action": ["fsx:DescribeBackups"], "Effect": "Allow", "Resource": "arn:aws:fsx:*:*:backup/*"}, {"Action": ["fsx:CreateBackup"], "Effect": "Allow", "Resource": ["arn:aws:fsx:*:*:file-system/*", "arn:aws:fsx:*:*:backup/*"]}, {"Action": ["fsx:DescribeFileSystems"], "Effect": "Allow", "Resource": "arn:aws:fsx:*:*:file-system/*"}, {"Action": ["fsx:ListTagsForResource"], "Effect": "Allow", "Resource": "arn:aws:fsx:*:*:file-system/*"}, {"Action": ["fsx:DeleteBackup"], "Effect": "Allow", "Resource": "arn:aws:fsx:*:*:backup/*"}, {"Effect": "Allow", "Action": ["fsx:ListTagsForResource", "fsx:ManageBackupPrincipalAssociations", "fsx:CopyBackup", "fsx:TagResource"], "Resource": "arn:aws:fsx:*:*:backup/*"}]}, "effective_actions": [{"action": "dynamodb:DescribeTable", "effective_action": "dynamodb:DescribeTable", "access_level": "Read", "condition": null}, {"action": "dynamodb:CreateBackup", "effective_action": "dynamodb:CreateBackup", "access_level": "Write", "condition": null}, {"action": "dynamodb:DescribeBackup", "effective_action": "dynamodb:DescribeBackup", "access_level": "Read", "condition": null}, {"action": "dynamodb:DeleteBackup", "effective_action": "dynamodb:DeleteBackup", "access_level": "Write", "condition": null}, {"action": "rds:AddTagsToResource", "effective_action": "rds:AddTagsToResource", "access_level": "Tagging", "condition": null}, {"action": "rds:ListTagsForResource", "effective_action": "rds:ListTagsForResource", "access_level": "Read", "condition": null}, {"action": "rds:DescribeDBSnapshots", "effective_action": "rds:DescribeDBSnapshots", "access_level": "List", "condition": null}, {"action": "rds:CreateDBSnapshot", "effective_action": "rds:CreateDBSnapshot", "access_level": "Write", "condition": null}, {"action": "rds:CopyDBSnapshot", "effective_action": "rds:CopyDBSnapshot", "access_level": "Write", "condition": null}, {"action": "rds:DescribeDBInstances", "effective_action": "rds:DescribeDBInstances", "access_level": "List", "condition": null}, {"action": "rds:CreateDBClusterSnapshot", "effective_action": "rds:CreateDBClusterSnapshot", "access_level": "Write", "condition": null}, {"action": "rds:DescribeDBClusters", "effective_action": "rds:DescribeDBClusters", "access_level": "List", "condition": null}, {"action": "rds:DescribeDBClusterSnapshots", "effective_action": "rds:DescribeDBClusterSnapshots", "access_level": "List", "condition": null}, {"action": "rds:CopyDBClusterSnapshot", "effective_action": "rds:CopyDBClusterSnapshot", "access_level": "Write", "condition": null}, {"action": "rds:ModifyDBInstance", "effective_action": "rds:ModifyDBInstance", "access_level": "Write", "condition": null}, {"action": "rds:DeleteDBSnapshot", "effective_action": "rds:DeleteDBSnapshot", "access_level": "Write", "condition": null}, {"action": "rds:ModifyDBSnapshotAttribute", "effective_action": "rds:ModifyDBSnapshotAttribute", "access_level": "Write", "condition": null}, {"action": "rds:DeleteDBClusterSnapshot", "effective_action": "rds:DeleteDBClusterSnapshot", "access_level": "Write", "condition": null}, {"action": "rds:ModifyDBClusterSnapshotAttribute", "effective_action": "rds:ModifyDBClusterSnapshotAttribute", "access_level": "Write", "condition": null}, {"action": "storagegateway:CreateSnapshot", "effective_action": "storagegateway:CreateSnapshot", "access_level": "Write", "condition": null}, {"action": "storagegateway:ListTagsForResource", "effective_action": "storagegateway:ListTagsForResource", "access_level": "List", "condition": null}, {"action": "ec2:CopySnapshot", "effective_action": "ec2:CopySnapshot", "access_level": "Write", "condition": null}, {"action": "ec2:CopyImage", "effective_action": "ec2:CopyImage", "access_level": "Write", "condition": null}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": null}, {"action": "ec2:DeleteSnapshot", "effective_action": "ec2:DeleteSnapshot", "access_level": "Write", "condition": null}, {"action": "ec2:CreateImage", "effective_action": "ec2:CreateImage", "access_level": "Write", "condition": null}, {"action": "ec2:DeregisterImage", "effective_action": "ec2:DeregisterImage", "access_level": "Write", "condition": null}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": null}, {"action": "ec2:DescribeSnapshots", "effective_action": "ec2:DescribeSnapshots", "access_level": "List", "condition": null}, {"action": "ec2:DescribeTags", "effective_action": "ec2:DescribeTags", "access_level": "Read", "condition": null}, {"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_level": "List", "condition": null}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null}, {"action": "ec2:DescribeInstanceAttribute", "effective_action": "ec2:DescribeInstanceAttribute", "access_level": "List", "condition": null}, {"action": "ec2:DescribeInstanceCreditSpecifications", "effective_action": "ec2:DescribeInstanceCreditSpecifications", "access_level": "List", "condition": null}, {"action": "ec2:DescribeNetworkInterfaces", "effective_action": "ec2:DescribeNetworkInterfaces", "access_level": "List", "condition": null}, {"action": "ec2:DescribeElasticGpus", "effective_action": "ec2:DescribeElasticGpus", "access_level": "Read", "condition": null}, {"action": "ec2:DescribeSpotInstanceRequests", "effective_action": "ec2:DescribeSpotInstanceRequests", "access_level": "List", "condition": null}, {"action": "ec2:ModifySnapshotAttribute", "effective_action": "ec2:ModifySnapshotAttribute", "access_level": "Permissions management", "condition": {"Null": {"aws:ResourceTag/aws:backup:source-resource": "false"}}}, {"action": "ec2:ModifyImageAttribute", "effective_action": "ec2:ModifyImageAttribute", "access_level": "Write", "condition": {"Null": {"aws:ResourceTag/aws:backup:source-resource": "false"}}}, {"action": "backup:DescribeBackupVault", "effective_action": "backup:DescribeBackupVault", "access_level": "Read", "condition": null}, {"action": "backup:CopyIntoBackupVault", "effective_action": "backup:CopyIntoBackupVault", "access_level": "Write", "condition": null}, {"action": "backup:CopyFromBackupVault", "effective_action": "backup:CopyFromBackupVault", "access_level": "Write", "condition": null}, {"action": "elasticfilesystem:Backup", "effective_action": "elasticfilesystem:Backup", "access_level": "Write", "condition": null}, {"action": "elasticfilesystem:DescribeTags", "effective_action": "elasticfilesystem:DescribeTags", "access_level": "Read", "condition": null}, {"action": "ec2:CreateSnapshot", "effective_action": "ec2:CreateSnapshot", "access_level": "Write", "condition": null}, {"action": "ec2:DeleteSnapshot", "effective_action": "ec2:DeleteSnapshot", "access_level": "Write", "condition": null}, {"action": "ec2:DescribeVolumes", "effective_action": "ec2:DescribeVolumes", "access_level": "List", "condition": null}, {"action": "ec2:DescribeSnapshots", "effective_action": "ec2:DescribeSnapshots", "access_level": "List", "condition": null}, {"action": "kms:Decrypt", "effective_action": "kms:Decrypt", "access_level": "Write", "condition": {"StringLike": {"kms:ViaService": ["dynamodb.*.amazonaws.com"]}}}, {"action": "kms:GenerateDataKey", "effective_action": "kms:GenerateDataKey", "access_level": "Write", "condition": {"StringLike": {"kms:ViaService": ["dynamodb.*.amazonaws.com"]}}}, {"action": "kms:DescribeKey", "effective_action": "kms:DescribeKey", "access_level": "Read", "condition": null}, {"action": "kms:CreateGrant", "effective_action": "kms:CreateGrant", "access_level": "Permissions management", "condition": {"Bool": {"kms:GrantIsForAWSResource": "true"}}}, {"action": "kms:GenerateDataKeyWithoutPlaintext", "effective_action": "kms:GenerateDataKeyWithoutPlaintext", "access_level": "Write", "condition": {"StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com"]}}}, {"action": "tag:GetResources", "effective_action": "tag:GetResources", "access_level": "Read", "condition": null}, {"action": "ssm:CancelCommand", "effective_action": "ssm:CancelCommand", "access_level": "Write", "condition": null}, {"action": "ssm:GetCommandInvocation", "effective_action": "ssm:GetCommandInvocation", "access_level": "Read", "condition": null}, {"action": "ssm:SendCommand", "effective_action": "ssm:SendCommand", "access_level": "Write", "condition": null}, {"action": "fsx:DescribeBackups", "effective_action": "fsx:DescribeBackups", "access_level": "Read", "condition": null}, {"action": "fsx:CreateBackup", "effective_action": "fsx:CreateBackup", "access_level": "Tagging", "condition": null}, {"action": "fsx:DescribeFileSystems", "effective_action": "fsx:DescribeFileSystems", "access_level": "Read", "condition": null}, {"action": "fsx:ListTagsForResource", "effective_action": "fsx:ListTagsForResource", "access_level": "Read", "condition": null}, {"action": "fsx:DeleteBackup", "effective_action": "fsx:DeleteBackup", "access_level": "Write", "condition": null}, {"action": "fsx:ListTagsForResource", "effective_action": "fsx:ListTagsForResource", "access_level": "Read", "condition": null}, {"action": "fsx:ManageBackupPrincipalAssociations", "effective_action": "fsx:ManageBackupPrincipalAssociations", "access_level": "Permissions management", "condition": null}, {"action": "fsx:CopyBackup", "effective_action": "fsx:CopyBackup", "access_level": "Write", "condition": null}, {"action": "fsx:TagResource", "effective_action": "fsx:TagResource", "access_level": "Tagging", "condition": null}]}