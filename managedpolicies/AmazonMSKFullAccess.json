{"name": "AmazonMSKFullAccess", "deprecated": false, "createdate": "2020-03-14T00:45:51Z", "updatedate": "2020-03-14T00:45:51+00:00", "version": "v3", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["kafka:*", "ec2:DescribeSubnets", "ec2:DescribeVpcs", "ec2:DescribeSecurityGroups", "kms:DescribeKey", "kms:CreateGrant", "logs:CreateLogDelivery", "logs:GetLogDelivery", "logs:UpdateLogDelivery", "logs:DeleteLogDelivery", "logs:ListLogDeliveries", "S3:GetBucketPolicy", "logs:PutResourcePolicy", "logs:DescribeResourcePolicies", "logs:DescribeLogGroups", "firehose:TagDeliveryStream"], "Resource": "*"}, {"Effect": "Allow", "Action": ["iam:CreateServiceLinkedRole"], "Resource": "arn:aws:iam::*:role/aws-service-role/kafka.amazonaws.com/AWSServiceRoleForKafka*", "Condition": {"StringLike": {"iam:AWSServiceName": "kafka.amazonaws.com"}}}, {"Effect": "Allow", "Action": ["iam:AttachRolePolicy", "iam:PutRolePolicy"], "Resource": "arn:aws:iam::*:role/aws-service-role/kafka.amazonaws.com/AWSServiceRoleForKafka*"}, {"Effect": "Allow", "Action": ["iam:CreateServiceLinkedRole"], "Resource": "arn:aws:iam::*:role/aws-service-role/delivery.logs.amazonaws.com/AWSServiceRoleForLogDelivery*", "Condition": {"StringLike": {"iam:AWSServiceName": "delivery.logs.amazonaws.com"}}}]}, "effective_actions": [{"action": "kafka:*", "effective_action": "kafka:BatchAssociateScramSecret", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:BatchDisassociateScramSecret", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:CreateCluster", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:CreateConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:DeleteCluster", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:DeleteConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:DescribeCluster", "access_level": "Read", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:DescribeClusterOperation", "access_level": "Read", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:DescribeConfiguration", "access_level": "Read", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:DescribeConfigurationRevision", "access_level": "Read", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:GetBootstrapBrokers", "access_level": "Read", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:GetCompatibleKafkaVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:ListClusterOperations", "access_level": "List", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:ListClusters", "access_level": "List", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:ListConfigurationRevisions", "access_level": "List", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:ListConfigurations", "access_level": "List", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:ListKafkaVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:ListNodes", "access_level": "List", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:ListScramSecrets", "access_level": "List", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:ListTagsForResource", "access_level": "List", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:RebootBroker", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:TagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:UntagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:UpdateBrokerCount", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:UpdateBrokerStorage", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:UpdateBrokerType", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:UpdateClusterConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:UpdateClusterKafkaVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:UpdateConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kafka:*", "effective_action": "kafka:UpdateMonitoring", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "kms:DescribeKey", "effective_action": "kms:DescribeKey", "access_level": "Read", "condition": null, "privesc": false}, {"action": "kms:CreateGrant", "effective_action": "kms:CreateGrant", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "logs:CreateLogDelivery", "effective_action": "logs:CreateLogDelivery", "access_level": "Write", "condition": null, "privesc": false}, {"action": "logs:GetLogDelivery", "effective_action": "logs:GetLogDelivery", "access_level": "Read", "condition": null, "privesc": false}, {"action": "logs:UpdateLogDelivery", "effective_action": "logs:UpdateLogDelivery", "access_level": "Write", "condition": null, "privesc": false}, {"action": "logs:DeleteLogDelivery", "effective_action": "logs:DeleteLogDelivery", "access_level": "Write", "condition": null, "privesc": false}, {"action": "logs:ListLogDeliveries", "effective_action": "logs:ListLogDeliveries", "access_level": "List", "condition": null, "privesc": false}, {"action": "S3:GetBucketPolicy", "effective_action": "s3:GetBucketPolicy", "access_level": "Read", "condition": null, "privesc": false}, {"action": "logs:PutResourcePolicy", "effective_action": "logs:PutResourcePolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "logs:DescribeResourcePolicies", "effective_action": "logs:DescribeResourcePolicies", "access_level": "List", "condition": null, "privesc": false}, {"action": "logs:DescribeLogGroups", "effective_action": "logs:DescribeLogGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "firehose:TagDeliveryStream", "effective_action": "firehose:TagDeliveryStream", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "iam:CreateServiceLinkedRole", "effective_action": "iam:CreateServiceLinkedRole", "access_level": "Write", "condition": {"StringLike": {"iam:AWSServiceName": "kafka.amazonaws.com"}}, "privesc": false}, {"action": "iam:AttachRolePolicy", "effective_action": "iam:AttachRolePolicy", "access_level": "Permissions management", "condition": null, "privesc": true}, {"action": "iam:PutRolePolicy", "effective_action": "iam:PutRolePolicy", "access_level": "Permissions management", "condition": null, "privesc": true}, {"action": "iam:CreateServiceLinkedRole", "effective_action": "iam:CreateServiceLinkedRole", "access_level": "Write", "condition": {"StringLike": {"iam:AWSServiceName": "delivery.logs.amazonaws.com"}}, "privesc": false}]}