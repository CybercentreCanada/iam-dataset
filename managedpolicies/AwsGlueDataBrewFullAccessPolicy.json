{"name": "AwsGlueDataBrewFullAccessPolicy", "deprecated": false, "createdate": "2021-06-30T18:23:37Z", "updatedate": "2021-06-30T18:23:37+00:00", "version": "v6", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["appflow:DescribeFlow", "appflow:DescribeFlowExecutionRecords", "appflow:ListFlows", "databrew:*", "glue:GetConnection", "glue:GetConnections", "glue:GetDatabases", "glue:GetPartitions", "glue:GetTable", "glue:GetTables", "glue:GetDataCatalogEncryptionSettings", "dataexchange:ListDataSets", "dataexchange:ListDataSetRevisions", "dataexchange:ListRevisionAssets", "dataexchange:CreateJob", "dataexchange:StartJob", "dataexchange:GetJob", "ec2:DescribeSecurityGroups", "ec2:DescribeVpcs", "ec2:DescribeSubnets", "kms:DescribeKey", "kms:ListKeys", "kms:ListAliases", "redshift:DescribeClusters", "redshift:DescribeClusterSubnetGroups", "redshift-data:ListDatabases", "redshift-data:ListSchemas", "redshift-data:ListTables", "s3:ListAllMyBuckets", "s3:GetBucketCORS", "s3:GetBucketLocation", "s3:GetEncryptionConfiguration", "secretsmanager:ListSecrets", "secretsmanager:DescribeSecret", "sts:GetCallerIdentity", "cloudtrail:LookupEvents", "iam:ListRoles", "iam:GetRole"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["glue:CreateConnection"], "Resource": ["arn:aws:glue:*:*:catalog", "arn:aws:glue:*:*:connection/AwsGlueDataBrew-*"]}, {"Effect": "Allow", "Action": ["glue:GetDatabases"], "Resource": ["arn:aws:glue:*:*:catalog", "arn:aws:glue:*:*:database/*"]}, {"Effect": "Allow", "Action": ["glue:CreateTable"], "Resource": ["arn:aws:glue:*:*:catalog", "arn:aws:glue:*:*:database/*", "arn:aws:glue:*:*:table/*/awsgluedatabrew*"]}, {"Effect": "Allow", "Action": ["s3:ListBucket", "s3:GetObject"], "Resource": ["arn:aws:s3:::databrew-public-datasets-*"]}, {"Effect": "Allow", "Action": ["kms:GenerateDataKey"], "Resource": ["*"], "Condition": {"StringLike": {"kms:ViaService": "s3.*.amazonaws.com"}}}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "arn:aws:iam::*:role/*", "Condition": {"StringEquals": {"iam:PassedToService": ["databrew.amazonaws.com"]}}}]}, "effective_actions": [{"action": "appflow:DescribeFlow", "effective_action": "appflow:DescribeFlow", "access_level": "Read", "condition": null, "privesc": false}, {"action": "appflow:DescribeFlowExecutionRecords", "effective_action": "appflow:DescribeFlowExecutionRecords", "access_level": "Read", "condition": null, "privesc": false}, {"action": "appflow:ListFlows", "effective_action": "appflow:ListFlows", "access_level": "List", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:BatchDeleteRecipeVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:CreateDataset", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:CreateProfileJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:CreateProject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:CreateRecipe", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:CreateRecipeJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:CreateSchedule", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DeleteDataset", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DeleteJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DeleteProject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DeleteRecipeVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DeleteSchedule", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DescribeDataset", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DescribeJob", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DescribeJobRun", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DescribeProject", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DescribeRecipe", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:DescribeSchedule", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:ListDatasets", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:ListJobRuns", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:ListJobs", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:ListProjects", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:ListRecipeVersions", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:ListRecipes", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:ListSchedules", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:ListTagsForResource", "access_level": "Read", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:PublishRecipe", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:SendProjectSessionAction", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:StartJobRun", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:StartProjectSession", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:StopJobRun", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:TagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:UntagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:UpdateDataset", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:UpdateProfileJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:UpdateProject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:UpdateRecipe", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:UpdateRecipeJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "databrew:*", "effective_action": "databrew:UpdateSchedule", "access_level": "Write", "condition": null, "privesc": false}, {"action": "glue:GetConnection", "effective_action": "glue:GetConnection", "access_level": "Read", "condition": null, "privesc": false}, {"action": "glue:GetConnections", "effective_action": "glue:GetConnections", "access_level": "Read", "condition": null, "privesc": false}, {"action": "glue:GetDatabases", "effective_action": "glue:GetDatabases", "access_level": "Read", "condition": null, "privesc": false}, {"action": "glue:GetPartitions", "effective_action": "glue:GetPartitions", "access_level": "Read", "condition": null, "privesc": false}, {"action": "glue:GetTable", "effective_action": "glue:GetTable", "access_level": "Read", "condition": null, "privesc": false}, {"action": "glue:GetTables", "effective_action": "glue:GetTables", "access_level": "Read", "condition": null, "privesc": false}, {"action": "glue:GetDataCatalogEncryptionSettings", "effective_action": "glue:GetDataCatalogEncryptionSettings", "access_level": "Read", "condition": null, "privesc": false}, {"action": "dataexchange:ListDataSets", "effective_action": "dataexchange:ListDataSets", "access_level": "List", "condition": null, "privesc": false}, {"action": "dataexchange:ListDataSetRevisions", "effective_action": "dataexchange:ListDataSetRevisions", "access_level": "List", "condition": null, "privesc": false}, {"action": "dataexchange:ListRevisionAssets", "effective_action": "dataexchange:ListRevisionAssets", "access_level": "List", "condition": null, "privesc": false}, {"action": "dataexchange:CreateJob", "effective_action": "dataexchange:CreateJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "dataexchange:StartJob", "effective_action": "dataexchange:StartJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "dataexchange:GetJob", "effective_action": "dataexchange:GetJob", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false}, {"action": "kms:DescribeKey", "effective_action": "kms:DescribeKey", "access_level": "Read", "condition": null, "privesc": false}, {"action": "kms:ListKeys", "effective_action": "kms:ListKeys", "access_level": "List", "condition": null, "privesc": false}, {"action": "kms:ListAliases", "effective_action": "kms:ListAliases", "access_level": "List", "condition": null, "privesc": false}, {"action": "redshift:DescribeClusters", "effective_action": "redshift:DescribeClusters", "access_level": "List", "condition": null, "privesc": false}, {"action": "redshift:DescribeClusterSubnetGroups", "effective_action": "redshift:DescribeClusterSubnetGroups", "access_level": "Read", "condition": null, "privesc": false}, {"action": "redshift-data:ListDatabases", "effective_action": "redshift-data:ListDatabases", "access_level": "Read", "condition": null, "privesc": false}, {"action": "redshift-data:ListSchemas", "effective_action": "redshift-data:ListSchemas", "access_level": "Read", "condition": null, "privesc": false}, {"action": "redshift-data:ListTables", "effective_action": "redshift-data:ListTables", "access_level": "List", "condition": null, "privesc": false}, {"action": "s3:ListAllMyBuckets", "effective_action": "s3:ListAllMyBuckets", "access_level": "List", "condition": null, "privesc": false}, {"action": "s3:GetBucketCORS", "effective_action": "s3:GetBucketCORS", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:GetBucketLocation", "effective_action": "s3:GetBucketLocation", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:GetEncryptionConfiguration", "effective_action": "s3:GetEncryptionConfiguration", "access_level": "Read", "condition": null, "privesc": false}, {"action": "secretsmanager:ListSecrets", "effective_action": "secretsmanager:ListSecrets", "access_level": "List", "condition": null, "privesc": false}, {"action": "secretsmanager:DescribeSecret", "effective_action": "secretsmanager:DescribeSecret", "access_level": "Read", "condition": null, "privesc": false}, {"action": "sts:GetCallerIdentity", "effective_action": "sts:GetCallerIdentity", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudtrail:LookupEvents", "effective_action": "cloudtrail:LookupEvents", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:ListRoles", "effective_action": "iam:ListRoles", "access_level": "List", "condition": null, "privesc": false}, {"action": "iam:GetRole", "effective_action": "iam:GetRole", "access_level": "Read", "condition": null, "privesc": false}, {"action": "glue:CreateConnection", "effective_action": "glue:CreateConnection", "access_level": "Write", "condition": null, "privesc": false}, {"action": "glue:GetDatabases", "effective_action": "glue:GetDatabases", "access_level": "Read", "condition": null, "privesc": false}, {"action": "glue:CreateTable", "effective_action": "glue:CreateTable", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:ListBucket", "effective_action": "s3:ListBucket", "access_level": "List", "condition": null, "privesc": false}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null, "privesc": false}, {"action": "kms:GenerateDataKey", "effective_action": "kms:GenerateDataKey", "access_level": "Write", "condition": {"StringLike": {"kms:ViaService": "s3.*.amazonaws.com"}}, "privesc": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": ["databrew.amazonaws.com"]}}, "privesc": true}]}