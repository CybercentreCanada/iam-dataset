{"name": "AWSBackupServiceLinkedRolePolicyForBackup", "deprecated": false, "createdate": "2021-10-20T18:16:29Z", "updatedate": "2021-10-20T18:16:29+00:00", "version": "v5", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": false, "resource_exposure": true, "credentials_exposure": false, "document": {"Version": "2012-10-17", "Statement": [{"Action": ["elasticfilesystem:Backup", "elasticfilesystem:DescribeTags"], "Resource": "arn:aws:elasticfilesystem:*:*:file-system/*", "Effect": "Allow", "Condition": {"StringLike": {"aws:ResourceTag/aws:elasticfilesystem:default-backup": "enabled"}}}, {"Action": ["tag:GetResources", "elasticfilesystem:DescribeFileSystems", "dynamodb:ListTables", "storagegateway:ListVolumes", "ec2:DescribeVolumes", "ec2:DescribeInstances", "rds:DescribeDBInstances", "rds:DescribeDBClusters", "fsx:DescribeFileSystems"], "Resource": "*", "Effect": "Allow"}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": "arn:aws:ec2:*::snapshot/*", "Condition": {"StringEquals": {"ec2:CreateAction": "CopySnapshot"}}}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*::image/*", "arn:aws:ec2:*::snapshot/*"], "Condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["AWSBackupManagedResource"]}}}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*::image/*", "arn:aws:ec2:*::snapshot/*"], "Condition": {"Null": {"ec2:ResourceTag/AWSBackupManagedResource": "false"}}}, {"Effect": "Allow", "Action": ["ec2:DescribeSnapshots", "ec2:DescribeImages", "rds:DescribeDBSnapshots", "rds:DescribeDBClusterSnapshots"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:CopySnapshot"], "Resource": "arn:aws:ec2:*::snapshot/*"}, {"Effect": "Allow", "Action": ["ec2:CopyImage"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:DeregisterImage", "ec2:DeleteSnapshot"], "Resource": "*", "Condition": {"Null": {"ec2:ResourceTag/AWSBackupManagedResource": "false"}}}, {"Effect": "Allow", "Action": ["rds:AddTagsToResource", "rds:CopyDBSnapshot", "rds:DeleteDBSnapshot"], "Resource": "arn:aws:rds:*:*:snapshot:awsbackup:*"}, {"Effect": "Allow", "Action": ["rds:AddTagsToResource", "rds:CopyDBClusterSnapshot", "rds:DeleteDBClusterSnapshot"], "Resource": "arn:aws:rds:*:*:cluster-snapshot:awsbackup:*"}, {"Effect": "Allow", "Action": ["kms:DescribeKey"], "Resource": "*"}, {"Effect": "Allow", "Action": ["kms:ListGrants", "kms:ReEncryptFrom", "kms:GenerateDataKeyWithoutPlaintext"], "Resource": "*", "Condition": {"StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["kms:CreateGrant"], "Resource": "*", "Condition": {"Bool": {"kms:GrantIsForAWSResource": "true"}, "StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}}, {"Action": ["fsx:CopyBackup", "fsx:TagResource", "fsx:DescribeBackups", "fsx:DeleteBackup"], "Resource": "arn:aws:fsx:*:*:backup/*", "Effect": "Allow"}, {"Effect": "Allow", "Action": ["dynamodb:DeleteBackup"], "Resource": "arn:aws:dynamodb:*:*:table/*/backup/*"}]}, "effective_actions": [{"action": "elasticfilesystem:Backup", "effective_action": "elasticfilesystem:Backup", "access_level": "Write", "condition": {"StringLike": {"aws:ResourceTag/aws:elasticfilesystem:default-backup": "enabled"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticfilesystem:DescribeTags", "effective_action": "elasticfilesystem:DescribeTags", "access_level": "Read", "condition": {"StringLike": {"aws:ResourceTag/aws:elasticfilesystem:default-backup": "enabled"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "tag:GetResources", "effective_action": "tag:GetResources", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "elasticfilesystem:DescribeFileSystems", "effective_action": "elasticfilesystem:DescribeFileSystems", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "dynamodb:ListTables", "effective_action": "dynamodb:ListTables", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "storagegateway:ListVolumes", "effective_action": "storagegateway:ListVolumes", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeVolumes", "effective_action": "ec2:DescribeVolumes", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "rds:DescribeDBInstances", "effective_action": "rds:DescribeDBInstances", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "rds:DescribeDBClusters", "effective_action": "rds:DescribeDBClusters", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "fsx:DescribeFileSystems", "effective_action": "fsx:DescribeFileSystems", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringEquals": {"ec2:CreateAction": "CopySnapshot"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["AWSBackupManagedResource"]}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"Null": {"ec2:ResourceTag/AWSBackupManagedResource": "false"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeSnapshots", "effective_action": "ec2:DescribeSnapshots", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "rds:DescribeDBSnapshots", "effective_action": "rds:DescribeDBSnapshots", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "rds:DescribeDBClusterSnapshots", "effective_action": "rds:DescribeDBClusterSnapshots", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CopySnapshot", "effective_action": "ec2:CopySnapshot", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:CopyImage", "effective_action": "ec2:CopyImage", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DeregisterImage", "effective_action": "ec2:DeregisterImage", "access_level": "Write", "condition": {"Null": {"ec2:ResourceTag/AWSBackupManagedResource": "false"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "ec2:DeleteSnapshot", "effective_action": "ec2:DeleteSnapshot", "access_level": "Write", "condition": {"Null": {"ec2:ResourceTag/AWSBackupManagedResource": "false"}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "rds:AddTagsToResource", "effective_action": "rds:AddTagsToResource", "access_level": "Tagging", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "rds:CopyDBSnapshot", "effective_action": "rds:CopyDBSnapshot", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "rds:DeleteDBSnapshot", "effective_action": "rds:DeleteDBSnapshot", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "rds:AddTagsToResource", "effective_action": "rds:AddTagsToResource", "access_level": "Tagging", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "rds:CopyDBClusterSnapshot", "effective_action": "rds:CopyDBClusterSnapshot", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "rds:DeleteDBClusterSnapshot", "effective_action": "rds:DeleteDBClusterSnapshot", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "kms:DescribeKey", "effective_action": "kms:DescribeKey", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "kms:ListGrants", "effective_action": "kms:ListGrants", "access_level": "List", "condition": {"StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "kms:ReEncryptFrom", "effective_action": "kms:ReEncryptFrom", "access_level": "Write", "condition": {"StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "kms:GenerateDataKeyWithoutPlaintext", "effective_action": "kms:GenerateDataKeyWithoutPlaintext", "access_level": "Write", "condition": {"StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "kms:CreateGrant", "effective_action": "kms:CreateGrant", "access_level": "Permissions management", "condition": {"Bool": {"kms:GrantIsForAWSResource": "true"}, "StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "fsx:CopyBackup", "effective_action": "fsx:CopyBackup", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "fsx:TagResource", "effective_action": "fsx:TagResource", "access_level": "Tagging", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "fsx:DescribeBackups", "effective_action": "fsx:DescribeBackups", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "fsx:DeleteBackup", "effective_action": "fsx:DeleteBackup", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "dynamodb:DeleteBackup", "effective_action": "dynamodb:DeleteBackup", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}]}