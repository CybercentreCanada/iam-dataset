{"name": "AWSBackupServiceLinkedRolePolicyForBackup", "deprecated": false, "createdate": "2021-04-12T18:11:02Z", "updatedate": "2021-04-12T18:11:02+00:00", "version": "v3", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": false, "document": {"Version": "2012-10-17", "Statement": [{"Action": ["elasticfilesystem:Backup", "elasticfilesystem:DescribeTags"], "Resource": "arn:aws:elasticfilesystem:*:*:file-system/*", "Effect": "Allow", "Condition": {"StringLike": {"aws:ResourceTag/aws:elasticfilesystem:default-backup": "enabled"}}}, {"Action": ["tag:GetResources"], "Resource": "*", "Effect": "Allow"}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": "arn:aws:ec2:*::snapshot/*", "Condition": {"StringEquals": {"ec2:CreateAction": "CopySnapshot"}}}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*::image/*", "arn:aws:ec2:*::snapshot/*"], "Condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["AWSBackupManagedResource"]}}}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*::image/*", "arn:aws:ec2:*::snapshot/*"], "Condition": {"Null": {"ec2:ResourceTag/AWSBackupManagedResource": "false"}}}, {"Effect": "Allow", "Action": ["ec2:DescribeSnapshots", "ec2:DescribeImages", "rds:DescribeDBSnapshots", "rds:DescribeDBClusterSnapshots"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:CopySnapshot"], "Resource": "arn:aws:ec2:*::snapshot/*"}, {"Effect": "Allow", "Action": ["ec2:CopyImage"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:DeregisterImage", "ec2:DeleteSnapshot"], "Resource": "*", "Condition": {"Null": {"ec2:ResourceTag/AWSBackupManagedResource": "false"}}}, {"Effect": "Allow", "Action": ["rds:AddTagsToResource", "rds:CopyDBSnapshot", "rds:DeleteDBSnapshot"], "Resource": "arn:aws:rds:*:*:snapshot:awsbackup:*"}, {"Effect": "Allow", "Action": ["rds:AddTagsToResource", "rds:CopyDBClusterSnapshot", "rds:DeleteDBClusterSnapshot"], "Resource": "arn:aws:rds:*:*:cluster-snapshot:awsbackup:*"}, {"Effect": "Allow", "Action": ["kms:DescribeKey"], "Resource": "*"}, {"Effect": "Allow", "Action": ["kms:ListGrants", "kms:ReEncryptFrom", "kms:GenerateDataKeyWithoutPlaintext"], "Resource": "*", "Condition": {"StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["kms:CreateGrant"], "Resource": "*", "Condition": {"Bool": {"kms:GrantIsForAWSResource": "true"}, "StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}}, {"Action": ["fsx:CopyBackup", "fsx:TagResource", "fsx:DescribeBackups", "fsx:DeleteBackup"], "Resource": "arn:aws:fsx:*:*:backup/*", "Effect": "Allow"}]}, "effective_actions": [{"action": "elasticfilesystem:Backup", "effective_action": "elasticfilesystem:Backup", "access_level": "Write", "condition": {"StringLike": {"aws:ResourceTag/aws:elasticfilesystem:default-backup": "enabled"}}}, {"action": "elasticfilesystem:DescribeTags", "effective_action": "elasticfilesystem:DescribeTags", "access_level": "Read", "condition": {"StringLike": {"aws:ResourceTag/aws:elasticfilesystem:default-backup": "enabled"}}}, {"action": "tag:GetResources", "effective_action": "tag:GetResources", "access_level": "Read", "condition": null}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringEquals": {"ec2:CreateAction": "CopySnapshot"}}}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["AWSBackupManagedResource"]}}}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"Null": {"ec2:ResourceTag/AWSBackupManagedResource": "false"}}}, {"action": "ec2:DescribeSnapshots", "effective_action": "ec2:DescribeSnapshots", "access_level": "List", "condition": null}, {"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_level": "List", "condition": null}, {"action": "rds:DescribeDBSnapshots", "effective_action": "rds:DescribeDBSnapshots", "access_level": "List", "condition": null}, {"action": "rds:DescribeDBClusterSnapshots", "effective_action": "rds:DescribeDBClusterSnapshots", "access_level": "List", "condition": null}, {"action": "ec2:CopySnapshot", "effective_action": "ec2:CopySnapshot", "access_level": "Write", "condition": null}, {"action": "ec2:CopyImage", "effective_action": "ec2:CopyImage", "access_level": "Write", "condition": null}, {"action": "ec2:DeregisterImage", "effective_action": "ec2:DeregisterImage", "access_level": "Write", "condition": {"Null": {"ec2:ResourceTag/AWSBackupManagedResource": "false"}}}, {"action": "ec2:DeleteSnapshot", "effective_action": "ec2:DeleteSnapshot", "access_level": "Write", "condition": {"Null": {"ec2:ResourceTag/AWSBackupManagedResource": "false"}}}, {"action": "rds:AddTagsToResource", "effective_action": "rds:AddTagsToResource", "access_level": "Tagging", "condition": null}, {"action": "rds:CopyDBSnapshot", "effective_action": "rds:CopyDBSnapshot", "access_level": "Write", "condition": null}, {"action": "rds:DeleteDBSnapshot", "effective_action": "rds:DeleteDBSnapshot", "access_level": "Write", "condition": null}, {"action": "rds:AddTagsToResource", "effective_action": "rds:AddTagsToResource", "access_level": "Tagging", "condition": null}, {"action": "rds:CopyDBClusterSnapshot", "effective_action": "rds:CopyDBClusterSnapshot", "access_level": "Write", "condition": null}, {"action": "rds:DeleteDBClusterSnapshot", "effective_action": "rds:DeleteDBClusterSnapshot", "access_level": "Write", "condition": null}, {"action": "kms:DescribeKey", "effective_action": "kms:DescribeKey", "access_level": "Read", "condition": null}, {"action": "kms:ListGrants", "effective_action": "kms:ListGrants", "access_level": "List", "condition": {"StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}}, {"action": "kms:ReEncryptFrom", "effective_action": "kms:ReEncryptFrom", "access_level": "Write", "condition": {"StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}}, {"action": "kms:GenerateDataKeyWithoutPlaintext", "effective_action": "kms:GenerateDataKeyWithoutPlaintext", "access_level": "Write", "condition": {"StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}}, {"action": "kms:CreateGrant", "effective_action": "kms:CreateGrant", "access_level": "Permissions management", "condition": {"Bool": {"kms:GrantIsForAWSResource": "true"}, "StringLike": {"kms:ViaService": ["ec2.*.amazonaws.com", "rds.*.amazonaws.com", "fsx.*.amazonaws.com"]}}}, {"action": "fsx:CopyBackup", "effective_action": "fsx:CopyBackup", "access_level": "Write", "condition": null}, {"action": "fsx:TagResource", "effective_action": "fsx:TagResource", "access_level": "Tagging", "condition": null}, {"action": "fsx:DescribeBackups", "effective_action": "fsx:DescribeBackups", "access_level": "Read", "condition": null}, {"action": "fsx:DeleteBackup", "effective_action": "fsx:DeleteBackup", "access_level": "Write", "condition": null}]}