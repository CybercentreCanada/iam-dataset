{"name": "AWSMarketplaceFullAccess", "deprecated": false, "createdate": "2018-08-08T21:13:02Z", "updatedate": "2018-08-08T21:13:02+00:00", "version": "v3", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["aws-marketplace:*", "cloudformation:CreateStack", "cloudformation:DescribeStackResource", "cloudformation:DescribeStackResources", "cloudformation:DescribeStacks", "cloudformation:List*", "ec2:AuthorizeSecurityGroupEgress", "ec2:AuthorizeSecurityGroupIngress", "ec2:CreateSecurityGroup", "ec2:CreateTags", "ec2:DescribeAccountAttributes", "ec2:DescribeAddresses", "ec2:DeleteSecurityGroup", "ec2:DescribeAccountAttributes", "ec2:DescribeImages", "ec2:DescribeInstances", "ec2:DescribeKeyPairs", "ec2:DescribeSecurityGroups", "ec2:DescribeSubnets", "ec2:DescribeTags", "ec2:DescribeVpcs", "ec2:RunInstances", "ec2:StartInstances", "ec2:StopInstances", "ec2:TerminateInstances"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:CopyImage", "ec2:DeregisterImage", "ec2:DescribeSnapshots", "ec2:DeleteSnapshot", "ec2:CreateImage", "ec2:DescribeInstanceStatus", "ssm:GetAutomationExecution", "ssm:UpdateDocumentDefaultVersion", "ssm:CreateDocument", "ssm:StartAutomationExecution", "ssm:ListDocuments", "ssm:UpdateDocument", "ssm:DescribeDocument", "sns:ListTopics", "sns:GetTopicAttributes", "sns:CreateTopic", "iam:GetRole", "iam:GetInstanceProfile", "iam:ListRoles", "iam:ListInstanceProfiles"], "Resource": "*"}, {"Effect": "Allow", "Action": ["s3:ListBucket", "s3:GetObject"], "Resource": ["arn:aws:s3:::*image-build*"]}, {"Effect": "Allow", "Action": ["sns:Publish", "sns:setTopicAttributes"], "Resource": "arn:aws:sns:*:*:*image-build*"}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": ["*"], "Condition": {"StringLike": {"iam:PassedToService": ["ec2.amazonaws.com", "ssm.amazonaws.com"]}}}]}, "effective_actions": [{"action": "aws-marketplace:*", "effective_action": "aws-marketplace:DescribeBuilds", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:ListBuilds", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:StartBuild", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:AcceptAgreementApprovalRequest", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:CancelAgreementRequest", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:DescribeAgreement", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:GetAgreementApprovalRequest", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:GetAgreementRequest", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:GetAgreementTerms", "access_level": "List", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:ListAgreementApprovalRequests", "access_level": "List", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:ListAgreementRequests", "access_level": "List", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:RejectAgreementApprovalRequest", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:SearchAgreements", "access_level": "List", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:Subscribe", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:Unsubscribe", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:UpdateAgreementApprovalRequest", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:ViewSubscriptions", "access_level": "List", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:AssociateProductsWithPrivateMarketplace", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:CreatePrivateMarketplace", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:CreatePrivateMarketplaceRequests", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:DescribePrivateMarketplaceRequests", "access_level": "List", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:DescribePrivateMarketplaceStatus", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:DisassociateProductsFromPrivateMarketplace", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:ListPrivateMarketplaceRequests", "access_level": "List", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:DescribeProcurementSystemConfiguration", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:PutProcurementSystemConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:BatchMeterUsage", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:MeterUsage", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:RegisterUsage", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:ResolveCustomer", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:GetEntitlements", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:CancelChangeSet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:CompleteTask", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:DescribeChangeSet", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:DescribeEntity", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:DescribeTask", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:ListChangeSets", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:ListEntities", "access_level": "Read", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:ListTasks", "access_level": "List", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:StartChangeSet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "aws-marketplace:*", "effective_action": "aws-marketplace:UpdateTask", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:CreateStack", "effective_action": "cloudformation:CreateStack", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeStackResource", "effective_action": "cloudformation:DescribeStackResource", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeStackResources", "effective_action": "cloudformation:DescribeStackResources", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeStacks", "effective_action": "cloudformation:DescribeStacks", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListChangeSets", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListExports", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListImports", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListStackInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListStackResources", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListStackSetOperationResults", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListStackSetOperations", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListStackSets", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListStacks", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListTypeRegistrations", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListTypeVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:List*", "effective_action": "cloudformation:ListTypes", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:AuthorizeSecurityGroupEgress", "effective_action": "ec2:AuthorizeSecurityGroupEgress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:AuthorizeSecurityGroupIngress", "effective_action": "ec2:AuthorizeSecurityGroupIngress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateSecurityGroup", "effective_action": "ec2:CreateSecurityGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "ec2:DescribeAccountAttributes", "effective_action": "ec2:DescribeAccountAttributes", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeAddresses", "effective_action": "ec2:DescribeAddresses", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DeleteSecurityGroup", "effective_action": "ec2:DeleteSecurityGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DescribeAccountAttributes", "effective_action": "ec2:DescribeAccountAttributes", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeKeyPairs", "effective_action": "ec2:DescribeKeyPairs", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeTags", "effective_action": "ec2:DescribeTags", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:StartInstances", "effective_action": "ec2:StartInstances", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:StopInstances", "effective_action": "ec2:StopInstances", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:TerminateInstances", "effective_action": "ec2:TerminateInstances", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CopyImage", "effective_action": "ec2:CopyImage", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeregisterImage", "effective_action": "ec2:DeregisterImage", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DescribeSnapshots", "effective_action": "ec2:DescribeSnapshots", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DeleteSnapshot", "effective_action": "ec2:DeleteSnapshot", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateImage", "effective_action": "ec2:CreateImage", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstanceStatus", "effective_action": "ec2:DescribeInstanceStatus", "access_level": "List", "condition": null, "privesc": false}, {"action": "ssm:GetAutomationExecution", "effective_action": "ssm:GetAutomationExecution", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ssm:UpdateDocumentDefaultVersion", "effective_action": "ssm:UpdateDocumentDefaultVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ssm:CreateDocument", "effective_action": "ssm:CreateDocument", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ssm:StartAutomationExecution", "effective_action": "ssm:StartAutomationExecution", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ssm:ListDocuments", "effective_action": "ssm:ListDocuments", "access_level": "List", "condition": null, "privesc": false}, {"action": "ssm:UpdateDocument", "effective_action": "ssm:UpdateDocument", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ssm:DescribeDocument", "effective_action": "ssm:DescribeDocument", "access_level": "Read", "condition": null, "privesc": false}, {"action": "sns:ListTopics", "effective_action": "sns:ListTopics", "access_level": "List", "condition": null, "privesc": false}, {"action": "sns:GetTopicAttributes", "effective_action": "sns:GetTopicAttributes", "access_level": "Read", "condition": null, "privesc": false}, {"action": "sns:CreateTopic", "effective_action": "sns:CreateTopic", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iam:GetRole", "effective_action": "iam:GetRole", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:GetInstanceProfile", "effective_action": "iam:GetInstanceProfile", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:ListRoles", "effective_action": "iam:ListRoles", "access_level": "List", "condition": null, "privesc": false}, {"action": "iam:ListInstanceProfiles", "effective_action": "iam:ListInstanceProfiles", "access_level": "List", "condition": null, "privesc": false}, {"action": "s3:ListBucket", "effective_action": "s3:ListBucket", "access_level": "List", "condition": null, "privesc": false}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null, "privesc": false}, {"action": "sns:Publish", "effective_action": "sns:Publish", "access_level": "Write", "condition": null, "privesc": false}, {"action": "sns:setTopicAttributes", "effective_action": "sns:SetTopicAttributes", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringLike": {"iam:PassedToService": ["ec2.amazonaws.com", "ssm.amazonaws.com"]}}, "privesc": true}]}