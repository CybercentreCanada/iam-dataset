{"name": "FMSServiceRolePolicy", "deprecated": false, "createdate": "2021-08-12T19:21:06Z", "updatedate": "2021-08-12T19:21:06+00:00", "version": "v19", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["waf:UpdateWebACL", "waf:DeleteWebACL", "waf:GetWebACL", "waf:GetRuleGroup", "waf:ListSubscribedRuleGroups", "waf-regional:UpdateWebACL", "waf-regional:DeleteWebACL", "waf-regional:GetWebACL", "waf-regional:GetRuleGroup", "waf-regional:ListSubscribedRuleGroups", "waf-regional:ListResourcesForWebACL", "waf-regional:AssociateWebACL", "waf-regional:DisassociateWebACL", "elasticloadbalancing:SetWebACL", "apigateway:SetWebACL", "elasticloadbalancing:SetSecurityGroups"], "Resource": ["arn:aws:waf:*:*:webacl/*", "arn:aws:waf-regional:*:*:webacl/*", "arn:aws:waf:*:*:rulegroup/*", "arn:aws:waf-regional:*:*:rulegroup/*", "arn:aws:elasticloadbalancing:*:*:loadbalancer/app/*", "arn:aws:apigateway:*::/restapis/*/stages/*"]}, {"Effect": "Allow", "Action": ["wafv2:PutLoggingConfiguration", "wafv2:GetLoggingConfiguration", "wafv2:ListLoggingConfigurations", "wafv2:DeleteLoggingConfiguration"], "Resource": ["arn:aws:wafv2:*:*:regional/webacl/*", "arn:aws:wafv2:*:*:global/webacl/*"]}, {"Effect": "Allow", "Action": ["waf:CreateWebACL", "waf-regional:CreateWebACL", "waf:GetChangeToken", "waf-regional:GetChangeToken"], "Resource": ["arn:aws:waf:*:*:*", "arn:aws:waf-regional:*:*:*"]}, {"Effect": "Allow", "Action": ["elasticloadbalancing:ApplySecurityGroupsToLoadBalancer"], "Resource": "*"}, {"Effect": "Allow", "Action": ["waf:PutPermissionPolicy", "waf:GetPermissionPolicy", "waf:DeletePermissionPolicy", "waf-regional:PutPermissionPolicy", "waf-regional:GetPermissionPolicy", "waf-regional:DeletePermissionPolicy"], "Resource": ["arn:aws:waf:*:*:webacl/*", "arn:aws:waf:*:*:rulegroup/*", "arn:aws:waf-regional:*:*:webacl/*", "arn:aws:waf-regional:*:*:rulegroup/*"]}, {"Effect": "Allow", "Action": ["cloudfront:GetDistribution", "cloudfront:UpdateDistribution", "cloudfront:ListDistributionsByWebACLId", "cloudfront:ListDistributions"], "Resource": "*"}, {"Effect": "Allow", "Action": ["config:DeleteConfigRule", "config:DescribeComplianceByConfigRule", "config:DescribeConfigRuleEvaluationStatus", "config:DescribeConfigRules", "config:GetComplianceDetailsByConfigRule", "config:PutConfigRule", "config:StartConfigRulesEvaluation"], "Resource": "arn:aws:config:*:*:config-rule/aws-service-rule/fms.amazonaws.com/*"}, {"Effect": "Allow", "Action": ["config:DescribeConfigurationRecorders", "config:DescribeConfigurationRecorderStatus", "config:PutConfigurationRecorder", "config:StartConfigurationRecorder", "config:PutDeliveryChannel", "config:DescribeDeliveryChannels", "config:DescribeDeliveryChannelStatus", "config:GetComplianceSummaryByConfigRule", "config:GetDiscoveredResourceCounts", "config:PutEvaluations", "config:SelectResourceConfig"], "Resource": "*"}, {"Effect": "Allow", "Action": ["iam:DeleteServiceLinkedRole", "iam:GetServiceLinkedRoleDeletionStatus"], "Resource": ["arn:aws:iam::*:role/aws-service-role/fms.amazonaws.com/AWSServiceRoleForFMS"]}, {"Effect": "Allow", "Action": ["organizations:DescribeAccount", "organizations:DescribeOrganization", "organizations:ListAccounts", "organizations:DescribeOrganizationalUnit", "organizations:ListChildren", "organizations:ListRoots", "organizations:ListParents", "organizations:ListOrganizationalUnitsForParent", "organizations:ListAWSServiceAccessForOrganization"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["shield:CreateProtection", "shield:DeleteProtection", "shield:DescribeProtection", "shield:ListProtections", "shield:ListAttacks", "shield:CreateSubscription", "shield:DescribeSubscription", "shield:GetSubscriptionState", "shield:DescribeDRTAccess", "shield:DescribeEmergencyContactSettings", "shield:UpdateEmergencyContactSettings", "elasticloadbalancing:DescribeLoadBalancers", "ec2:DescribeAddresses"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:AuthorizeSecurityGroupEgress", "ec2:AuthorizeSecurityGroupIngress", "ec2:DeleteSecurityGroup", "ec2:RevokeSecurityGroupEgress", "ec2:RevokeSecurityGroupIngress", "ec2:UpdateSecurityGroupRuleDescriptionsEgress", "ec2:UpdateSecurityGroupRuleDescriptionsIngress", "ec2:DescribeNetworkInterfaceAttribute"], "Resource": ["arn:aws:ec2:*:*:network-interface/*", "arn:aws:ec2:*:*:security-group/*"]}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*:*:security-group/*"]}, {"Effect": "Allow", "Action": ["ec2:CreateSecurityGroup", "ec2:DescribeSecurityGroupReferences", "ec2:DescribeSecurityGroups", "ec2:DescribeStaleSecurityGroups", "ec2:DescribeNetworkInterfaces", "ec2:ModifyNetworkInterfaceAttribute", "ec2:DescribeVpcs", "ec2:DescribeVpcPeeringConnections"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["wafv2:TagResource", "wafv2:ListResourcesForWebACL", "wafv2:AssociateWebACL", "wafv2:ListTagsForResource", "wafv2:UntagResource", "wafv2:GetWebACL", "wafv2:DisassociateFirewallManager", "wafv2:DeleteWebACL", "wafv2:DisassociateWebACL"], "Resource": ["arn:aws:wafv2:*:*:global/webacl/*", "arn:aws:wafv2:*:*:regional/webacl/*"]}, {"Effect": "Allow", "Action": ["wafv2:UpdateWebACL", "wafv2:CreateWebACL", "wafv2:DeleteFirewallManagerRuleGroups", "wafv2:PutFirewallManagerRuleGroups"], "Resource": ["arn:aws:wafv2:*:*:global/webacl/*", "arn:aws:wafv2:*:*:regional/webacl/*", "arn:aws:wafv2:*:*:global/rulegroup/*", "arn:aws:wafv2:*:*:regional/rulegroup/*", "arn:aws:wafv2:*:*:global/managedruleset/*", "arn:aws:wafv2:*:*:regional/managedruleset/*", "arn:aws:wafv2:*:*:global/ipset/*", "arn:aws:wafv2:*:*:regional/ipset/*", "arn:aws:wafv2:*:*:global/regexpatternset/*", "arn:aws:wafv2:*:*:regional/regexpatternset/*"]}, {"Effect": "Allow", "Action": ["wafv2:PutPermissionPolicy", "wafv2:GetPermissionPolicy", "wafv2:DeletePermissionPolicy"], "Resource": ["arn:aws:wafv2:*:*:global/rulegroup/*", "arn:aws:wafv2:*:*:regional/rulegroup/*"]}, {"Effect": "Allow", "Action": ["cloudfront:ListTagsForResource"], "Resource": "*"}, {"Effect": "Allow", "Action": ["wafv2:GetWebACLForResource"], "Resource": ["arn:aws:wafv2:*:*:regional/webacl/*"]}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": "arn:aws:ec2:*:*:route-table/*", "Condition": {"StringEquals": {"ec2:CreateAction": "CreateRouteTable"}, "ForAllValues:StringEquals": {"aws:TagKeys": ["Name", "FMManaged"]}}}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*:*:subnet/*"], "Condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["Name", "FMManaged"]}}}, {"Effect": "Allow", "Action": ["ec2:DeleteRouteTable"], "Resource": "arn:aws:ec2:*:*:route-table/*", "Condition": {"StringEquals": {"ec2:ResourceTag/FMManaged": "true"}}}, {"Effect": "Allow", "Action": ["ec2:AssociateRouteTable", "ec2:CreateSubnet", "ec2:CreateRouteTable", "ec2:DeleteSubnet", "ec2:DisassociateRouteTable", "ec2:ReplaceRouteTableAssociation"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:DescribeInternetGateways", "ec2:DescribeRouteTables", "ec2:DescribeSubnets", "ec2:DescribeTags", "ec2:DescribeVpcEndpoints"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ram:TagResource"], "Resource": ["arn:aws:ram:*:*:resource-share/*"], "Condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["Name", "FMManaged"]}}}, {"Effect": "Allow", "Action": ["ram:AssociateResourceShare", "ram:UpdateResourceShare", "ram:DeleteResourceShare"], "Resource": "arn:aws:ram:*:*:resource-share/*", "Condition": {"StringEquals": {"aws:ResourceTag/FMManaged": "true"}}}, {"Effect": "Allow", "Action": ["ram:CreateResourceShare"], "Resource": "*", "Condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["Name", "FMManaged"]}, "StringEquals": {"aws:RequestTag/FMManaged": ["true"]}}}, {"Sid": "ram", "Effect": "Allow", "Action": ["ram:GetResourceShareAssociations", "ram:GetResourceShares"], "Resource": "*"}, {"Effect": "Allow", "Action": ["iam:CreateServiceLinkedRole"], "Resource": "*", "Condition": {"StringEquals": {"iam:AWSServiceName": ["network-firewall.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["iam:GetRole"], "Resource": "*"}, {"Effect": "Allow", "Action": ["network-firewall:TagResource"], "Resource": "*", "Condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["Name", "FMManaged"]}}}, {"Effect": "Allow", "Action": ["network-firewall:AssociateSubnets", "network-firewall:CreateFirewall", "network-firewall:CreateFirewallPolicy", "network-firewall:DisassociateSubnets", "network-firewall:UpdateFirewallDeleteProtection", "network-firewall:UpdateFirewallPolicy", "network-firewall:UpdateFirewallPolicyChangeProtection", "network-firewall:UpdateSubnetChangeProtection", "network-firewall:AssociateFirewallPolicy", "network-firewall:DescribeFirewall", "network-firewall:DescribeFirewallPolicy", "network-firewall:DescribeRuleGroup", "network-firewall:ListFirewallPolicies", "network-firewall:ListFirewalls", "network-firewall:ListRuleGroups", "network-firewall:PutResourcePolicy", "network-firewall:DescribeResourcePolicy", "network-firewall:DeleteResourcePolicy"], "Resource": "*"}, {"Effect": "Allow", "Action": ["network-firewall:DeleteFirewallPolicy", "network-firewall:DeleteFirewall"], "Resource": "*", "Condition": {"StringEquals": {"aws:ResourceTag/FMManaged": "true"}}}, {"Effect": "Allow", "Action": ["logs:ListLogDeliveries"], "Resource": "*"}, {"Effect": "Allow", "Action": ["route53resolver:ListFirewallRuleGroupAssociations", "route53resolver:ListTagsForResource", "route53resolver:ListFirewallRuleGroups", "route53resolver:GetFirewallRuleGroupAssociation", "route53resolver:GetFirewallRuleGroup", "route53resolver:GetFirewallRuleGroupPolicy", "route53resolver:PutFirewallRuleGroupPolicy"], "Resource": "*"}, {"Effect": "Allow", "Action": ["route53resolver:UpdateFirewallRuleGroupAssociation", "route53resolver:DisassociateFirewallRuleGroup"], "Resource": "arn:aws:route53resolver:*:*:firewall-rule-group-association/*", "Condition": {"StringEquals": {"aws:ResourceTag/FMManaged": "true"}}}, {"Effect": "Allow", "Action": ["route53resolver:AssociateFirewallRuleGroup", "route53resolver:TagResource"], "Resource": "arn:aws:route53resolver:*:*:firewall-rule-group-association/*", "Condition": {"StringEquals": {"aws:RequestTag/FMManaged": "true"}}}]}, "effective_actions": [{"action": "waf:UpdateWebACL", "effective_action": "waf:UpdateWebACL", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "waf:DeleteWebACL", "effective_action": "waf:DeleteWebACL", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "waf:GetWebACL", "effective_action": "waf:GetWebACL", "access_level": "Read", "condition": null, "privesc": false}, {"action": "waf:GetRuleGroup", "effective_action": "waf:GetRuleGroup", "access_level": "Read", "condition": null, "privesc": false}, {"action": "waf:ListSubscribedRuleGroups", "effective_action": "waf:ListSubscribedRuleGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "waf-regional:UpdateWebACL", "effective_action": "waf-regional:UpdateWebACL", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "waf-regional:DeleteWebACL", "effective_action": "waf-regional:DeleteWebACL", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "waf-regional:GetWebACL", "effective_action": "waf-regional:GetWebACL", "access_level": "Read", "condition": null, "privesc": false}, {"action": "waf-regional:GetRuleGroup", "effective_action": "waf-regional:GetRuleGroup", "access_level": "Read", "condition": null, "privesc": false}, {"action": "waf-regional:ListSubscribedRuleGroups", "effective_action": "waf-regional:ListSubscribedRuleGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "waf-regional:ListResourcesForWebACL", "effective_action": "waf-regional:ListResourcesForWebACL", "access_level": "List", "condition": null, "privesc": false}, {"action": "waf-regional:AssociateWebACL", "effective_action": "waf-regional:AssociateWebACL", "access_level": "Write", "condition": null, "privesc": false}, {"action": "waf-regional:DisassociateWebACL", "effective_action": "waf-regional:DisassociateWebACL", "access_level": "Write", "condition": null, "privesc": false}, {"action": "elasticloadbalancing:SetWebACL", "effective_action": "elasticloadbalancing:SetWebAcl", "access_level": "Write", "condition": null, "privesc": false}, {"action": "apigateway:SetWebACL", "effective_action": "apigateway:SetWebACL", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "elasticloadbalancing:SetSecurityGroups", "effective_action": "elasticloadbalancing:SetSecurityGroups", "access_level": "Write", "condition": null, "privesc": false}, {"action": "wafv2:PutLoggingConfiguration", "effective_action": "wafv2:PutLoggingConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "wafv2:GetLoggingConfiguration", "effective_action": "wafv2:GetLoggingConfiguration", "access_level": "Read", "condition": null, "privesc": false}, {"action": "wafv2:ListLoggingConfigurations", "effective_action": "wafv2:ListLoggingConfigurations", "access_level": "List", "condition": null, "privesc": false}, {"action": "wafv2:DeleteLoggingConfiguration", "effective_action": "wafv2:DeleteLoggingConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "waf:CreateWebACL", "effective_action": "waf:CreateWebACL", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "waf-regional:CreateWebACL", "effective_action": "waf-regional:CreateWebACL", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "waf:GetChangeToken", "effective_action": "waf:GetChangeToken", "access_level": "Read", "condition": null, "privesc": false}, {"action": "waf-regional:GetChangeToken", "effective_action": "waf-regional:GetChangeToken", "access_level": "Read", "condition": null, "privesc": false}, {"action": "elasticloadbalancing:ApplySecurityGroupsToLoadBalancer", "effective_action": "elasticloadbalancing:ApplySecurityGroupsToLoadBalancer", "access_level": "Write", "condition": null, "privesc": false}, {"action": "waf:PutPermissionPolicy", "effective_action": "waf:PutPermissionPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "waf:GetPermissionPolicy", "effective_action": "waf:GetPermissionPolicy", "access_level": "Read", "condition": null, "privesc": false}, {"action": "waf:DeletePermissionPolicy", "effective_action": "waf:DeletePermissionPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "waf-regional:PutPermissionPolicy", "effective_action": "waf-regional:PutPermissionPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "waf-regional:GetPermissionPolicy", "effective_action": "waf-regional:GetPermissionPolicy", "access_level": "Read", "condition": null, "privesc": false}, {"action": "waf-regional:DeletePermissionPolicy", "effective_action": "waf-regional:DeletePermissionPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "cloudfront:GetDistribution", "effective_action": "cloudfront:GetDistribution", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudfront:UpdateDistribution", "effective_action": "cloudfront:UpdateDistribution", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudfront:ListDistributionsByWebACLId", "effective_action": "cloudfront:ListDistributionsByWebACLId", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudfront:ListDistributions", "effective_action": "cloudfront:ListDistributions", "access_level": "List", "condition": null, "privesc": false}, {"action": "config:DeleteConfigRule", "effective_action": "config:DeleteConfigRule", "access_level": "Write", "condition": null, "privesc": false}, {"action": "config:DescribeComplianceByConfigRule", "effective_action": "config:DescribeComplianceByConfigRule", "access_level": "Read", "condition": null, "privesc": false}, {"action": "config:DescribeConfigRuleEvaluationStatus", "effective_action": "config:DescribeConfigRuleEvaluationStatus", "access_level": "Read", "condition": null, "privesc": false}, {"action": "config:DescribeConfigRules", "effective_action": "config:DescribeConfigRules", "access_level": "List", "condition": null, "privesc": false}, {"action": "config:GetComplianceDetailsByConfigRule", "effective_action": "config:GetComplianceDetailsByConfigRule", "access_level": "Read", "condition": null, "privesc": false}, {"action": "config:PutConfigRule", "effective_action": "config:PutConfigRule", "access_level": "Write", "condition": null, "privesc": false}, {"action": "config:StartConfigRulesEvaluation", "effective_action": "config:StartConfigRulesEvaluation", "access_level": "Write", "condition": null, "privesc": false}, {"action": "config:DescribeConfigurationRecorders", "effective_action": "config:DescribeConfigurationRecorders", "access_level": "List", "condition": null, "privesc": false}, {"action": "config:DescribeConfigurationRecorderStatus", "effective_action": "config:DescribeConfigurationRecorderStatus", "access_level": "Read", "condition": null, "privesc": false}, {"action": "config:PutConfigurationRecorder", "effective_action": "config:PutConfigurationRecorder", "access_level": "Write", "condition": null, "privesc": false}, {"action": "config:StartConfigurationRecorder", "effective_action": "config:StartConfigurationRecorder", "access_level": "Write", "condition": null, "privesc": false}, {"action": "config:PutDeliveryChannel", "effective_action": "config:PutDeliveryChannel", "access_level": "Write", "condition": null, "privesc": false}, {"action": "config:DescribeDeliveryChannels", "effective_action": "config:DescribeDeliveryChannels", "access_level": "List", "condition": null, "privesc": false}, {"action": "config:DescribeDeliveryChannelStatus", "effective_action": "config:DescribeDeliveryChannelStatus", "access_level": "Read", "condition": null, "privesc": false}, {"action": "config:GetComplianceSummaryByConfigRule", "effective_action": "config:GetComplianceSummaryByConfigRule", "access_level": "Read", "condition": null, "privesc": false}, {"action": "config:GetDiscoveredResourceCounts", "effective_action": "config:GetDiscoveredResourceCounts", "access_level": "Read", "condition": null, "privesc": false}, {"action": "config:PutEvaluations", "effective_action": "config:PutEvaluations", "access_level": "Write", "condition": null, "privesc": false}, {"action": "config:SelectResourceConfig", "effective_action": "config:SelectResourceConfig", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:DeleteServiceLinkedRole", "effective_action": "iam:DeleteServiceLinkedRole", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iam:GetServiceLinkedRoleDeletionStatus", "effective_action": "iam:GetServiceLinkedRoleDeletionStatus", "access_level": "Read", "condition": null, "privesc": false}, {"action": "organizations:DescribeAccount", "effective_action": "organizations:DescribeAccount", "access_level": "Read", "condition": null, "privesc": false}, {"action": "organizations:DescribeOrganization", "effective_action": "organizations:DescribeOrganization", "access_level": "Read", "condition": null, "privesc": false}, {"action": "organizations:ListAccounts", "effective_action": "organizations:ListAccounts", "access_level": "List", "condition": null, "privesc": false}, {"action": "organizations:DescribeOrganizationalUnit", "effective_action": "organizations:DescribeOrganizationalUnit", "access_level": "Read", "condition": null, "privesc": false}, {"action": "organizations:ListChildren", "effective_action": "organizations:ListChildren", "access_level": "List", "condition": null, "privesc": false}, {"action": "organizations:ListRoots", "effective_action": "organizations:ListRoots", "access_level": "List", "condition": null, "privesc": false}, {"action": "organizations:ListParents", "effective_action": "organizations:ListParents", "access_level": "List", "condition": null, "privesc": false}, {"action": "organizations:ListOrganizationalUnitsForParent", "effective_action": "organizations:ListOrganizationalUnitsForParent", "access_level": "List", "condition": null, "privesc": false}, {"action": "organizations:ListAWSServiceAccessForOrganization", "effective_action": "organizations:ListAWSServiceAccessForOrganization", "access_level": "List", "condition": null, "privesc": false}, {"action": "shield:CreateProtection", "effective_action": "shield:CreateProtection", "access_level": "Write", "condition": null, "privesc": false}, {"action": "shield:DeleteProtection", "effective_action": "shield:DeleteProtection", "access_level": "Write", "condition": null, "privesc": false}, {"action": "shield:DescribeProtection", "effective_action": "shield:DescribeProtection", "access_level": "Read", "condition": null, "privesc": false}, {"action": "shield:ListProtections", "effective_action": "shield:ListProtections", "access_level": "List", "condition": null, "privesc": false}, {"action": "shield:ListAttacks", "effective_action": "shield:ListAttacks", "access_level": "List", "condition": null, "privesc": false}, {"action": "shield:CreateSubscription", "effective_action": "shield:CreateSubscription", "access_level": "Write", "condition": null, "privesc": false}, {"action": "shield:DescribeSubscription", "effective_action": "shield:DescribeSubscription", "access_level": "Read", "condition": null, "privesc": false}, {"action": "shield:GetSubscriptionState", "effective_action": "shield:GetSubscriptionState", "access_level": "Read", "condition": null, "privesc": false}, {"action": "shield:DescribeDRTAccess", "effective_action": "shield:DescribeDRTAccess", "access_level": "Read", "condition": null, "privesc": false}, {"action": "shield:DescribeEmergencyContactSettings", "effective_action": "shield:DescribeEmergencyContactSettings", "access_level": "Read", "condition": null, "privesc": false}, {"action": "shield:UpdateEmergencyContactSettings", "effective_action": "shield:UpdateEmergencyContactSettings", "access_level": "Write", "condition": null, "privesc": false}, {"action": "elasticloadbalancing:DescribeLoadBalancers", "effective_action": "elasticloadbalancing:DescribeLoadBalancers", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ec2:DescribeAddresses", "effective_action": "ec2:DescribeAddresses", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:AuthorizeSecurityGroupEgress", "effective_action": "ec2:AuthorizeSecurityGroupEgress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:AuthorizeSecurityGroupIngress", "effective_action": "ec2:AuthorizeSecurityGroupIngress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteSecurityGroup", "effective_action": "ec2:DeleteSecurityGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:RevokeSecurityGroupEgress", "effective_action": "ec2:RevokeSecurityGroupEgress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:RevokeSecurityGroupIngress", "effective_action": "ec2:RevokeSecurityGroupIngress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:UpdateSecurityGroupRuleDescriptionsEgress", "effective_action": "ec2:UpdateSecurityGroupRuleDescriptionsEgress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:UpdateSecurityGroupRuleDescriptionsIngress", "effective_action": "ec2:UpdateSecurityGroupRuleDescriptionsIngress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DescribeNetworkInterfaceAttribute", "effective_action": "ec2:DescribeNetworkInterfaceAttribute", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "ec2:CreateSecurityGroup", "effective_action": "ec2:CreateSecurityGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroupReferences", "effective_action": "ec2:DescribeSecurityGroupReferences", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeStaleSecurityGroups", "effective_action": "ec2:DescribeStaleSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeNetworkInterfaces", "effective_action": "ec2:DescribeNetworkInterfaces", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:ModifyNetworkInterfaceAttribute", "effective_action": "ec2:ModifyNetworkInterfaceAttribute", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcPeeringConnections", "effective_action": "ec2:DescribeVpcPeeringConnections", "access_level": "List", "condition": null, "privesc": false}, {"action": "wafv2:TagResource", "effective_action": "wafv2:TagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "wafv2:ListResourcesForWebACL", "effective_action": "wafv2:ListResourcesForWebACL", "access_level": "List", "condition": null, "privesc": false}, {"action": "wafv2:AssociateWebACL", "effective_action": "wafv2:AssociateWebACL", "access_level": "Write", "condition": null, "privesc": false}, {"action": "wafv2:ListTagsForResource", "effective_action": "wafv2:ListTagsForResource", "access_level": "Read", "condition": null, "privesc": false}, {"action": "wafv2:UntagResource", "effective_action": "wafv2:UntagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "wafv2:GetWebACL", "effective_action": "wafv2:GetWebACL", "access_level": "Read", "condition": null, "privesc": false}, {"action": "wafv2:DisassociateFirewallManager", "effective_action": "wafv2:DisassociateFirewallManager", "access_level": "Write", "condition": null, "privesc": false}, {"action": "wafv2:DeleteWebACL", "effective_action": "wafv2:DeleteWebACL", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "wafv2:DisassociateWebACL", "effective_action": "wafv2:DisassociateWebACL", "access_level": "Write", "condition": null, "privesc": false}, {"action": "wafv2:UpdateWebACL", "effective_action": "wafv2:UpdateWebACL", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "wafv2:CreateWebACL", "effective_action": "wafv2:CreateWebACL", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "wafv2:DeleteFirewallManagerRuleGroups", "effective_action": "wafv2:DeleteFirewallManagerRuleGroups", "access_level": "Write", "condition": null, "privesc": false}, {"action": "wafv2:PutFirewallManagerRuleGroups", "effective_action": "wafv2:PutFirewallManagerRuleGroups", "access_level": "Write", "condition": null, "privesc": false}, {"action": "wafv2:PutPermissionPolicy", "effective_action": "wafv2:PutPermissionPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "wafv2:GetPermissionPolicy", "effective_action": "wafv2:GetPermissionPolicy", "access_level": "Read", "condition": null, "privesc": false}, {"action": "wafv2:DeletePermissionPolicy", "effective_action": "wafv2:DeletePermissionPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "cloudfront:ListTagsForResource", "effective_action": "cloudfront:ListTagsForResource", "access_level": "Read", "condition": null, "privesc": false}, {"action": "wafv2:GetWebACLForResource", "effective_action": "wafv2:GetWebACLForResource", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringEquals": {"ec2:CreateAction": "CreateRouteTable"}, "ForAllValues:StringEquals": {"aws:TagKeys": ["Name", "FMManaged"]}}, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["Name", "FMManaged"]}}, "privesc": false}, {"action": "ec2:DeleteRouteTable", "effective_action": "ec2:DeleteRouteTable", "access_level": "Write", "condition": {"StringEquals": {"ec2:ResourceTag/FMManaged": "true"}}, "privesc": false}, {"action": "ec2:AssociateRouteTable", "effective_action": "ec2:AssociateRouteTable", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateSubnet", "effective_action": "ec2:CreateSubnet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateRouteTable", "effective_action": "ec2:CreateRouteTable", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteSubnet", "effective_action": "ec2:DeleteSubnet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DisassociateRouteTable", "effective_action": "ec2:DisassociateRouteTable", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:ReplaceRouteTableAssociation", "effective_action": "ec2:ReplaceRouteTableAssociation", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DescribeInternetGateways", "effective_action": "ec2:DescribeInternetGateways", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeRouteTables", "effective_action": "ec2:DescribeRouteTables", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeTags", "effective_action": "ec2:DescribeTags", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcEndpoints", "effective_action": "ec2:DescribeVpcEndpoints", "access_level": "List", "condition": null, "privesc": false}, {"action": "ram:TagResource", "effective_action": "ram:TagResource", "access_level": "Tagging", "condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["Name", "FMManaged"]}}, "privesc": false}, {"action": "ram:AssociateResourceShare", "effective_action": "ram:AssociateResourceShare", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/FMManaged": "true"}}, "privesc": false}, {"action": "ram:UpdateResourceShare", "effective_action": "ram:UpdateResourceShare", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/FMManaged": "true"}}, "privesc": false}, {"action": "ram:DeleteResourceShare", "effective_action": "ram:DeleteResourceShare", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/FMManaged": "true"}}, "privesc": false}, {"action": "ram:CreateResourceShare", "effective_action": "ram:CreateResourceShare", "access_level": "Write", "condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["Name", "FMManaged"]}, "StringEquals": {"aws:RequestTag/FMManaged": ["true"]}}, "privesc": false}, {"action": "ram:GetResourceShareAssociations", "effective_action": "ram:GetResourceShareAssociations", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ram:GetResourceShares", "effective_action": "ram:GetResourceShares", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:CreateServiceLinkedRole", "effective_action": "iam:CreateServiceLinkedRole", "access_level": "Write", "condition": {"StringEquals": {"iam:AWSServiceName": ["network-firewall.amazonaws.com"]}}, "privesc": true}, {"action": "iam:GetRole", "effective_action": "iam:GetRole", "access_level": "Read", "condition": null, "privesc": false}, {"action": "network-firewall:TagResource", "effective_action": "network-firewall:TagResource", "access_level": "Tagging", "condition": {"ForAllValues:StringEquals": {"aws:TagKeys": ["Name", "FMManaged"]}}, "privesc": false}, {"action": "network-firewall:AssociateSubnets", "effective_action": "network-firewall:AssociateSubnets", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:CreateFirewall", "effective_action": "network-firewall:CreateFirewall", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:CreateFirewallPolicy", "effective_action": "network-firewall:CreateFirewallPolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:DisassociateSubnets", "effective_action": "network-firewall:DisassociateSubnets", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:UpdateFirewallDeleteProtection", "effective_action": "network-firewall:UpdateFirewallDeleteProtection", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:UpdateFirewallPolicy", "effective_action": "network-firewall:UpdateFirewallPolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:UpdateFirewallPolicyChangeProtection", "effective_action": "network-firewall:UpdateFirewallPolicyChangeProtection", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:UpdateSubnetChangeProtection", "effective_action": "network-firewall:UpdateSubnetChangeProtection", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:AssociateFirewallPolicy", "effective_action": "network-firewall:AssociateFirewallPolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:DescribeFirewall", "effective_action": "network-firewall:DescribeFirewall", "access_level": "Read", "condition": null, "privesc": false}, {"action": "network-firewall:DescribeFirewallPolicy", "effective_action": "network-firewall:DescribeFirewallPolicy", "access_level": "Read", "condition": null, "privesc": false}, {"action": "network-firewall:DescribeRuleGroup", "effective_action": "network-firewall:DescribeRuleGroup", "access_level": "Read", "condition": null, "privesc": false}, {"action": "network-firewall:ListFirewallPolicies", "effective_action": "network-firewall:ListFirewallPolicies", "access_level": "List", "condition": null, "privesc": false}, {"action": "network-firewall:ListFirewalls", "effective_action": "network-firewall:ListFirewalls", "access_level": "List", "condition": null, "privesc": false}, {"action": "network-firewall:ListRuleGroups", "effective_action": "network-firewall:ListRuleGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "network-firewall:PutResourcePolicy", "effective_action": "network-firewall:PutResourcePolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:DescribeResourcePolicy", "effective_action": "network-firewall:DescribeResourcePolicy", "access_level": "Read", "condition": null, "privesc": false}, {"action": "network-firewall:DeleteResourcePolicy", "effective_action": "network-firewall:DeleteResourcePolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "network-firewall:DeleteFirewallPolicy", "effective_action": "network-firewall:DeleteFirewallPolicy", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/FMManaged": "true"}}, "privesc": false}, {"action": "network-firewall:DeleteFirewall", "effective_action": "network-firewall:DeleteFirewall", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/FMManaged": "true"}}, "privesc": false}, {"action": "logs:ListLogDeliveries", "effective_action": "logs:ListLogDeliveries", "access_level": "List", "condition": null, "privesc": false}, {"action": "route53resolver:ListFirewallRuleGroupAssociations", "effective_action": "route53resolver:ListFirewallRuleGroupAssociations", "access_level": "List", "condition": null, "privesc": false}, {"action": "route53resolver:ListTagsForResource", "effective_action": "route53resolver:ListTagsForResource", "access_level": "Read", "condition": null, "privesc": false}, {"action": "route53resolver:ListFirewallRuleGroups", "effective_action": "route53resolver:ListFirewallRuleGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "route53resolver:GetFirewallRuleGroupAssociation", "effective_action": "route53resolver:GetFirewallRuleGroupAssociation", "access_level": "Read", "condition": null, "privesc": false}, {"action": "route53resolver:GetFirewallRuleGroup", "effective_action": "route53resolver:GetFirewallRuleGroup", "access_level": "Read", "condition": null, "privesc": false}, {"action": "route53resolver:GetFirewallRuleGroupPolicy", "effective_action": "route53resolver:GetFirewallRuleGroupPolicy", "access_level": "Read", "condition": null, "privesc": false}, {"action": "route53resolver:PutFirewallRuleGroupPolicy", "effective_action": "route53resolver:PutFirewallRuleGroupPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "route53resolver:UpdateFirewallRuleGroupAssociation", "effective_action": "route53resolver:UpdateFirewallRuleGroupAssociation", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/FMManaged": "true"}}, "privesc": false}, {"action": "route53resolver:DisassociateFirewallRuleGroup", "effective_action": "route53resolver:DisassociateFirewallRuleGroup", "access_level": "Write", "condition": {"StringEquals": {"aws:ResourceTag/FMManaged": "true"}}, "privesc": false}, {"action": "route53resolver:AssociateFirewallRuleGroup", "effective_action": "route53resolver:AssociateFirewallRuleGroup", "access_level": "Write", "condition": {"StringEquals": {"aws:RequestTag/FMManaged": "true"}}, "privesc": false}, {"action": "route53resolver:TagResource", "effective_action": "route53resolver:TagResource", "access_level": "Tagging", "condition": {"StringEquals": {"aws:RequestTag/FMManaged": "true"}}, "privesc": false}]}