{"name": "AWSBackupServiceRolePolicyForRestores", "deprecated": false, "createdate": "2021-05-25T00:02:53Z", "updatedate": "2021-05-25T00:02:53+00:00", "version": "v9", "malformed": false, "unknown_actions": [], "access_levels": ["Tagging", "Permissions management", "Write", "List", "Read"], "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["dynamodb:Scan", "dynamodb:Query", "dynamodb:UpdateItem", "dynamodb:PutItem", "dynamodb:GetItem", "dynamodb:DeleteItem", "dynamodb:BatchWriteItem", "dynamodb:DescribeTable"], "Resource": "arn:aws:dynamodb:*:*:table/*"}, {"Effect": "Allow", "Action": ["dynamodb:RestoreTableFromBackup"], "Resource": "arn:aws:dynamodb:*:*:table/*/backup/*"}, {"Effect": "Allow", "Action": ["ec2:CreateVolume", "ec2:DeleteVolume"], "Resource": ["arn:aws:ec2:*::snapshot/*", "arn:aws:ec2:*:*:volume/*"]}, {"Effect": "Allow", "Action": ["ec2:DescribeImages", "ec2:DescribeInstances", "ec2:DescribeSnapshots", "ec2:DescribeVolumes"], "Resource": "*"}, {"Effect": "Allow", "Action": ["storagegateway:DeleteVolume", "storagegateway:DescribeCachediSCSIVolumes", "storagegateway:DescribeStorediSCSIVolumes"], "Resource": "arn:aws:storagegateway:*:*:gateway/*/volume/*"}, {"Effect": "Allow", "Action": ["storagegateway:DescribeGatewayInformation", "storagegateway:CreateStorediSCSIVolume", "storagegateway:CreateCachediSCSIVolume"], "Resource": "arn:aws:storagegateway:*:*:gateway/*"}, {"Effect": "Allow", "Action": ["storagegateway:ListVolumes"], "Resource": "arn:aws:storagegateway:*:*:*"}, {"Effect": "Allow", "Action": ["rds:DescribeDBInstances", "rds:DescribeDBSnapshots", "rds:ListTagsForResource", "rds:RestoreDBInstanceFromDBSnapshot", "rds:DeleteDBInstance", "rds:AddTagsToResource", "rds:DescribeDBClusters", "rds:RestoreDBClusterFromSnapshot", "rds:DeleteDBCluster", "rds:RestoreDBInstanceToPointInTime"], "Resource": "*"}, {"Effect": "Allow", "Action": ["elasticfilesystem:Restore", "elasticfilesystem:CreateFilesystem", "elasticfilesystem:DescribeFilesystems", "elasticfilesystem:DeleteFilesystem"], "Resource": "arn:aws:elasticfilesystem:*:*:file-system/*"}, {"Effect": "Allow", "Action": ["kms:DescribeKey"], "Resource": "*"}, {"Effect": "Allow", "Action": ["kms:Decrypt", "kms:Encrypt", "kms:GenerateDataKey", "kms:ReEncryptTo", "kms:ReEncryptFrom"], "Resource": "*", "Condition": {"StringLike": {"kms:ViaService": ["dynamodb.*.amazonaws.com", "ec2.*.amazonaws.com", "elasticfilesystem.*.amazonaws.com", "rds.*.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["kms:CreateGrant"], "Resource": "*", "Condition": {"Bool": {"kms:GrantIsForAWSResource": "true"}}}, {"Effect": "Allow", "Action": ["ec2:RunInstances"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:TerminateInstances"], "Resource": "arn:aws:ec2:*:*:instance/*"}, {"Effect": "Allow", "Action": ["fsx:CreateFileSystemFromBackup"], "Resource": ["arn:aws:fsx:*:*:file-system/*", "arn:aws:fsx:*:*:backup/*"]}, {"Effect": "Allow", "Action": ["fsx:DescribeFileSystems", "fsx:TagResource"], "Resource": "arn:aws:fsx:*:*:file-system/*"}, {"Effect": "Allow", "Action": ["fsx:DescribeBackups"], "Resource": "arn:aws:fsx:*:*:backup/*"}, {"Effect": "Allow", "Action": ["fsx:DeleteFileSystem", "fsx:UntagResource"], "Resource": "arn:aws:fsx:*:*:file-system/*", "Condition": {"Null": {"aws:ResourceTag/aws:backup:source-resource": "false"}}}, {"Effect": "Allow", "Action": ["ds:DescribeDirectories"], "Resource": "*"}]}, "effective_actions": [{"action": "dynamodb:Scan", "effective_action": "dynamodb:Scan", "access_levels": "Read", "condition": null}, {"action": "dynamodb:Query", "effective_action": "dynamodb:Query", "access_levels": "Read", "condition": null}, {"action": "dynamodb:UpdateItem", "effective_action": "dynamodb:UpdateItem", "access_levels": "Write", "condition": null}, {"action": "dynamodb:PutItem", "effective_action": "dynamodb:PutItem", "access_levels": "Write", "condition": null}, {"action": "dynamodb:GetItem", "effective_action": "dynamodb:GetItem", "access_levels": "Read", "condition": null}, {"action": "dynamodb:DeleteItem", "effective_action": "dynamodb:DeleteItem", "access_levels": "Write", "condition": null}, {"action": "dynamodb:BatchWriteItem", "effective_action": "dynamodb:BatchWriteItem", "access_levels": "Write", "condition": null}, {"action": "dynamodb:DescribeTable", "effective_action": "dynamodb:DescribeTable", "access_levels": "Read", "condition": null}, {"action": "dynamodb:RestoreTableFromBackup", "effective_action": "dynamodb:RestoreTableFromBackup", "access_levels": "Write", "condition": null}, {"action": "ec2:CreateVolume", "effective_action": "ec2:CreateVolume", "access_levels": "Write", "condition": null}, {"action": "ec2:DeleteVolume", "effective_action": "ec2:DeleteVolume", "access_levels": "Write", "condition": null}, {"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_levels": "List", "condition": null}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_levels": "List", "condition": null}, {"action": "ec2:DescribeSnapshots", "effective_action": "ec2:DescribeSnapshots", "access_levels": "List", "condition": null}, {"action": "ec2:DescribeVolumes", "effective_action": "ec2:DescribeVolumes", "access_levels": "List", "condition": null}, {"action": "storagegateway:DeleteVolume", "effective_action": "storagegateway:DeleteVolume", "access_levels": "Write", "condition": null}, {"action": "storagegateway:DescribeCachediSCSIVolumes", "effective_action": "storagegateway:DescribeCachediSCSIVolumes", "access_levels": "Read", "condition": null}, {"action": "storagegateway:DescribeStorediSCSIVolumes", "effective_action": "storagegateway:DescribeStorediSCSIVolumes", "access_levels": "Read", "condition": null}, {"action": "storagegateway:DescribeGatewayInformation", "effective_action": "storagegateway:DescribeGatewayInformation", "access_levels": "Read", "condition": null}, {"action": "storagegateway:CreateStorediSCSIVolume", "effective_action": "storagegateway:CreateStorediSCSIVolume", "access_levels": "Write", "condition": null}, {"action": "storagegateway:CreateCachediSCSIVolume", "effective_action": "storagegateway:CreateCachediSCSIVolume", "access_levels": "Write", "condition": null}, {"action": "storagegateway:ListVolumes", "effective_action": "storagegateway:ListVolumes", "access_levels": "List", "condition": null}, {"action": "rds:DescribeDBInstances", "effective_action": "rds:DescribeDBInstances", "access_levels": "List", "condition": null}, {"action": "rds:DescribeDBSnapshots", "effective_action": "rds:DescribeDBSnapshots", "access_levels": "List", "condition": null}, {"action": "rds:ListTagsForResource", "effective_action": "rds:ListTagsForResource", "access_levels": "Read", "condition": null}, {"action": "rds:RestoreDBInstanceFromDBSnapshot", "effective_action": "rds:RestoreDBInstanceFromDBSnapshot", "access_levels": "Write", "condition": null}, {"action": "rds:DeleteDBInstance", "effective_action": "rds:DeleteDBInstance", "access_levels": "Write", "condition": null}, {"action": "rds:AddTagsToResource", "effective_action": "rds:AddTagsToResource", "access_levels": "Tagging", "condition": null}, {"action": "rds:DescribeDBClusters", "effective_action": "rds:DescribeDBClusters", "access_levels": "List", "condition": null}, {"action": "rds:RestoreDBClusterFromSnapshot", "effective_action": "rds:RestoreDBClusterFromSnapshot", "access_levels": "Write", "condition": null}, {"action": "rds:DeleteDBCluster", "effective_action": "rds:DeleteDBCluster", "access_levels": "Write", "condition": null}, {"action": "rds:RestoreDBInstanceToPointInTime", "effective_action": "rds:RestoreDBInstanceToPointInTime", "access_levels": "Write", "condition": null}, {"action": "elasticfilesystem:Restore", "effective_action": "elasticfilesystem:Restore", "access_levels": "Write", "condition": null}, {"action": "elasticfilesystem:CreateFilesystem", "effective_action": "elasticfilesystem:CreateFileSystem", "access_levels": "Write", "condition": null}, {"action": "elasticfilesystem:DescribeFilesystems", "effective_action": "elasticfilesystem:DescribeFileSystems", "access_levels": "List", "condition": null}, {"action": "elasticfilesystem:DeleteFilesystem", "effective_action": "elasticfilesystem:DeleteFileSystem", "access_levels": "Write", "condition": null}, {"action": "kms:DescribeKey", "effective_action": "kms:DescribeKey", "access_levels": "Read", "condition": null}, {"action": "kms:Decrypt", "effective_action": "kms:Decrypt", "access_levels": "Write", "condition": {"StringLike": {"kms:ViaService": ["dynamodb.*.amazonaws.com", "ec2.*.amazonaws.com", "elasticfilesystem.*.amazonaws.com", "rds.*.amazonaws.com"]}}}, {"action": "kms:Encrypt", "effective_action": "kms:Encrypt", "access_levels": "Write", "condition": {"StringLike": {"kms:ViaService": ["dynamodb.*.amazonaws.com", "ec2.*.amazonaws.com", "elasticfilesystem.*.amazonaws.com", "rds.*.amazonaws.com"]}}}, {"action": "kms:GenerateDataKey", "effective_action": "kms:GenerateDataKey", "access_levels": "Write", "condition": {"StringLike": {"kms:ViaService": ["dynamodb.*.amazonaws.com", "ec2.*.amazonaws.com", "elasticfilesystem.*.amazonaws.com", "rds.*.amazonaws.com"]}}}, {"action": "kms:ReEncryptTo", "effective_action": "kms:ReEncryptTo", "access_levels": "Write", "condition": {"StringLike": {"kms:ViaService": ["dynamodb.*.amazonaws.com", "ec2.*.amazonaws.com", "elasticfilesystem.*.amazonaws.com", "rds.*.amazonaws.com"]}}}, {"action": "kms:ReEncryptFrom", "effective_action": "kms:ReEncryptFrom", "access_levels": "Write", "condition": {"StringLike": {"kms:ViaService": ["dynamodb.*.amazonaws.com", "ec2.*.amazonaws.com", "elasticfilesystem.*.amazonaws.com", "rds.*.amazonaws.com"]}}}, {"action": "kms:CreateGrant", "effective_action": "kms:CreateGrant", "access_levels": "Permissions management", "condition": {"Bool": {"kms:GrantIsForAWSResource": "true"}}}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_levels": "Write", "condition": null}, {"action": "ec2:TerminateInstances", "effective_action": "ec2:TerminateInstances", "access_levels": "Write", "condition": null}, {"action": "fsx:CreateFileSystemFromBackup", "effective_action": "fsx:CreateFileSystemFromBackup", "access_levels": "Tagging", "condition": null}, {"action": "fsx:DescribeFileSystems", "effective_action": "fsx:DescribeFileSystems", "access_levels": "Read", "condition": null}, {"action": "fsx:TagResource", "effective_action": "fsx:TagResource", "access_levels": "Tagging", "condition": null}, {"action": "fsx:DescribeBackups", "effective_action": "fsx:DescribeBackups", "access_levels": "Read", "condition": null}, {"action": "fsx:DeleteFileSystem", "effective_action": "fsx:DeleteFileSystem", "access_levels": "Write", "condition": {"Null": {"aws:ResourceTag/aws:backup:source-resource": "false"}}}, {"action": "fsx:UntagResource", "effective_action": "fsx:UntagResource", "access_levels": "Tagging", "condition": {"Null": {"aws:ResourceTag/aws:backup:source-resource": "false"}}}, {"action": "ds:DescribeDirectories", "effective_action": "ds:DescribeDirectories", "access_levels": "List", "condition": null}]}