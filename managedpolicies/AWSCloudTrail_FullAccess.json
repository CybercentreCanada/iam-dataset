{"name": "AWSCloudTrail_FullAccess", "deprecated": false, "createdate": "2021-02-22T19:01:00Z", "updatedate": "2021-02-22T19:01:00+00:00", "version": "v3", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": true, "resource_exposure": true, "credentials_exposure": false, "undocumented_actions": false, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["sns:AddPermission", "sns:CreateTopic", "sns:SetTopicAttributes", "sns:GetTopicAttributes"], "Resource": ["arn:aws:sns:*:*:aws-cloudtrail-logs*"]}, {"Effect": "Allow", "Action": ["sns:ListTopics"], "Resource": "*"}, {"Effect": "Allow", "Action": ["s3:CreateBucket", "s3:PutBucketPolicy", "s3:PutBucketPublicAccessBlock"], "Resource": ["arn:aws:s3:::aws-cloudtrail-logs*"]}, {"Effect": "Allow", "Action": ["s3:ListAllMyBuckets", "s3:GetBucketLocation", "s3:GetBucketPolicy"], "Resource": "*"}, {"Effect": "Allow", "Action": ["cloudtrail:*"], "Resource": "*"}, {"Effect": "Allow", "Action": ["logs:CreateLogGroup"], "Resource": ["arn:aws:logs:*:*:log-group:aws-cloudtrail-logs*"]}, {"Effect": "Allow", "Action": ["iam:ListRoles", "iam:GetRolePolicy", "iam:GetUser"], "Resource": "*"}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "*", "Condition": {"StringEquals": {"iam:PassedToService": "cloudtrail.amazonaws.com"}}}, {"Effect": "Allow", "Action": ["kms:CreateKey", "kms:CreateAlias", "kms:ListKeys", "kms:ListAliases"], "Resource": "*"}, {"Effect": "Allow", "Action": ["lambda:ListFunctions"], "Resource": "*"}, {"Effect": "Allow", "Action": ["dynamodb:ListGlobalTables", "dynamodb:ListTables"], "Resource": "*"}]}, "effective_actions": [{"action": "sns:AddPermission", "effective_action": "sns:AddPermission", "access_level": "Permissions management", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "sns:CreateTopic", "effective_action": "sns:CreateTopic", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "sns:SetTopicAttributes", "effective_action": "sns:SetTopicAttributes", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "sns:GetTopicAttributes", "effective_action": "sns:GetTopicAttributes", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "sns:ListTopics", "effective_action": "sns:ListTopics", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "s3:CreateBucket", "effective_action": "s3:CreateBucket", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "s3:PutBucketPolicy", "effective_action": "s3:PutBucketPolicy", "access_level": "Permissions management", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "s3:PutBucketPublicAccessBlock", "effective_action": "s3:PutBucketPublicAccessBlock", "access_level": "Permissions management", "condition": null, "privesc": false, "resource_exposure": true, "credentials_exposure": false}, {"action": "s3:ListAllMyBuckets", "effective_action": "s3:ListAllMyBuckets", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "s3:GetBucketLocation", "effective_action": "s3:GetBucketLocation", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "s3:GetBucketPolicy", "effective_action": "s3:GetBucketPolicy", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:AddTags", "access_level": "Tagging", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:CreateTrail", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:DeleteTrail", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:DescribeTrails", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:GetEventSelectors", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:GetInsightSelectors", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:GetTrail", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:GetTrailStatus", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:ListPublicKeys", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:ListTags", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:ListTrails", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:LookupEvents", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:PutEventSelectors", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:PutInsightSelectors", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:RemoveTags", "access_level": "Tagging", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:StartLogging", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:StopLogging", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "cloudtrail:*", "effective_action": "cloudtrail:UpdateTrail", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "logs:CreateLogGroup", "effective_action": "logs:CreateLogGroup", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:ListRoles", "effective_action": "iam:ListRoles", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:GetRolePolicy", "effective_action": "iam:GetRolePolicy", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:GetUser", "effective_action": "iam:GetUser", "access_level": "Read", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": "cloudtrail.amazonaws.com"}}, "privesc": true, "resource_exposure": true, "credentials_exposure": false}, {"action": "kms:CreateKey", "effective_action": "kms:CreateKey", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "kms:CreateAlias", "effective_action": "kms:CreateAlias", "access_level": "Write", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "kms:ListKeys", "effective_action": "kms:ListKeys", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "kms:ListAliases", "effective_action": "kms:ListAliases", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "lambda:ListFunctions", "effective_action": "lambda:ListFunctions", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "dynamodb:ListGlobalTables", "effective_action": "dynamodb:ListGlobalTables", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}, {"action": "dynamodb:ListTables", "effective_action": "dynamodb:ListTables", "access_level": "List", "condition": null, "privesc": false, "resource_exposure": false, "credentials_exposure": false}]}