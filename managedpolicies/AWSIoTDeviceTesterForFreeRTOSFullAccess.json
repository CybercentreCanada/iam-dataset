{"name": "AWSIoTDeviceTesterForFreeRTOSFullAccess", "deprecated": false, "createdate": "2020-12-15T18:03:46Z", "updatedate": "2020-12-15T18:03:46+00:00", "version": "v5", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Sid": "VisualEditor0", "Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "arn:aws:iam::*:role/idt-*", "Condition": {"StringEquals": {"iam:PassedToService": "iot.amazonaws.com"}}}, {"Sid": "VisualEditor1", "Effect": "Allow", "Action": ["iot:DeleteThing", "iot:AttachThingPrincipal", "iot:DeleteCertificate", "iot:GetRegistrationCode", "iot:CreatePolicy", "iot:UpdateCACertificate", "s3:ListBucket", "iot:DescribeEndpoint", "iot:CreateOTAUpdate", "iot:CreateStream", "signer:ListSigningJobs", "acm:ListCertificates", "iot:CreateKeysAndCertificate", "iot:UpdateCertificate", "iot:CreateCertificateFromCsr", "iot:DetachThingPrincipal", "iot:RegisterCACertificate", "iot:CreateThing", "freertos:ListHardwarePlatforms", "iam:ListRoles", "iot:RegisterCertificate", "iot:DeleteCACertificate", "signer:PutSigningProfile", "s3:ListAllMyBuckets", "signer:ListSigningPlatforms", "iot-device-tester:SendMetrics", "iot-device-tester:SupportedVersion", "iot-device-tester:LatestIdt", "iot-device-tester:CheckVersion", "iot-device-tester:DownloadTestSuite"], "Resource": "*"}, {"Sid": "VisualEditor2", "Effect": "Allow", "Action": ["iam:GetRole", "signer:StartSigningJob", "acm:GetCertificate", "signer:DescribeSigningJob", "s3:CreateBucket", "execute-api:Invoke", "s3:DeleteBucket", "s3:PutBucketVersioning", "signer:CancelSigningProfile"], "Resource": ["arn:aws:execute-api:us-east-1:098862408343:9xpmnvs5h4/prod/POST/metrics", "arn:aws:signer:*:*:/signing-profiles/*", "arn:aws:signer:*:*:/signing-jobs/*", "arn:aws:iam::*:role/idt-*", "arn:aws:acm:*:*:certificate/*", "arn:aws:s3:::idt-*", "arn:aws:s3:::afr-ota*"]}, {"Sid": "VisualEditor3", "Effect": "Allow", "Action": ["iot:DeleteStream", "iot:DeleteCertificate", "iot:AttachPolicy", "iot:DetachPolicy", "iot:DeletePolicy", "s3:ListBucketVersions", "iot:UpdateCertificate", "iot:GetOTAUpdate", "iot:DeleteOTAUpdate", "iot:DescribeJobExecution"], "Resource": ["arn:aws:s3:::afr-ota*", "arn:aws:iot:*:*:thinggroup/idt*", "arn:aws:iam::*:role/idt-*"]}, {"Sid": "VisualEditor4", "Effect": "Allow", "Action": ["iot:DeleteCertificate", "iot:AttachPolicy", "iot:DetachPolicy", "s3:DeleteObjectVersion", "iot:DeleteOTAUpdate", "s3:PutObject", "s3:GetObject", "iot:DeleteStream", "iot:DeletePolicy", "s3:DeleteObject", "iot:UpdateCertificate", "iot:GetOTAUpdate", "s3:GetObjectVersion", "iot:DescribeJobExecution"], "Resource": ["arn:aws:s3:::afr-ota*/*", "arn:aws:s3:::idt-*/*", "arn:aws:iot:*:*:policy/idt*", "arn:aws:iam::*:role/idt-*", "arn:aws:iot:*:*:otaupdate/idt*", "arn:aws:iot:*:*:thing/idt*", "arn:aws:iot:*:*:cert/*", "arn:aws:iot:*:*:job/*", "arn:aws:iot:*:*:stream/*"]}, {"Sid": "VisualEditor5", "Effect": "Allow", "Action": ["s3:PutObject", "s3:GetObject"], "Resource": ["arn:aws:s3:::afr-ota*/*", "arn:aws:s3:::idt-*/*"]}, {"Sid": "VisualEditor6", "Effect": "Allow", "Action": ["iot:CancelJobExecution"], "Resource": ["arn:aws:iot:*:*:job/*", "arn:aws:iot:*:*:thing/idt*"]}, {"Sid": "VisualEditor7", "Effect": "Allow", "Action": ["ec2:TerminateInstances"], "Resource": ["arn:aws:ec2:*:*:instance/*"], "Condition": {"StringEquals": {"ec2:ResourceTag/Owner": "IoTDeviceTester"}}}, {"Sid": "VisualEditor8", "Effect": "Allow", "Action": ["ec2:AuthorizeSecurityGroupIngress", "ec2:DeleteSecurityGroup"], "Resource": ["arn:aws:ec2:*:*:security-group/*"], "Condition": {"StringEquals": {"ec2:ResourceTag/Owner": "IoTDeviceTester"}}}, {"Sid": "VisualEditor9", "Effect": "Allow", "Action": ["ec2:RunInstances"], "Resource": ["arn:aws:ec2:*:*:instance/*"], "Condition": {"StringEquals": {"aws:RequestTag/Owner": "IoTDeviceTester"}}}, {"Sid": "VisualEditor10", "Effect": "Allow", "Action": ["ec2:RunInstances"], "Resource": ["arn:aws:ec2:*:*:image/*", "arn:aws:ec2:*:*:security-group/*", "arn:aws:ec2:*:*:volume/*", "arn:aws:ec2:*:*:key-pair/*", "arn:aws:ec2:*:*:placement-group/*", "arn:aws:ec2:*:*:snapshot/*", "arn:aws:ec2:*:*:network-interface/*", "arn:aws:ec2:*:*:subnet/*"]}, {"Sid": "VisualEditor11", "Effect": "Allow", "Action": ["ec2:CreateSecurityGroup"], "Resource": ["arn:aws:ec2:*:*:security-group/*"], "Condition": {"StringEquals": {"aws:RequestTag/Owner": "IoTDeviceTester"}}}, {"Sid": "VisualEditor12", "Effect": "Allow", "Action": ["ec2:DescribeInstances", "ec2:DescribeSecurityGroups", "ssm:DescribeParameters", "ssm:GetParameters"], "Resource": "*"}, {"Sid": "VisualEditor13", "Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": ["arn:aws:ec2:*:*:security-group/*", "arn:aws:ec2:*:*:instance/*"], "Condition": {"ForAnyValue:StringEquals": {"ec2:CreateAction": ["RunInstances", "CreateSecurityGroup"], "aws:TagKeys": ["Owner"]}}}]}, "effective_actions": [{"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": "iot.amazonaws.com"}}, "privesc": true}, {"action": "iot:DeleteThing", "effective_action": "iot:DeleteThing", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:AttachThingPrincipal", "effective_action": "iot:AttachThingPrincipal", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DeleteCertificate", "effective_action": "iot:DeleteCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:GetRegistrationCode", "effective_action": "iot:GetRegistrationCode", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:CreatePolicy", "effective_action": "iot:CreatePolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:UpdateCACertificate", "effective_action": "iot:UpdateCACertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:ListBucket", "effective_action": "s3:ListBucket", "access_level": "List", "condition": null, "privesc": false}, {"action": "iot:DescribeEndpoint", "effective_action": "iot:DescribeEndpoint", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:CreateOTAUpdate", "effective_action": "iot:CreateOTAUpdate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:CreateStream", "effective_action": "iot:CreateStream", "access_level": "Write", "condition": null, "privesc": false}, {"action": "signer:ListSigningJobs", "effective_action": "signer:ListSigningJobs", "access_level": "List", "condition": null, "privesc": false}, {"action": "acm:ListCertificates", "effective_action": "acm:ListCertificates", "access_level": "List", "condition": null, "privesc": false}, {"action": "iot:CreateKeysAndCertificate", "effective_action": "iot:CreateKeysAndCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:UpdateCertificate", "effective_action": "iot:UpdateCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:CreateCertificateFromCsr", "effective_action": "iot:CreateCertificateFromCsr", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DetachThingPrincipal", "effective_action": "iot:DetachThingPrincipal", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:RegisterCACertificate", "effective_action": "iot:RegisterCACertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:CreateThing", "effective_action": "iot:CreateThing", "access_level": "Write", "condition": null, "privesc": false}, {"action": "freertos:ListHardwarePlatforms", "effective_action": "freertos:ListHardwarePlatforms", "access_level": "List", "condition": null, "privesc": false}, {"action": "iam:ListRoles", "effective_action": "iam:ListRoles", "access_level": "List", "condition": null, "privesc": false}, {"action": "iot:RegisterCertificate", "effective_action": "iot:RegisterCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DeleteCACertificate", "effective_action": "iot:DeleteCACertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "signer:PutSigningProfile", "effective_action": "signer:PutSigningProfile", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:ListAllMyBuckets", "effective_action": "s3:ListAllMyBuckets", "access_level": "List", "condition": null, "privesc": false}, {"action": "signer:ListSigningPlatforms", "effective_action": "signer:ListSigningPlatforms", "access_level": "List", "condition": null, "privesc": false}, {"action": "iot-device-tester:SendMetrics", "effective_action": "iot-device-tester:SendMetrics", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot-device-tester:SupportedVersion", "effective_action": "iot-device-tester:SupportedVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot-device-tester:LatestIdt", "effective_action": "iot-device-tester:LatestIdt", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot-device-tester:CheckVersion", "effective_action": "iot-device-tester:CheckVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot-device-tester:DownloadTestSuite", "effective_action": "iot-device-tester:DownloadTestSuite", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:GetRole", "effective_action": "iam:GetRole", "access_level": "Read", "condition": null, "privesc": false}, {"action": "signer:StartSigningJob", "effective_action": "signer:StartSigningJob", "access_level": "Write", "condition": null, "privesc": false}, {"action": "acm:GetCertificate", "effective_action": "acm:GetCertificate", "access_level": "Read", "condition": null, "privesc": false}, {"action": "signer:DescribeSigningJob", "effective_action": "signer:DescribeSigningJob", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:CreateBucket", "effective_action": "s3:CreateBucket", "access_level": "Write", "condition": null, "privesc": false}, {"action": "execute-api:Invoke", "effective_action": "execute-api:Invoke", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:DeleteBucket", "effective_action": "s3:DeleteBucket", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:PutBucketVersioning", "effective_action": "s3:PutBucketVersioning", "access_level": "Write", "condition": null, "privesc": false}, {"action": "signer:CancelSigningProfile", "effective_action": "signer:CancelSigningProfile", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DeleteStream", "effective_action": "iot:DeleteStream", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DeleteCertificate", "effective_action": "iot:DeleteCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:AttachPolicy", "effective_action": "iot:AttachPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "iot:DetachPolicy", "effective_action": "iot:DetachPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "iot:DeletePolicy", "effective_action": "iot:DeletePolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:ListBucketVersions", "effective_action": "s3:ListBucketVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "iot:UpdateCertificate", "effective_action": "iot:UpdateCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:GetOTAUpdate", "effective_action": "iot:GetOTAUpdate", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:DeleteOTAUpdate", "effective_action": "iot:DeleteOTAUpdate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DescribeJobExecution", "effective_action": "iot:DescribeJobExecution", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:DeleteCertificate", "effective_action": "iot:DeleteCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:AttachPolicy", "effective_action": "iot:AttachPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "iot:DetachPolicy", "effective_action": "iot:DetachPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "s3:DeleteObjectVersion", "effective_action": "s3:DeleteObjectVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DeleteOTAUpdate", "effective_action": "iot:DeleteOTAUpdate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:PutObject", "effective_action": "s3:PutObject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:DeleteStream", "effective_action": "iot:DeleteStream", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:DeletePolicy", "effective_action": "iot:DeletePolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:DeleteObject", "effective_action": "s3:DeleteObject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:UpdateCertificate", "effective_action": "iot:UpdateCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iot:GetOTAUpdate", "effective_action": "iot:GetOTAUpdate", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:GetObjectVersion", "effective_action": "s3:GetObjectVersion", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:DescribeJobExecution", "effective_action": "iot:DescribeJobExecution", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:PutObject", "effective_action": "s3:PutObject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iot:CancelJobExecution", "effective_action": "iot:CancelJobExecution", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:TerminateInstances", "effective_action": "ec2:TerminateInstances", "access_level": "Write", "condition": {"StringEquals": {"ec2:ResourceTag/Owner": "IoTDeviceTester"}}, "privesc": false}, {"action": "ec2:AuthorizeSecurityGroupIngress", "effective_action": "ec2:AuthorizeSecurityGroupIngress", "access_level": "Write", "condition": {"StringEquals": {"ec2:ResourceTag/Owner": "IoTDeviceTester"}}, "privesc": false}, {"action": "ec2:DeleteSecurityGroup", "effective_action": "ec2:DeleteSecurityGroup", "access_level": "Write", "condition": {"StringEquals": {"ec2:ResourceTag/Owner": "IoTDeviceTester"}}, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": {"StringEquals": {"aws:RequestTag/Owner": "IoTDeviceTester"}}, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateSecurityGroup", "effective_action": "ec2:CreateSecurityGroup", "access_level": "Write", "condition": {"StringEquals": {"aws:RequestTag/Owner": "IoTDeviceTester"}}, "privesc": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ssm:DescribeParameters", "effective_action": "ssm:DescribeParameters", "access_level": "List", "condition": null, "privesc": false}, {"action": "ssm:GetParameters", "effective_action": "ssm:GetParameters", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"ForAnyValue:StringEquals": {"ec2:CreateAction": ["RunInstances", "CreateSecurityGroup"], "aws:TagKeys": ["Owner"]}}, "privesc": false}]}