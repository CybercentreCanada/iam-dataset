{"name": "AmazonRedshiftQueryEditor", "deprecated": false, "createdate": "2021-02-16T19:33:45Z", "updatedate": "2021-02-16T19:33:45+00:00", "version": "v4", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write"], "privesc": false, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["redshift:GetClusterCredentials", "redshift:ListSchemas", "redshift:ListTables", "redshift:ListDatabases", "redshift:ExecuteQuery", "redshift:FetchResults", "redshift:CancelQuery", "redshift:DescribeClusters", "redshift:DescribeQuery", "redshift:DescribeTable", "redshift:ViewQueriesFromConsole", "redshift:DescribeSavedQueries", "redshift:CreateSavedQuery", "redshift:DeleteSavedQueries", "redshift:ModifySavedQuery"], "Resource": "*"}, {"Sid": "DataAPIPermissions", "Action": ["redshift-data:ExecuteStatement", "redshift-data:ListDatabases", "redshift-data:ListSchemas", "redshift-data:ListTables", "redshift-data:DescribeTable"], "Effect": "Allow", "Resource": "*"}, {"Sid": "DataAPIIAMSessionPermissionsRestriction", "Action": ["redshift-data:GetStatementResult", "redshift-data:CancelStatement", "redshift-data:DescribeStatement", "redshift-data:ListStatements"], "Effect": "Allow", "Resource": "*", "Condition": {"StringEquals": {"redshift-data:statement-owner-iam-userid": "${aws:userid}"}}}, {"Sid": "SecretsManagerListPermissions", "Action": ["secretsmanager:ListSecrets"], "Effect": "Allow", "Resource": "*"}, {"Sid": "SecretsManagerCreateGetPermissions", "Action": ["secretsmanager:CreateSecret", "secretsmanager:GetSecretValue", "secretsmanager:TagResource"], "Effect": "Allow", "Resource": "arn:aws:secretsmanager:*:*:secret:*", "Condition": {"StringEquals": {"secretsmanager:ResourceTag/RedshiftQueryOwner": "${aws:userid}"}}}]}, "effective_actions": [{"action": "redshift:GetClusterCredentials", "effective_action": "redshift:GetClusterCredentials", "access_level": "Write", "condition": null}, {"action": "redshift:ListSchemas", "effective_action": "redshift:ListSchemas", "access_level": "List", "condition": null}, {"action": "redshift:ListTables", "effective_action": "redshift:ListTables", "access_level": "List", "condition": null}, {"action": "redshift:ListDatabases", "effective_action": "redshift:ListDatabases", "access_level": "List", "condition": null}, {"action": "redshift:ExecuteQuery", "effective_action": "redshift:ExecuteQuery", "access_level": "Write", "condition": null}, {"action": "redshift:FetchResults", "effective_action": "redshift:FetchResults", "access_level": "Read", "condition": null}, {"action": "redshift:CancelQuery", "effective_action": "redshift:CancelQuery", "access_level": "Write", "condition": null}, {"action": "redshift:DescribeClusters", "effective_action": "redshift:DescribeClusters", "access_level": "List", "condition": null}, {"action": "redshift:DescribeQuery", "effective_action": "redshift:DescribeQuery", "access_level": "Read", "condition": null}, {"action": "redshift:DescribeTable", "effective_action": "redshift:DescribeTable", "access_level": "Read", "condition": null}, {"action": "redshift:ViewQueriesFromConsole", "effective_action": "redshift:ViewQueriesFromConsole", "access_level": "List", "condition": null}, {"action": "redshift:DescribeSavedQueries", "effective_action": "redshift:DescribeSavedQueries", "access_level": "Read", "condition": null}, {"action": "redshift:CreateSavedQuery", "effective_action": "redshift:CreateSavedQuery", "access_level": "Write", "condition": null}, {"action": "redshift:DeleteSavedQueries", "effective_action": "redshift:DeleteSavedQueries", "access_level": "Write", "condition": null}, {"action": "redshift:ModifySavedQuery", "effective_action": "redshift:ModifySavedQuery", "access_level": "Write", "condition": null}, {"action": "redshift-data:ExecuteStatement", "effective_action": "redshift-data:ExecuteStatement", "access_level": "Write", "condition": null}, {"action": "redshift-data:ListDatabases", "effective_action": "redshift-data:ListDatabases", "access_level": "Read", "condition": null}, {"action": "redshift-data:ListSchemas", "effective_action": "redshift-data:ListSchemas", "access_level": "Read", "condition": null}, {"action": "redshift-data:ListTables", "effective_action": "redshift-data:ListTables", "access_level": "List", "condition": null}, {"action": "redshift-data:DescribeTable", "effective_action": "redshift-data:DescribeTable", "access_level": "Read", "condition": null}, {"action": "redshift-data:GetStatementResult", "effective_action": "redshift-data:GetStatementResult", "access_level": "Read", "condition": {"StringEquals": {"redshift-data:statement-owner-iam-userid": "${aws:userid}"}}}, {"action": "redshift-data:CancelStatement", "effective_action": "redshift-data:CancelStatement", "access_level": "Write", "condition": {"StringEquals": {"redshift-data:statement-owner-iam-userid": "${aws:userid}"}}}, {"action": "redshift-data:DescribeStatement", "effective_action": "redshift-data:DescribeStatement", "access_level": "Read", "condition": {"StringEquals": {"redshift-data:statement-owner-iam-userid": "${aws:userid}"}}}, {"action": "redshift-data:ListStatements", "effective_action": "redshift-data:ListStatements", "access_level": "List", "condition": {"StringEquals": {"redshift-data:statement-owner-iam-userid": "${aws:userid}"}}}, {"action": "secretsmanager:ListSecrets", "effective_action": "secretsmanager:ListSecrets", "access_level": "List", "condition": null}, {"action": "secretsmanager:CreateSecret", "effective_action": "secretsmanager:CreateSecret", "access_level": "Write", "condition": {"StringEquals": {"secretsmanager:ResourceTag/RedshiftQueryOwner": "${aws:userid}"}}}, {"action": "secretsmanager:GetSecretValue", "effective_action": "secretsmanager:GetSecretValue", "access_level": "Read", "condition": {"StringEquals": {"secretsmanager:ResourceTag/RedshiftQueryOwner": "${aws:userid}"}}}, {"action": "secretsmanager:TagResource", "effective_action": "secretsmanager:TagResource", "access_level": "Tagging", "condition": {"StringEquals": {"secretsmanager:ResourceTag/RedshiftQueryOwner": "${aws:userid}"}}}]}