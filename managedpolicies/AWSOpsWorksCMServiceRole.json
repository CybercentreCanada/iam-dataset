{"name": "AWSOpsWorksCMServiceRole", "deprecated": false, "createdate": "2021-04-23T17:32:13Z", "updatedate": "2021-04-23T17:32:13+00:00", "version": "v14", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Resource": ["arn:aws:s3:::aws-opsworks-cm-*"], "Action": ["s3:CreateBucket", "s3:DeleteObject", "s3:DeleteBucket", "s3:GetObject", "s3:ListBucket", "s3:PutBucketPolicy", "s3:PutObject", "s3:GetBucketTagging", "s3:PutBucketTagging"]}, {"Effect": "Allow", "Resource": ["*"], "Action": ["tag:UntagResources", "tag:TagResources"]}, {"Effect": "Allow", "Resource": ["*"], "Action": ["ssm:DescribeInstanceInformation", "ssm:GetCommandInvocation", "ssm:ListCommandInvocations", "ssm:ListCommands"]}, {"Effect": "Allow", "Resource": ["*"], "Condition": {"StringLike": {"ssm:resourceTag/aws:cloudformation:stack-name": "aws-opsworks-cm-*"}}, "Action": ["ssm:SendCommand"]}, {"Effect": "Allow", "Resource": ["arn:aws:ssm:*::document/*", "arn:aws:s3:::aws-opsworks-cm-*"], "Action": ["ssm:SendCommand"]}, {"Effect": "Allow", "Resource": ["*"], "Action": ["ec2:AllocateAddress", "ec2:AssociateAddress", "ec2:AuthorizeSecurityGroupIngress", "ec2:CreateImage", "ec2:CreateSecurityGroup", "ec2:CreateSnapshot", "ec2:CreateTags", "ec2:DeleteSecurityGroup", "ec2:DeleteSnapshot", "ec2:DeregisterImage", "ec2:DescribeAccountAttributes", "ec2:DescribeAddresses", "ec2:DescribeImages", "ec2:DescribeInstanceStatus", "ec2:DescribeInstances", "ec2:DescribeSecurityGroups", "ec2:DescribeSnapshots", "ec2:DescribeSubnets", "ec2:DisassociateAddress", "ec2:ReleaseAddress", "ec2:RunInstances", "ec2:StopInstances"]}, {"Effect": "Allow", "Resource": ["*"], "Condition": {"StringLike": {"ec2:ResourceTag/aws:cloudformation:stack-name": "aws-opsworks-cm-*"}}, "Action": ["ec2:TerminateInstances", "ec2:RebootInstances"]}, {"Effect": "Allow", "Resource": ["arn:aws:opsworks-cm:*:*:server/*"], "Action": ["opsworks-cm:DeleteServer", "opsworks-cm:StartMaintenance"]}, {"Effect": "Allow", "Resource": ["arn:aws:cloudformation:*:*:stack/aws-opsworks-cm-*"], "Action": ["cloudformation:CreateStack", "cloudformation:DeleteStack", "cloudformation:DescribeStackEvents", "cloudformation:DescribeStackResources", "cloudformation:DescribeStacks", "cloudformation:UpdateStack"]}, {"Effect": "Allow", "Resource": ["arn:aws:iam::*:role/aws-opsworks-cm-*", "arn:aws:iam::*:role/service-role/aws-opsworks-cm-*"], "Action": ["iam:PassRole"]}, {"Effect": "Allow", "Resource": "*", "Action": ["acm:DeleteCertificate", "acm:ImportCertificate"]}, {"Effect": "Allow", "Resource": "arn:aws:secretsmanager:*:*:opsworks-cm!aws-opsworks-cm-secrets-*", "Action": ["secretsmanager:CreateSecret", "secretsmanager:GetSecretValue", "secretsmanager:UpdateSecret", "secretsmanager:DeleteSecret", "secretsmanager:TagResource", "secretsmanager:UntagResource"]}, {"Effect": "Allow", "Action": ["ec2:DeleteTags"], "Resource": ["arn:aws:ec2:*:*:instance/*", "arn:aws:ec2:*:*:elastic-ip/*", "arn:aws:ec2:*:*:security-group/*"]}]}, "effective_actions": [{"action": "s3:CreateBucket", "effective_action": "s3:CreateBucket", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:DeleteObject", "effective_action": "s3:DeleteObject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:DeleteBucket", "effective_action": "s3:DeleteBucket", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:ListBucket", "effective_action": "s3:ListBucket", "access_level": "List", "condition": null, "privesc": false}, {"action": "s3:PutBucketPolicy", "effective_action": "s3:PutBucketPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "s3:PutObject", "effective_action": "s3:PutObject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:GetBucketTagging", "effective_action": "s3:GetBucketTagging", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:PutBucketTagging", "effective_action": "s3:PutBucketTagging", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "tag:UntagResources", "effective_action": "tag:UntagResources", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "tag:TagResources", "effective_action": "tag:TagResources", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "ssm:DescribeInstanceInformation", "effective_action": "ssm:DescribeInstanceInformation", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ssm:GetCommandInvocation", "effective_action": "ssm:GetCommandInvocation", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ssm:ListCommandInvocations", "effective_action": "ssm:ListCommandInvocations", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ssm:ListCommands", "effective_action": "ssm:ListCommands", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ssm:SendCommand", "effective_action": "ssm:SendCommand", "access_level": "Write", "condition": {"StringLike": {"ssm:resourceTag/aws:cloudformation:stack-name": "aws-opsworks-cm-*"}}, "privesc": false}, {"action": "ssm:SendCommand", "effective_action": "ssm:SendCommand", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:AllocateAddress", "effective_action": "ec2:AllocateAddress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:AssociateAddress", "effective_action": "ec2:AssociateAddress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:AuthorizeSecurityGroupIngress", "effective_action": "ec2:AuthorizeSecurityGroupIngress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateImage", "effective_action": "ec2:CreateImage", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateSecurityGroup", "effective_action": "ec2:CreateSecurityGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateSnapshot", "effective_action": "ec2:CreateSnapshot", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "ec2:DeleteSecurityGroup", "effective_action": "ec2:DeleteSecurityGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteSnapshot", "effective_action": "ec2:DeleteSnapshot", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeregisterImage", "effective_action": "ec2:DeregisterImage", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DescribeAccountAttributes", "effective_action": "ec2:DescribeAccountAttributes", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeAddresses", "effective_action": "ec2:DescribeAddresses", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstanceStatus", "effective_action": "ec2:DescribeInstanceStatus", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSnapshots", "effective_action": "ec2:DescribeSnapshots", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DisassociateAddress", "effective_action": "ec2:DisassociateAddress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:ReleaseAddress", "effective_action": "ec2:ReleaseAddress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:StopInstances", "effective_action": "ec2:StopInstances", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:TerminateInstances", "effective_action": "ec2:TerminateInstances", "access_level": "Write", "condition": {"StringLike": {"ec2:ResourceTag/aws:cloudformation:stack-name": "aws-opsworks-cm-*"}}, "privesc": false}, {"action": "ec2:RebootInstances", "effective_action": "ec2:RebootInstances", "access_level": "Write", "condition": {"StringLike": {"ec2:ResourceTag/aws:cloudformation:stack-name": "aws-opsworks-cm-*"}}, "privesc": false}, {"action": "opsworks-cm:DeleteServer", "effective_action": "opsworks-cm:DeleteServer", "access_level": "Write", "condition": null, "privesc": false}, {"action": "opsworks-cm:StartMaintenance", "effective_action": "opsworks-cm:StartMaintenance", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:CreateStack", "effective_action": "cloudformation:CreateStack", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:DeleteStack", "effective_action": "cloudformation:DeleteStack", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeStackEvents", "effective_action": "cloudformation:DescribeStackEvents", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeStackResources", "effective_action": "cloudformation:DescribeStackResources", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeStacks", "effective_action": "cloudformation:DescribeStacks", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:UpdateStack", "effective_action": "cloudformation:UpdateStack", "access_level": "Write", "condition": null, "privesc": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": null, "privesc": true}, {"action": "acm:DeleteCertificate", "effective_action": "acm:DeleteCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "acm:ImportCertificate", "effective_action": "acm:ImportCertificate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "secretsmanager:CreateSecret", "effective_action": "secretsmanager:CreateSecret", "access_level": "Write", "condition": null, "privesc": false}, {"action": "secretsmanager:GetSecretValue", "effective_action": "secretsmanager:GetSecretValue", "access_level": "Read", "condition": null, "privesc": false}, {"action": "secretsmanager:UpdateSecret", "effective_action": "secretsmanager:UpdateSecret", "access_level": "Write", "condition": null, "privesc": false}, {"action": "secretsmanager:DeleteSecret", "effective_action": "secretsmanager:DeleteSecret", "access_level": "Write", "condition": null, "privesc": false}, {"action": "secretsmanager:TagResource", "effective_action": "secretsmanager:TagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "secretsmanager:UntagResource", "effective_action": "secretsmanager:UntagResource", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "ec2:DeleteTags", "effective_action": "ec2:DeleteTags", "access_level": "Tagging", "condition": null, "privesc": false}]}