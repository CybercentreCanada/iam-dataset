{"name": "AWSThinkboxAWSPortalAdminPolicy", "deprecated": false, "createdate": "2020-08-20T17:16:03Z", "updatedate": "2020-08-20T17:16:03+00:00", "version": "v4", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": true, "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["ec2:AttachInternetGateway", "ec2:AssociateAddress", "ec2:AssociateRouteTable", "ec2:AllocateAddress", "ec2:AuthorizeSecurityGroupIngress", "ec2:CreateFleet", "ec2:CreateLaunchTemplate", "ec2:CreateInternetGateway", "ec2:CreateNatGateway", "ec2:CreatePlacementGroup", "ec2:CreateRoute", "ec2:CreateRouteTable", "ec2:CreateSecurityGroup", "ec2:CreateSubnet", "ec2:CreateVpc", "ec2:CreateVpcEndpoint", "ec2:DescribeAvailabilityZones", "ec2:DescribeAddresses", "ec2:DescribeFleets", "ec2:DescribeFleetHistory", "ec2:DescribeFleetInstances", "ec2:DescribeImages", "ec2:DescribeInstances", "ec2:DescribeInternetGateways", "ec2:DescribeLaunchTemplates", "ec2:DescribeRouteTables", "ec2:DescribeNatGateways", "ec2:DescribeTags", "ec2:DescribeKeyPairs", "ec2:DescribePlacementGroups", "ec2:DescribeInstanceTypeOfferings", "ec2:DescribeRegions", "ec2:DescribeSpotFleetRequestHistory", "ec2:DescribeSecurityGroups", "ec2:DescribeSpotFleetInstances", "ec2:DescribeSpotFleetRequests", "ec2:DescribeSpotPriceHistory", "ec2:DescribeSubnets", "ec2:DescribeVpcs", "ec2:DescribeVpcEndpoints", "ec2:GetConsoleOutput", "ec2:ImportKeyPair", "ec2:ReleaseAddress", "ec2:RequestSpotFleet", "ec2:CancelSpotFleetRequests", "ec2:DisassociateAddress", "ec2:DeleteFleets", "ec2:DeleteLaunchTemplate", "ec2:DeleteVpc", "ec2:DeletePlacementGroup", "ec2:DeleteVpcEndpoints", "ec2:DeleteInternetGateway", "ec2:DeleteSecurityGroup", "ec2:RevokeSecurityGroupIngress", "ec2:DeleteRoute", "ec2:DeleteRouteTable", "ec2:DisassociateRouteTable", "ec2:DeleteSubnet", "ec2:DeleteNatGateway", "ec2:DetachInternetGateway", "ec2:ModifyInstanceAttribute", "ec2:ModifyFleet", "ec2:ModifySpotFleetRequest", "ec2:ModifyVpcAttribute"], "Resource": "*"}, {"Effect": "Allow", "Action": ["ec2:RunInstances"], "Resource": ["arn:aws:ec2:*:*:subnet/*", "arn:aws:ec2:*:*:key-pair/*", "arn:aws:ec2:*::snapshot/*", "arn:aws:ec2:*:*:launch-template/*", "arn:aws:ec2:*:*:volume/*", "arn:aws:ec2:*:*:security-group/*", "arn:aws:ec2:*:*:placement-group/*", "arn:aws:ec2:*:*:network-interface/*", "arn:aws:ec2:*::image/*"]}, {"Effect": "Allow", "Action": ["ec2:RunInstances"], "Resource": "arn:aws:ec2:*:*:instance/*", "Condition": {"StringLike": {"ec2:InstanceProfile": "arn:aws:iam::*:instance-profile/AWSPortal*"}}}, {"Effect": "Allow", "Action": ["ec2:TerminateInstances"], "Resource": "*", "Condition": {"StringEquals": {"ec2:ResourceTag/aws:cloudformation:logical-id": "ReverseForwarder"}}}, {"Effect": "Allow", "Action": ["ec2:TerminateInstances"], "Resource": "*", "Condition": {"StringLike": {"ec2:ResourceTag/aws:ec2spot:fleet-request-id": "*"}}}, {"Effect": "Allow", "Action": ["ec2:TerminateInstances"], "Resource": "*", "Condition": {"StringLike": {"ec2:PlacementGroup": "*DeadlinePlacementGroup*"}}}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": "arn:aws:ec2:*:*:instance/*", "Condition": {"StringLike": {"ec2:PlacementGroup": "*DeadlinePlacementGroup*"}}}, {"Effect": "Allow", "Action": ["ec2:CreateTags"], "Resource": "*", "Condition": {"StringLike": {"ec2:CreateAction": "RunInstances"}}}, {"Effect": "Allow", "Action": ["ec2:CreateTags", "ec2:DeleteTags"], "Resource": ["arn:aws:ec2:*:*:subnet/*", "arn:aws:ec2:*:*:security-group/*", "arn:aws:ec2:*:*:internet-gateway/*", "arn:aws:ec2:*:*:route-table/*", "arn:aws:ec2:*:*:volume/*", "arn:aws:ec2:*:*:vpc/*", "arn:aws:ec2:*:*:natgateway/*"]}, {"Effect": "Allow", "Action": ["iam:GetUser"], "Resource": "*"}, {"Effect": "Allow", "Action": ["iam:GetInstanceProfile"], "Resource": ["arn:aws:iam::*:instance-profile/AWSPortal*"]}, {"Effect": "Allow", "Action": ["iam:GetPolicy", "iam:ListEntitiesForPolicy", "iam:ListPolicyVersions"], "Resource": ["arn:aws:iam::*:policy/AWSPortal*"]}, {"Effect": "Allow", "Action": ["iam:GetRole", "iam:GetRolePolicy"], "Resource": ["arn:aws:iam::*:role/AWSPortal*", "arn:aws:iam::*:role/DeadlineSpot*"]}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": ["arn:aws:iam::*:role/AWSPortal*", "arn:aws:iam::*:role/DeadlineSpot*"], "Condition": {"StringEquals": {"iam:PassedToService": ["ec2.amazonaws.com", "ec2fleet.amazonaws.com", "spot.amazonaws.com", "spotfleet.amazonaws.com", "cloudformation.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["iam:CreateServiceLinkedRole"], "Resource": "arn:aws:iam::*:role/aws-service-role/*", "Condition": {"StringEquals": {"iam:AWSServiceName": ["ec2fleet.amazonaws.com", "spot.amazonaws.com", "spotfleet.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["s3:CreateBucket", "s3:GetBucketLocation", "s3:GetBucketLogging", "s3:GetBucketVersioning", "s3:PutBucketAcl", "s3:PutBucketCORS", "s3:PutBucketVersioning", "s3:GetBucketAcl", "s3:GetObject", "s3:PutBucketLogging", "s3:PutBucketTagging", "s3:PutObject", "s3:ListBucket", "s3:ListBucketVersions", "s3:PutEncryptionConfiguration", "s3:PutLifecycleConfiguration", "s3:DeleteBucket", "s3:DeleteObject", "s3:DeleteBucketPolicy", "s3:DeleteObjectVersion"], "Resource": ["arn:aws:s3::*:awsportal*", "arn:aws:s3::*:stack*", "arn:aws:s3::*:aws-portal-cache*", "arn:aws:s3::*:logs-for-aws-portal-cache*", "arn:aws:s3::*:logs-for-stack*"]}, {"Effect": "Allow", "Action": ["s3:ListAllMyBuckets"], "Resource": "*"}, {"Effect": "Allow", "Action": ["dynamodb:Scan"], "Resource": "arn:aws:dynamodb:*:*:table/DeadlineFleetHealth*"}, {"Effect": "Allow", "Action": ["cloudformation:CreateStack", "cloudformation:DescribeStackEvents", "cloudformation:DescribeStackResources", "cloudformation:DeleteStack", "cloudformation:DeleteChangeSet", "cloudformation:ListStackResources", "cloudformation:CreateChangeSet", "cloudformation:DescribeChangeSet", "cloudformation:ExecuteChangeSet", "cloudformation:UpdateTerminationProtection"], "Resource": ["arn:aws:cloudformation:*:*:stack/stack*/*", "arn:aws:cloudformation:*:*:stack/Deadline*/*"]}, {"Effect": "Allow", "Action": ["cloudformation:EstimateTemplateCost", "cloudformation:DescribeStacks"], "Resource": "*"}, {"Effect": "Allow", "Action": ["logs:DescribeLogStreams", "logs:GetLogEvents", "logs:PutRetentionPolicy", "logs:DeleteRetentionPolicy"], "Resource": "arn:aws:logs:*:*:log-group:/thinkbox*"}, {"Effect": "Allow", "Action": ["logs:DescribeLogGroups", "logs:CreateLogGroup"], "Resource": "*"}, {"Effect": "Allow", "Action": ["kms:Encrypt", "kms:GenerateDataKey"], "Resource": ["*"], "Condition": {"StringLike": {"kms:ViaService": ["s3.*.amazonaws.com", "secretsmanager.*.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["secretsmanager:CreateSecret"], "Resource": "*", "Condition": {"StringLike": {"secretsmanager:Name": ["rcs-tls-pw*"]}}}, {"Effect": "Allow", "Action": ["secretsmanager:DeleteSecret", "secretsmanager:UpdateSecret", "secretsmanager:DescribeSecret", "secretsmanager:TagResource"], "Resource": "arn:aws:secretsmanager:*:*:secret:rcs-tls-pw*"}]}, "effective_actions": [{"action": "ec2:AttachInternetGateway", "effective_action": "ec2:AttachInternetGateway", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:AssociateAddress", "effective_action": "ec2:AssociateAddress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:AssociateRouteTable", "effective_action": "ec2:AssociateRouteTable", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:AllocateAddress", "effective_action": "ec2:AllocateAddress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:AuthorizeSecurityGroupIngress", "effective_action": "ec2:AuthorizeSecurityGroupIngress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateFleet", "effective_action": "ec2:CreateFleet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateLaunchTemplate", "effective_action": "ec2:CreateLaunchTemplate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateInternetGateway", "effective_action": "ec2:CreateInternetGateway", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateNatGateway", "effective_action": "ec2:CreateNatGateway", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreatePlacementGroup", "effective_action": "ec2:CreatePlacementGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateRoute", "effective_action": "ec2:CreateRoute", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateRouteTable", "effective_action": "ec2:CreateRouteTable", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateSecurityGroup", "effective_action": "ec2:CreateSecurityGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateSubnet", "effective_action": "ec2:CreateSubnet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateVpc", "effective_action": "ec2:CreateVpc", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CreateVpcEndpoint", "effective_action": "ec2:CreateVpcEndpoint", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DescribeAvailabilityZones", "effective_action": "ec2:DescribeAvailabilityZones", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeAddresses", "effective_action": "ec2:DescribeAddresses", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeFleets", "effective_action": "ec2:DescribeFleets", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeFleetHistory", "effective_action": "ec2:DescribeFleetHistory", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeFleetInstances", "effective_action": "ec2:DescribeFleetInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeImages", "effective_action": "ec2:DescribeImages", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInternetGateways", "effective_action": "ec2:DescribeInternetGateways", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeLaunchTemplates", "effective_action": "ec2:DescribeLaunchTemplates", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeRouteTables", "effective_action": "ec2:DescribeRouteTables", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeNatGateways", "effective_action": "ec2:DescribeNatGateways", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeTags", "effective_action": "ec2:DescribeTags", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ec2:DescribeKeyPairs", "effective_action": "ec2:DescribeKeyPairs", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribePlacementGroups", "effective_action": "ec2:DescribePlacementGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeInstanceTypeOfferings", "effective_action": "ec2:DescribeInstanceTypeOfferings", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeRegions", "effective_action": "ec2:DescribeRegions", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSpotFleetRequestHistory", "effective_action": "ec2:DescribeSpotFleetRequestHistory", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSpotFleetInstances", "effective_action": "ec2:DescribeSpotFleetInstances", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSpotFleetRequests", "effective_action": "ec2:DescribeSpotFleetRequests", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSpotPriceHistory", "effective_action": "ec2:DescribeSpotPriceHistory", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:DescribeVpcEndpoints", "effective_action": "ec2:DescribeVpcEndpoints", "access_level": "List", "condition": null, "privesc": false}, {"action": "ec2:GetConsoleOutput", "effective_action": "ec2:GetConsoleOutput", "access_level": "Read", "condition": null, "privesc": false}, {"action": "ec2:ImportKeyPair", "effective_action": "ec2:ImportKeyPair", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:ReleaseAddress", "effective_action": "ec2:ReleaseAddress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:RequestSpotFleet", "effective_action": "ec2:RequestSpotFleet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:CancelSpotFleetRequests", "effective_action": "ec2:CancelSpotFleetRequests", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DisassociateAddress", "effective_action": "ec2:DisassociateAddress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteFleets", "effective_action": "ec2:DeleteFleets", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteLaunchTemplate", "effective_action": "ec2:DeleteLaunchTemplate", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteVpc", "effective_action": "ec2:DeleteVpc", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeletePlacementGroup", "effective_action": "ec2:DeletePlacementGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteVpcEndpoints", "effective_action": "ec2:DeleteVpcEndpoints", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteInternetGateway", "effective_action": "ec2:DeleteInternetGateway", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteSecurityGroup", "effective_action": "ec2:DeleteSecurityGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:RevokeSecurityGroupIngress", "effective_action": "ec2:RevokeSecurityGroupIngress", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteRoute", "effective_action": "ec2:DeleteRoute", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteRouteTable", "effective_action": "ec2:DeleteRouteTable", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DisassociateRouteTable", "effective_action": "ec2:DisassociateRouteTable", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteSubnet", "effective_action": "ec2:DeleteSubnet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DeleteNatGateway", "effective_action": "ec2:DeleteNatGateway", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:DetachInternetGateway", "effective_action": "ec2:DetachInternetGateway", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:ModifyInstanceAttribute", "effective_action": "ec2:ModifyInstanceAttribute", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:ModifyFleet", "effective_action": "ec2:ModifyFleet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:ModifySpotFleetRequest", "effective_action": "ec2:ModifySpotFleetRequest", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:ModifyVpcAttribute", "effective_action": "ec2:ModifyVpcAttribute", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": null, "privesc": false}, {"action": "ec2:RunInstances", "effective_action": "ec2:RunInstances", "access_level": "Write", "condition": {"StringLike": {"ec2:InstanceProfile": "arn:aws:iam::*:instance-profile/AWSPortal*"}}, "privesc": false}, {"action": "ec2:TerminateInstances", "effective_action": "ec2:TerminateInstances", "access_level": "Write", "condition": {"StringEquals": {"ec2:ResourceTag/aws:cloudformation:logical-id": "ReverseForwarder"}}, "privesc": false}, {"action": "ec2:TerminateInstances", "effective_action": "ec2:TerminateInstances", "access_level": "Write", "condition": {"StringLike": {"ec2:ResourceTag/aws:ec2spot:fleet-request-id": "*"}}, "privesc": false}, {"action": "ec2:TerminateInstances", "effective_action": "ec2:TerminateInstances", "access_level": "Write", "condition": {"StringLike": {"ec2:PlacementGroup": "*DeadlinePlacementGroup*"}}, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringLike": {"ec2:PlacementGroup": "*DeadlinePlacementGroup*"}}, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": {"StringLike": {"ec2:CreateAction": "RunInstances"}}, "privesc": false}, {"action": "ec2:CreateTags", "effective_action": "ec2:CreateTags", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "ec2:DeleteTags", "effective_action": "ec2:DeleteTags", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "iam:GetUser", "effective_action": "iam:GetUser", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:GetInstanceProfile", "effective_action": "iam:GetInstanceProfile", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:GetPolicy", "effective_action": "iam:GetPolicy", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:ListEntitiesForPolicy", "effective_action": "iam:ListEntitiesForPolicy", "access_level": "List", "condition": null, "privesc": false}, {"action": "iam:ListPolicyVersions", "effective_action": "iam:ListPolicyVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "iam:GetRole", "effective_action": "iam:GetRole", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:GetRolePolicy", "effective_action": "iam:GetRolePolicy", "access_level": "Read", "condition": null, "privesc": false}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": ["ec2.amazonaws.com", "ec2fleet.amazonaws.com", "spot.amazonaws.com", "spotfleet.amazonaws.com", "cloudformation.amazonaws.com"]}}, "privesc": true}, {"action": "iam:CreateServiceLinkedRole", "effective_action": "iam:CreateServiceLinkedRole", "access_level": "Write", "condition": {"StringEquals": {"iam:AWSServiceName": ["ec2fleet.amazonaws.com", "spot.amazonaws.com", "spotfleet.amazonaws.com"]}}, "privesc": false}, {"action": "s3:CreateBucket", "effective_action": "s3:CreateBucket", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:GetBucketLocation", "effective_action": "s3:GetBucketLocation", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:GetBucketLogging", "effective_action": "s3:GetBucketLogging", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:GetBucketVersioning", "effective_action": "s3:GetBucketVersioning", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:PutBucketAcl", "effective_action": "s3:PutBucketAcl", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "s3:PutBucketCORS", "effective_action": "s3:PutBucketCORS", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:PutBucketVersioning", "effective_action": "s3:PutBucketVersioning", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:GetBucketAcl", "effective_action": "s3:GetBucketAcl", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null, "privesc": false}, {"action": "s3:PutBucketLogging", "effective_action": "s3:PutBucketLogging", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:PutBucketTagging", "effective_action": "s3:PutBucketTagging", "access_level": "Tagging", "condition": null, "privesc": false}, {"action": "s3:PutObject", "effective_action": "s3:PutObject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:ListBucket", "effective_action": "s3:ListBucket", "access_level": "List", "condition": null, "privesc": false}, {"action": "s3:ListBucketVersions", "effective_action": "s3:ListBucketVersions", "access_level": "List", "condition": null, "privesc": false}, {"action": "s3:PutEncryptionConfiguration", "effective_action": "s3:PutEncryptionConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:PutLifecycleConfiguration", "effective_action": "s3:PutLifecycleConfiguration", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:DeleteBucket", "effective_action": "s3:DeleteBucket", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:DeleteObject", "effective_action": "s3:DeleteObject", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:DeleteBucketPolicy", "effective_action": "s3:DeleteBucketPolicy", "access_level": "Permissions management", "condition": null, "privesc": false}, {"action": "s3:DeleteObjectVersion", "effective_action": "s3:DeleteObjectVersion", "access_level": "Write", "condition": null, "privesc": false}, {"action": "s3:ListAllMyBuckets", "effective_action": "s3:ListAllMyBuckets", "access_level": "List", "condition": null, "privesc": false}, {"action": "dynamodb:Scan", "effective_action": "dynamodb:Scan", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudformation:CreateStack", "effective_action": "cloudformation:CreateStack", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeStackEvents", "effective_action": "cloudformation:DescribeStackEvents", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeStackResources", "effective_action": "cloudformation:DescribeStackResources", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudformation:DeleteStack", "effective_action": "cloudformation:DeleteStack", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:DeleteChangeSet", "effective_action": "cloudformation:DeleteChangeSet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:ListStackResources", "effective_action": "cloudformation:ListStackResources", "access_level": "List", "condition": null, "privesc": false}, {"action": "cloudformation:CreateChangeSet", "effective_action": "cloudformation:CreateChangeSet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeChangeSet", "effective_action": "cloudformation:DescribeChangeSet", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudformation:ExecuteChangeSet", "effective_action": "cloudformation:ExecuteChangeSet", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:UpdateTerminationProtection", "effective_action": "cloudformation:UpdateTerminationProtection", "access_level": "Write", "condition": null, "privesc": false}, {"action": "cloudformation:EstimateTemplateCost", "effective_action": "cloudformation:EstimateTemplateCost", "access_level": "Read", "condition": null, "privesc": false}, {"action": "cloudformation:DescribeStacks", "effective_action": "cloudformation:DescribeStacks", "access_level": "List", "condition": null, "privesc": false}, {"action": "logs:DescribeLogStreams", "effective_action": "logs:DescribeLogStreams", "access_level": "List", "condition": null, "privesc": false}, {"action": "logs:GetLogEvents", "effective_action": "logs:GetLogEvents", "access_level": "Read", "condition": null, "privesc": false}, {"action": "logs:PutRetentionPolicy", "effective_action": "logs:PutRetentionPolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "logs:DeleteRetentionPolicy", "effective_action": "logs:DeleteRetentionPolicy", "access_level": "Write", "condition": null, "privesc": false}, {"action": "logs:DescribeLogGroups", "effective_action": "logs:DescribeLogGroups", "access_level": "List", "condition": null, "privesc": false}, {"action": "logs:CreateLogGroup", "effective_action": "logs:CreateLogGroup", "access_level": "Write", "condition": null, "privesc": false}, {"action": "kms:Encrypt", "effective_action": "kms:Encrypt", "access_level": "Write", "condition": {"StringLike": {"kms:ViaService": ["s3.*.amazonaws.com", "secretsmanager.*.amazonaws.com"]}}, "privesc": false}, {"action": "kms:GenerateDataKey", "effective_action": "kms:GenerateDataKey", "access_level": "Write", "condition": {"StringLike": {"kms:ViaService": ["s3.*.amazonaws.com", "secretsmanager.*.amazonaws.com"]}}, "privesc": false}, {"action": "secretsmanager:CreateSecret", "effective_action": "secretsmanager:CreateSecret", "access_level": "Write", "condition": {"StringLike": {"secretsmanager:Name": ["rcs-tls-pw*"]}}, "privesc": false}, {"action": "secretsmanager:DeleteSecret", "effective_action": "secretsmanager:DeleteSecret", "access_level": "Write", "condition": null, "privesc": false}, {"action": "secretsmanager:UpdateSecret", "effective_action": "secretsmanager:UpdateSecret", "access_level": "Write", "condition": null, "privesc": false}, {"action": "secretsmanager:DescribeSecret", "effective_action": "secretsmanager:DescribeSecret", "access_level": "Read", "condition": null, "privesc": false}, {"action": "secretsmanager:TagResource", "effective_action": "secretsmanager:TagResource", "access_level": "Tagging", "condition": null, "privesc": false}]}