{"name": "SecretsManagerReadWrite", "deprecated": false, "createdate": "2020-06-24T18:01:22Z", "updatedate": "2020-06-24T18:01:22+00:00", "version": "v3", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write", "Permissions management"], "privesc": false, "document": {"Version": "2012-10-17", "Statement": [{"Action": ["secretsmanager:*", "cloudformation:CreateChangeSet", "cloudformation:DescribeChangeSet", "cloudformation:DescribeStackResource", "cloudformation:DescribeStacks", "cloudformation:ExecuteChangeSet", "ec2:DescribeSecurityGroups", "ec2:DescribeSubnets", "ec2:DescribeVpcs", "kms:DescribeKey", "kms:ListAliases", "kms:ListKeys", "lambda:ListFunctions", "rds:DescribeDBClusters", "rds:DescribeDBInstances", "redshift:DescribeClusters", "tag:GetResources"], "Effect": "Allow", "Resource": "*"}, {"Action": ["lambda:AddPermission", "lambda:CreateFunction", "lambda:GetFunction", "lambda:InvokeFunction", "lambda:UpdateFunctionConfiguration"], "Effect": "Allow", "Resource": "arn:aws:lambda:*:*:function:SecretsManager*"}, {"Action": ["serverlessrepo:CreateCloudFormationChangeSet", "serverlessrepo:GetApplication"], "Effect": "Allow", "Resource": "arn:aws:serverlessrepo:*:*:applications/SecretsManager*"}, {"Action": ["s3:GetObject"], "Effect": "Allow", "Resource": ["arn:aws:s3:::awsserverlessrepo-changesets*", "arn:aws:s3:::secrets-manager-rotation-apps-*/*"]}]}, "effective_actions": [{"action": "secretsmanager:*", "effective_action": "secretsmanager:CancelRotateSecret", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:CreateSecret", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:DeleteResourcePolicy", "access_level": "Permissions management", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:DeleteSecret", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:DescribeSecret", "access_level": "Read", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:GetRandomPassword", "access_level": "Read", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:GetResourcePolicy", "access_level": "Read", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:GetSecretValue", "access_level": "Read", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:ListSecretVersionIds", "access_level": "Read", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:ListSecrets", "access_level": "List", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:PutResourcePolicy", "access_level": "Permissions management", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:PutSecretValue", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:RemoveRegionsFromReplication", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:ReplicateSecretToRegions", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:RestoreSecret", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:RotateSecret", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:StopReplicationToReplica", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:TagResource", "access_level": "Tagging", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:UntagResource", "access_level": "Tagging", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:UpdateSecret", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:UpdateSecretVersionStage", "access_level": "Write", "condition": null}, {"action": "secretsmanager:*", "effective_action": "secretsmanager:ValidateResourcePolicy", "access_level": "Permissions management", "condition": null}, {"action": "cloudformation:CreateChangeSet", "effective_action": "cloudformation:CreateChangeSet", "access_level": "Write", "condition": null}, {"action": "cloudformation:DescribeChangeSet", "effective_action": "cloudformation:DescribeChangeSet", "access_level": "Read", "condition": null}, {"action": "cloudformation:DescribeStackResource", "effective_action": "cloudformation:DescribeStackResource", "access_level": "Read", "condition": null}, {"action": "cloudformation:DescribeStacks", "effective_action": "cloudformation:DescribeStacks", "access_level": "List", "condition": null}, {"action": "cloudformation:ExecuteChangeSet", "effective_action": "cloudformation:ExecuteChangeSet", "access_level": "Write", "condition": null}, {"action": "ec2:DescribeSecurityGroups", "effective_action": "ec2:DescribeSecurityGroups", "access_level": "List", "condition": null}, {"action": "ec2:DescribeSubnets", "effective_action": "ec2:DescribeSubnets", "access_level": "List", "condition": null}, {"action": "ec2:DescribeVpcs", "effective_action": "ec2:DescribeVpcs", "access_level": "List", "condition": null}, {"action": "kms:DescribeKey", "effective_action": "kms:DescribeKey", "access_level": "Read", "condition": null}, {"action": "kms:ListAliases", "effective_action": "kms:ListAliases", "access_level": "List", "condition": null}, {"action": "kms:ListKeys", "effective_action": "kms:ListKeys", "access_level": "List", "condition": null}, {"action": "lambda:ListFunctions", "effective_action": "lambda:ListFunctions", "access_level": "List", "condition": null}, {"action": "rds:DescribeDBClusters", "effective_action": "rds:DescribeDBClusters", "access_level": "List", "condition": null}, {"action": "rds:DescribeDBInstances", "effective_action": "rds:DescribeDBInstances", "access_level": "List", "condition": null}, {"action": "redshift:DescribeClusters", "effective_action": "redshift:DescribeClusters", "access_level": "List", "condition": null}, {"action": "tag:GetResources", "effective_action": "tag:GetResources", "access_level": "Read", "condition": null}, {"action": "lambda:AddPermission", "effective_action": "lambda:AddPermission", "access_level": "Permissions management", "condition": null}, {"action": "lambda:CreateFunction", "effective_action": "lambda:CreateFunction", "access_level": "Write", "condition": null}, {"action": "lambda:GetFunction", "effective_action": "lambda:GetFunction", "access_level": "Read", "condition": null}, {"action": "lambda:InvokeFunction", "effective_action": "lambda:InvokeFunction", "access_level": "Write", "condition": null}, {"action": "lambda:UpdateFunctionConfiguration", "effective_action": "lambda:UpdateFunctionConfiguration", "access_level": "Write", "condition": null}, {"action": "serverlessrepo:CreateCloudFormationChangeSet", "effective_action": "serverlessrepo:CreateCloudFormationChangeSet", "access_level": "Write", "condition": null}, {"action": "serverlessrepo:GetApplication", "effective_action": "serverlessrepo:GetApplication", "access_level": "Read", "condition": null}, {"action": "s3:GetObject", "effective_action": "s3:GetObject", "access_level": "Read", "condition": null}]}