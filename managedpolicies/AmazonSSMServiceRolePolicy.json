{"name": "AmazonSSMServiceRolePolicy", "deprecated": false, "createdate": "2021-04-26T20:43:46Z", "updatedate": "2021-04-26T20:43:46+00:00", "version": "v13", "malformed": false, "unknown_actions": [], "access_levels": ["List", "Read", "Tagging", "Write"], "document": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["ssm:CancelCommand", "ssm:GetCommandInvocation", "ssm:ListCommandInvocations", "ssm:ListCommands", "ssm:SendCommand", "ssm:GetAutomationExecution", "ssm:GetParameters", "ssm:StartAutomationExecution", "ssm:ListTagsForResource", "ssm:GetCalendarState"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["ssm:UpdateServiceSetting", "ssm:GetServiceSetting"], "Resource": ["arn:aws:ssm:*:*:servicesetting/ssm/opsitem/*", "arn:aws:ssm:*:*:servicesetting/ssm/opsdata/*"]}, {"Effect": "Allow", "Action": ["ec2:DescribeInstanceAttribute", "ec2:DescribeInstanceStatus", "ec2:DescribeInstances"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["lambda:InvokeFunction"], "Resource": ["arn:aws:lambda:*:*:function:SSM*", "arn:aws:lambda:*:*:function:*:SSM*"]}, {"Effect": "Allow", "Action": ["states:DescribeExecution", "states:StartExecution"], "Resource": ["arn:aws:states:*:*:stateMachine:SSM*", "arn:aws:states:*:*:execution:SSM*"]}, {"Effect": "Allow", "Action": ["resource-groups:ListGroups", "resource-groups:ListGroupResources", "resource-groups:GetGroupQuery"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["cloudformation:DescribeStacks", "cloudformation:ListStackResources"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["tag:GetResources"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["config:SelectResourceConfig"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["compute-optimizer:GetEC2InstanceRecommendations", "compute-optimizer:GetEnrollmentStatus"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["support:DescribeTrustedAdvisorChecks", "support:DescribeTrustedAdvisorCheckSummaries", "support:DescribeTrustedAdvisorCheckResult", "support:DescribeCases"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["config:DescribeComplianceByConfigRule", "config:DescribeComplianceByResource", "config:DescribeRemediationConfigurations", "config:DescribeConfigurationRecorders"], "Resource": ["*"]}, {"Effect": "Allow", "Action": ["iam:PassRole"], "Resource": "*", "Condition": {"StringEquals": {"iam:PassedToService": ["ssm.amazonaws.com"]}}}, {"Effect": "Allow", "Action": ["organizations:DescribeOrganization"], "Resource": "*"}, {"Effect": "Allow", "Action": ["cloudformation:ListStackSets"], "Resource": "*"}, {"Effect": "Allow", "Action": ["cloudformation:ListStackInstances", "cloudformation:DescribeStackSetOperation", "cloudformation:DeleteStackSet"], "Resource": "arn:aws:cloudformation:*:*:stackset/AWS-QuickSetup-SSM*:*"}, {"Effect": "Allow", "Action": ["cloudformation:DeleteStackInstances"], "Resource": ["arn:aws:cloudformation:*:*:stackset/AWS-QuickSetup-SSM*:*", "arn:aws:cloudformation:*:*:stackset-target/AWS-QuickSetup-SSM*:*", "arn:aws:cloudformation:*:*:type/resource/*"]}, {"Effect": "Allow", "Action": ["events:PutRule", "events:PutTargets"], "Resource": "*", "Condition": {"StringEquals": {"events:ManagedBy": "ssm.amazonaws.com"}}}, {"Effect": "Allow", "Action": ["events:RemoveTargets", "events:DeleteRule"], "Resource": ["arn:aws:events:*:*:rule/SSMExplorerManagedRule"]}, {"Effect": "Allow", "Action": ["events:DescribeRule"], "Resource": "*"}, {"Effect": "Allow", "Action": ["securityhub:DescribeHub"], "Resource": "*"}]}, "effective_actions": [{"action": "ssm:CancelCommand", "effective_action": "ssm:CancelCommand", "access_level": "Write", "condition": null}, {"action": "ssm:GetCommandInvocation", "effective_action": "ssm:GetCommandInvocation", "access_level": "Read", "condition": null}, {"action": "ssm:ListCommandInvocations", "effective_action": "ssm:ListCommandInvocations", "access_level": "Read", "condition": null}, {"action": "ssm:ListCommands", "effective_action": "ssm:ListCommands", "access_level": "Read", "condition": null}, {"action": "ssm:SendCommand", "effective_action": "ssm:SendCommand", "access_level": "Write", "condition": null}, {"action": "ssm:GetAutomationExecution", "effective_action": "ssm:GetAutomationExecution", "access_level": "Read", "condition": null}, {"action": "ssm:GetParameters", "effective_action": "ssm:GetParameters", "access_level": "Read", "condition": null}, {"action": "ssm:StartAutomationExecution", "effective_action": "ssm:StartAutomationExecution", "access_level": "Write", "condition": null}, {"action": "ssm:ListTagsForResource", "effective_action": "ssm:ListTagsForResource", "access_level": "Read", "condition": null}, {"action": "ssm:GetCalendarState", "effective_action": "ssm:GetCalendarState", "access_level": "Read", "condition": null}, {"action": "ssm:UpdateServiceSetting", "effective_action": "ssm:UpdateServiceSetting", "access_level": "Write", "condition": null}, {"action": "ssm:GetServiceSetting", "effective_action": "ssm:GetServiceSetting", "access_level": "Read", "condition": null}, {"action": "ec2:DescribeInstanceAttribute", "effective_action": "ec2:DescribeInstanceAttribute", "access_level": "List", "condition": null}, {"action": "ec2:DescribeInstanceStatus", "effective_action": "ec2:DescribeInstanceStatus", "access_level": "List", "condition": null}, {"action": "ec2:DescribeInstances", "effective_action": "ec2:DescribeInstances", "access_level": "List", "condition": null}, {"action": "lambda:InvokeFunction", "effective_action": "lambda:InvokeFunction", "access_level": "Write", "condition": null}, {"action": "states:DescribeExecution", "effective_action": "states:DescribeExecution", "access_level": "Read", "condition": null}, {"action": "states:StartExecution", "effective_action": "states:StartExecution", "access_level": "Write", "condition": null}, {"action": "resource-groups:ListGroups", "effective_action": "resource-groups:ListGroups", "access_level": "List", "condition": null}, {"action": "resource-groups:ListGroupResources", "effective_action": "resource-groups:ListGroupResources", "access_level": "List", "condition": null}, {"action": "resource-groups:GetGroupQuery", "effective_action": "resource-groups:GetGroupQuery", "access_level": "Read", "condition": null}, {"action": "cloudformation:DescribeStacks", "effective_action": "cloudformation:DescribeStacks", "access_level": "List", "condition": null}, {"action": "cloudformation:ListStackResources", "effective_action": "cloudformation:ListStackResources", "access_level": "List", "condition": null}, {"action": "tag:GetResources", "effective_action": "tag:GetResources", "access_level": "Read", "condition": null}, {"action": "config:SelectResourceConfig", "effective_action": "config:SelectResourceConfig", "access_level": "Read", "condition": null}, {"action": "compute-optimizer:GetEC2InstanceRecommendations", "effective_action": "compute-optimizer:GetEC2InstanceRecommendations", "access_level": "List", "condition": null}, {"action": "compute-optimizer:GetEnrollmentStatus", "effective_action": "compute-optimizer:GetEnrollmentStatus", "access_level": "List", "condition": null}, {"action": "support:DescribeTrustedAdvisorChecks", "effective_action": "support:DescribeTrustedAdvisorChecks", "access_level": "Read", "condition": null}, {"action": "support:DescribeTrustedAdvisorCheckSummaries", "effective_action": "support:DescribeTrustedAdvisorCheckSummaries", "access_level": "Read", "condition": null}, {"action": "support:DescribeTrustedAdvisorCheckResult", "effective_action": "support:DescribeTrustedAdvisorCheckResult", "access_level": "Read", "condition": null}, {"action": "support:DescribeCases", "effective_action": "support:DescribeCases", "access_level": "Read", "condition": null}, {"action": "config:DescribeComplianceByConfigRule", "effective_action": "config:DescribeComplianceByConfigRule", "access_level": "Read", "condition": null}, {"action": "config:DescribeComplianceByResource", "effective_action": "config:DescribeComplianceByResource", "access_level": "Read", "condition": null}, {"action": "config:DescribeRemediationConfigurations", "effective_action": "config:DescribeRemediationConfigurations", "access_level": "List", "condition": null}, {"action": "config:DescribeConfigurationRecorders", "effective_action": "config:DescribeConfigurationRecorders", "access_level": "List", "condition": null}, {"action": "iam:PassRole", "effective_action": "iam:PassRole", "access_level": "Write", "condition": {"StringEquals": {"iam:PassedToService": ["ssm.amazonaws.com"]}}}, {"action": "organizations:DescribeOrganization", "effective_action": "organizations:DescribeOrganization", "access_level": "Read", "condition": null}, {"action": "cloudformation:ListStackSets", "effective_action": "cloudformation:ListStackSets", "access_level": "List", "condition": null}, {"action": "cloudformation:ListStackInstances", "effective_action": "cloudformation:ListStackInstances", "access_level": "List", "condition": null}, {"action": "cloudformation:DescribeStackSetOperation", "effective_action": "cloudformation:DescribeStackSetOperation", "access_level": "Read", "condition": null}, {"action": "cloudformation:DeleteStackSet", "effective_action": "cloudformation:DeleteStackSet", "access_level": "Write", "condition": null}, {"action": "cloudformation:DeleteStackInstances", "effective_action": "cloudformation:DeleteStackInstances", "access_level": "Write", "condition": null}, {"action": "events:PutRule", "effective_action": "events:PutRule", "access_level": "Tagging", "condition": {"StringEquals": {"events:ManagedBy": "ssm.amazonaws.com"}}}, {"action": "events:PutTargets", "effective_action": "events:PutTargets", "access_level": "Write", "condition": {"StringEquals": {"events:ManagedBy": "ssm.amazonaws.com"}}}, {"action": "events:RemoveTargets", "effective_action": "events:RemoveTargets", "access_level": "Write", "condition": null}, {"action": "events:DeleteRule", "effective_action": "events:DeleteRule", "access_level": "Write", "condition": null}, {"action": "events:DescribeRule", "effective_action": "events:DescribeRule", "access_level": "Read", "condition": null}, {"action": "securityhub:DescribeHub", "effective_action": "securityhub:DescribeHub", "access_level": "Read", "condition": null}]}