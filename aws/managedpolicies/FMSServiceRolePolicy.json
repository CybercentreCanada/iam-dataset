{
  "access_levels": [],
  "arn": "arn:aws:iam::aws:policy/aws-service-role/FMSServiceRolePolicy",
  "createdate": "2024-04-22T19:12:13+00:00",
  "credentials_exposure": false,
  "data_access": false,
  "deprecated": false,
  "document": {
    "Statement": [
      {
        "Action": [
          "waf:UpdateWebACL",
          "waf:DeleteWebACL",
          "waf:GetWebACL",
          "waf:GetRuleGroup",
          "waf:ListSubscribedRuleGroups",
          "waf-regional:UpdateWebACL",
          "waf-regional:DeleteWebACL",
          "waf-regional:GetWebACL",
          "waf-regional:GetRuleGroup",
          "waf-regional:ListSubscribedRuleGroups",
          "waf-regional:ListResourcesForWebACL",
          "waf-regional:AssociateWebACL",
          "waf-regional:DisassociateWebACL",
          "elasticloadbalancing:SetWebACL",
          "apigateway:SetWebACL",
          "elasticloadbalancing:SetSecurityGroups",
          "waf:ListTagsForResource",
          "waf-regional:ListTagsForResource"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:waf:*:*:webacl/*",
          "arn:aws:waf-regional:*:*:webacl/*",
          "arn:aws:waf:*:*:rulegroup/*",
          "arn:aws:waf-regional:*:*:rulegroup/*",
          "arn:aws:elasticloadbalancing:*:*:loadbalancer/app/*",
          "arn:aws:apigateway:*::/restapis/*/stages/*"
        ],
        "Sid": "WafGeneral"
      },
      {
        "Action": [
          "wafv2:PutLoggingConfiguration",
          "wafv2:GetLoggingConfiguration",
          "wafv2:ListLoggingConfigurations",
          "wafv2:DeleteLoggingConfiguration"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:wafv2:*:*:regional/webacl/*",
          "arn:aws:wafv2:*:*:global/webacl/*"
        ],
        "Sid": "Wafv2Logging"
      },
      {
        "Action": [
          "waf:CreateWebACL",
          "waf-regional:CreateWebACL",
          "waf:GetChangeToken",
          "waf-regional:GetChangeToken",
          "waf-regional:GetWebACLForResource"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:waf:*:*:*",
          "arn:aws:waf-regional:*:*:*"
        ],
        "Sid": "WafWebaclCreation"
      },
      {
        "Action": [
          "elasticloadbalancing:ApplySecurityGroupsToLoadBalancer",
          "elasticloadbalancing:DescribeTags"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "ElbGeneral"
      },
      {
        "Action": [
          "waf:PutPermissionPolicy",
          "waf:GetPermissionPolicy",
          "waf:DeletePermissionPolicy",
          "waf-regional:PutPermissionPolicy",
          "waf-regional:GetPermissionPolicy",
          "waf-regional:DeletePermissionPolicy"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:waf:*:*:webacl/*",
          "arn:aws:waf:*:*:rulegroup/*",
          "arn:aws:waf-regional:*:*:webacl/*",
          "arn:aws:waf-regional:*:*:rulegroup/*"
        ],
        "Sid": "WafPermissionPolicy"
      },
      {
        "Action": [
          "cloudfront:GetDistribution",
          "cloudfront:UpdateDistribution",
          "cloudfront:ListDistributionsByWebACLId",
          "cloudfront:ListDistributions",
          "cloudfront:ListTagsForResource"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "CloudfrontGeneral"
      },
      {
        "Action": [
          "config:DeleteConfigRule",
          "config:GetComplianceDetailsByConfigRule",
          "config:PutConfigRule",
          "config:StartConfigRulesEvaluation",
          "config:DeleteEvaluationResults"
        ],
        "Effect": "Allow",
        "Resource": "arn:aws:config:*:*:config-rule/aws-service-rule/fms.amazonaws.com/*",
        "Sid": "ConfigScoped"
      },
      {
        "Action": [
          "config:DescribeComplianceByConfigRule",
          "config:DescribeConfigurationRecorders",
          "config:DescribeConfigurationRecorderStatus",
          "config:DescribeConfigRules",
          "config:DescribeConfigRuleEvaluationStatus",
          "config:PutConfigurationRecorder",
          "config:StartConfigurationRecorder",
          "config:PutDeliveryChannel",
          "config:DescribeDeliveryChannels",
          "config:DescribeDeliveryChannelStatus",
          "config:GetComplianceSummaryByConfigRule",
          "config:GetDiscoveredResourceCounts",
          "config:PutEvaluations",
          "config:SelectResourceConfig"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "ConfigUnscoped"
      },
      {
        "Action": [
          "iam:DeleteServiceLinkedRole",
          "iam:GetServiceLinkedRoleDeletionStatus"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/aws-service-role/fms.amazonaws.com/AWSServiceRoleForFMS"
        ],
        "Sid": "SlrDeletion"
      },
      {
        "Action": [
          "organizations:DescribeAccount",
          "organizations:DescribeOrganization",
          "organizations:ListAccounts",
          "organizations:DescribeOrganizationalUnit",
          "organizations:ListChildren",
          "organizations:ListRoots",
          "organizations:ListParents",
          "organizations:ListOrganizationalUnitsForParent",
          "organizations:ListAWSServiceAccessForOrganization"
        ],
        "Effect": "Allow",
        "Resource": [
          "*"
        ],
        "Sid": "OrganizationsGeneral"
      },
      {
        "Action": [
          "shield:CreateProtection",
          "shield:DeleteProtection",
          "shield:DescribeProtection",
          "shield:ListProtections",
          "shield:ListAttacks",
          "shield:CreateSubscription",
          "shield:DescribeSubscription",
          "shield:GetSubscriptionState",
          "shield:DescribeDRTAccess",
          "shield:DescribeEmergencyContactSettings",
          "shield:UpdateEmergencyContactSettings",
          "elasticloadbalancing:DescribeLoadBalancers",
          "ec2:DescribeAddresses",
          "shield:EnableApplicationLayerAutomaticResponse",
          "shield:DisableApplicationLayerAutomaticResponse",
          "shield:UpdateApplicationLayerAutomaticResponse"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "ShieldGeneral"
      },
      {
        "Action": [
          "ec2:AuthorizeSecurityGroupEgress",
          "ec2:AuthorizeSecurityGroupIngress",
          "ec2:DeleteSecurityGroup",
          "ec2:RevokeSecurityGroupEgress",
          "ec2:RevokeSecurityGroupIngress",
          "ec2:UpdateSecurityGroupRuleDescriptionsEgress",
          "ec2:UpdateSecurityGroupRuleDescriptionsIngress"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:network-interface/*",
          "arn:aws:ec2:*:*:security-group/*",
          "arn:aws:ec2:*:*:instance/*"
        ],
        "Sid": "EC2SecurityGroupScoped"
      },
      {
        "Action": [
          "ec2:CreateTags"
        ],
        "Condition": {
          "StringEquals": {
            "ec2:CreateAction": "CreateSecurityGroup"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:security-group/*"
        ],
        "Sid": "SecurityGroupTagCreation"
      },
      {
        "Action": [
          "ec2:DeleteTags",
          "ec2:CreateTags"
        ],
        "Condition": {
          "StringLike": {
            "aws:ResourceTag/FMManaged": "*"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:security-group/*"
        ],
        "Sid": "SecurityGroupTagManagement"
      },
      {
        "Action": [
          "ec2:CreateSecurityGroup",
          "ec2:DescribeSecurityGroupReferences",
          "ec2:DescribeSecurityGroups",
          "ec2:DescribeStaleSecurityGroups",
          "ec2:DescribeNetworkInterfaces",
          "ec2:ModifyNetworkInterfaceAttribute",
          "ec2:DescribeVpcs",
          "ec2:DescribeVpcPeeringConnections",
          "ec2:DescribeNetworkInterfaceAttribute",
          "ec2:DescribeInstances",
          "ec2:AssociateRouteTable",
          "ec2:CreateSubnet",
          "ec2:CreateRouteTable",
          "ec2:DeleteSubnet",
          "ec2:DisassociateRouteTable",
          "ec2:ReplaceRouteTableAssociation"
        ],
        "Effect": "Allow",
        "Resource": [
          "*"
        ],
        "Sid": "Ec2Unscoped"
      },
      {
        "Action": [
          "wafv2:TagResource",
          "wafv2:ListResourcesForWebACL",
          "wafv2:AssociateWebACL",
          "wafv2:ListTagsForResource",
          "wafv2:UntagResource",
          "wafv2:GetWebACL",
          "wafv2:DisassociateFirewallManager",
          "wafv2:DeleteWebACL",
          "wafv2:DisassociateWebACL"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:wafv2:*:*:global/webacl/*",
          "arn:aws:wafv2:*:*:regional/webacl/*"
        ],
        "Sid": "Wafv2General"
      },
      {
        "Action": [
          "wafv2:UpdateWebACL",
          "wafv2:CreateWebACL",
          "wafv2:DeleteFirewallManagerRuleGroups",
          "wafv2:PutFirewallManagerRuleGroups"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:wafv2:*:*:global/webacl/*",
          "arn:aws:wafv2:*:*:regional/webacl/*",
          "arn:aws:wafv2:*:*:global/rulegroup/*",
          "arn:aws:wafv2:*:*:regional/rulegroup/*",
          "arn:aws:wafv2:*:*:global/managedruleset/*",
          "arn:aws:wafv2:*:*:regional/managedruleset/*",
          "arn:aws:wafv2:*:*:global/ipset/*",
          "arn:aws:wafv2:*:*:regional/ipset/*",
          "arn:aws:wafv2:*:*:global/regexpatternset/*",
          "arn:aws:wafv2:*:*:regional/regexpatternset/*"
        ],
        "Sid": "Wafv2WebAclAndRuleGroupMutation"
      },
      {
        "Action": [
          "wafv2:PutPermissionPolicy",
          "wafv2:GetPermissionPolicy",
          "wafv2:DeletePermissionPolicy"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:wafv2:*:*:global/rulegroup/*",
          "arn:aws:wafv2:*:*:regional/rulegroup/*"
        ],
        "Sid": "Wafv2PermissionPolicy"
      },
      {
        "Action": [
          "wafv2:GetWebACLForResource"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:wafv2:*:*:regional/webacl/*"
        ],
        "Sid": "Wafv2WebaclDescribe"
      },
      {
        "Action": [
          "ec2:CreateTags"
        ],
        "Condition": {
          "ForAllValues:StringEquals": {
            "aws:TagKeys": [
              "Name",
              "FMManaged"
            ]
          },
          "StringEquals": {
            "ec2:CreateAction": "CreateRouteTable"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:ec2:*:*:route-table/*",
        "Sid": "RouteTableTagManagement"
      },
      {
        "Action": [
          "ec2:CreateTags"
        ],
        "Condition": {
          "ForAllValues:StringEquals": {
            "aws:TagKeys": [
              "Name",
              "FMManaged"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:subnet/*"
        ],
        "Sid": "SubnetTagManagement"
      },
      {
        "Action": [
          "ec2:CreateTags"
        ],
        "Condition": {
          "ForAllValues:StringEquals": {
            "aws:TagKeys": [
              "Name",
              "FMManaged"
            ]
          },
          "StringEquals": {
            "ec2:CreateAction": "CreateVpcEndpoint"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:vpc-endpoint/*"
        ],
        "Sid": "VPCEndpointTagManagement"
      },
      {
        "Action": [
          "ec2:DeleteRouteTable"
        ],
        "Condition": {
          "StringEquals": {
            "ec2:ResourceTag/FMManaged": "true"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:ec2:*:*:route-table/*",
        "Sid": "RouteTableCleanup"
      },
      {
        "Action": [
          "ec2:DescribeInternetGateways",
          "ec2:DescribeRouteTables",
          "ec2:DescribeSubnets",
          "ec2:DescribeTags",
          "ec2:DescribeVpcEndpoints",
          "ec2:DescribeAvailabilityZones"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "Ec2DescribeUnscoped"
      },
      {
        "Action": [
          "ec2:CreateVpcEndpoint"
        ],
        "Condition": {
          "StringEquals": {
            "aws:RequestTag/FMManaged": [
              "true"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:vpc-endpoint/*"
        ],
        "Sid": "CreateVpcEndpointScoped"
      },
      {
        "Action": [
          "ec2:CreateVpcEndpoint"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:subnet/*",
          "arn:aws:ec2:*:*:vpc/*"
        ],
        "Sid": "CreateVpcEndpointUnscoped"
      },
      {
        "Action": [
          "ec2:DeleteVpcEndpoints"
        ],
        "Condition": {
          "StringEquals": {
            "ec2:ResourceTag/FMManaged": "true"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:ec2:*:*:vpc-endpoint/*",
        "Sid": "VpcEndpointsDeletion"
      },
      {
        "Action": [
          "ram:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringEquals": {
            "aws:TagKeys": [
              "Name",
              "FMManaged"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ram:*:*:resource-share/*"
        ],
        "Sid": "RamTagManagement"
      },
      {
        "Action": [
          "ram:AssociateResourceShare",
          "ram:UpdateResourceShare",
          "ram:DeleteResourceShare"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceTag/FMManaged": "true"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:ram:*:*:resource-share/*",
        "Sid": "RamMutation"
      },
      {
        "Action": [
          "ram:CreateResourceShare"
        ],
        "Condition": {
          "ForAllValues:StringEquals": {
            "aws:TagKeys": [
              "Name",
              "FMManaged"
            ]
          },
          "StringEquals": {
            "aws:RequestTag/FMManaged": [
              "true"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "RamCreation"
      },
      {
        "Action": [
          "ram:GetResourceShareAssociations",
          "ram:GetResourceShares"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "RamDescribe"
      },
      {
        "Action": [
          "iam:CreateServiceLinkedRole"
        ],
        "Condition": {
          "StringEquals": {
            "iam:AWSServiceName": [
              "network-firewall.amazonaws.com",
              "shield.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "SlrCreation"
      },
      {
        "Action": [
          "iam:GetRole"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "IamDescribe"
      },
      {
        "Action": [
          "network-firewall:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringEquals": {
            "aws:TagKeys": [
              "Name",
              "FMManaged"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "NetworkFirewallTagManagement"
      },
      {
        "Action": [
          "network-firewall:AssociateSubnets",
          "network-firewall:CreateFirewall",
          "network-firewall:CreateFirewallPolicy",
          "network-firewall:DisassociateSubnets",
          "network-firewall:UpdateFirewallDeleteProtection",
          "network-firewall:UpdateFirewallPolicy",
          "network-firewall:UpdateFirewallPolicyChangeProtection",
          "network-firewall:UpdateSubnetChangeProtection",
          "network-firewall:AssociateFirewallPolicy",
          "network-firewall:DescribeFirewall",
          "network-firewall:DescribeFirewallPolicy",
          "network-firewall:DescribeRuleGroup",
          "network-firewall:ListFirewallPolicies",
          "network-firewall:ListFirewalls",
          "network-firewall:ListRuleGroups",
          "network-firewall:PutResourcePolicy",
          "network-firewall:DescribeResourcePolicy",
          "network-firewall:DeleteResourcePolicy",
          "network-firewall:DescribeLoggingConfiguration",
          "network-firewall:UpdateLoggingConfiguration"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "NetworkFirewallGeneral"
      },
      {
        "Action": [
          "network-firewall:DeleteFirewallPolicy",
          "network-firewall:DeleteFirewall"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceTag/FMManaged": "true"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "NetworkFirewallCleanup"
      },
      {
        "Action": [
          "logs:ListLogDeliveries",
          "logs:CreateLogDelivery",
          "logs:GetLogDelivery",
          "logs:UpdateLogDelivery",
          "logs:DeleteLogDelivery"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "LogsGeneral"
      },
      {
        "Action": [
          "route53resolver:ListFirewallRuleGroupAssociations",
          "route53resolver:ListTagsForResource",
          "route53resolver:ListFirewallRuleGroups",
          "route53resolver:GetFirewallRuleGroupAssociation",
          "route53resolver:GetFirewallRuleGroup",
          "route53resolver:GetFirewallRuleGroupPolicy",
          "route53resolver:PutFirewallRuleGroupPolicy"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "Route53ResolverRuleGroupUnscoped"
      },
      {
        "Action": [
          "route53resolver:UpdateFirewallRuleGroupAssociation",
          "route53resolver:DisassociateFirewallRuleGroup"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceTag/FMManaged": "true"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:route53resolver:*:*:firewall-rule-group-association/*",
        "Sid": "Route53ResolverRuleGroupCleanup"
      },
      {
        "Action": [
          "route53resolver:AssociateFirewallRuleGroup",
          "route53resolver:TagResource"
        ],
        "Condition": {
          "StringEquals": {
            "aws:RequestTag/FMManaged": "true"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:route53resolver:*:*:firewall-rule-group-association/*",
        "Sid": "Route53ResolverRuleGroupScoped"
      },
      {
        "Action": [
          "ec2:CreateTags"
        ],
        "Condition": {
          "ForAllValues:StringEquals": {
            "aws:TagKeys": [
              "Name",
              "FMManaged",
              "FMPolicies"
            ]
          },
          "StringEquals": {
            "ec2:CreateAction": "CreateNetworkAcl"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:ec2:*:*:network-acl/*",
        "Sid": "NaclTagCreation"
      },
      {
        "Action": [
          "ec2:CreateTags",
          "ec2:DeleteTags"
        ],
        "Condition": {
          "ForAllValues:StringEquals": {
            "aws:TagKeys": [
              "Name",
              "FMManaged",
              "FMPolicies"
            ]
          },
          "StringEquals": {
            "aws:ResourceTag/FMManaged": "true"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:ec2:*:*:network-acl/*",
        "Sid": "NaclTagManagement"
      },
      {
        "Action": [
          "ec2:DeleteNetworkAclEntry",
          "ec2:CreateNetworkAclEntry",
          "ec2:ReplaceNetworkAclEntry",
          "ec2:DeleteNetworkAcl"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceTag/FMManaged": "true"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "NaclScoped"
      },
      {
        "Action": [
          "ec2:ReplaceNetworkAclAssociation",
          "ec2:DescribeNetworkAcls",
          "ec2:CreateNetworkAcl"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "NaclUnscoped"
      }
    ],
    "Version": "2012-10-17"
  },
  "effective_actions": [],
  "malformed": false,
  "name": "FMSServiceRolePolicy",
  "privesc": false,
  "resource_exposure": false,
  "undocumented_actions": false,
  "unknown_actions": [
    {
      "action": "waf:UpdateWebACL",
      "condition": null
    },
    {
      "action": "waf:DeleteWebACL",
      "condition": null
    },
    {
      "action": "waf:GetWebACL",
      "condition": null
    },
    {
      "action": "waf:GetRuleGroup",
      "condition": null
    },
    {
      "action": "waf:ListSubscribedRuleGroups",
      "condition": null
    },
    {
      "action": "waf-regional:UpdateWebACL",
      "condition": null
    },
    {
      "action": "waf-regional:DeleteWebACL",
      "condition": null
    },
    {
      "action": "waf-regional:GetWebACL",
      "condition": null
    },
    {
      "action": "waf-regional:GetRuleGroup",
      "condition": null
    },
    {
      "action": "waf-regional:ListSubscribedRuleGroups",
      "condition": null
    },
    {
      "action": "waf-regional:ListResourcesForWebACL",
      "condition": null
    },
    {
      "action": "waf-regional:AssociateWebACL",
      "condition": null
    },
    {
      "action": "waf-regional:DisassociateWebACL",
      "condition": null
    },
    {
      "action": "elasticloadbalancing:SetWebACL",
      "condition": null
    },
    {
      "action": "apigateway:SetWebACL",
      "condition": null
    },
    {
      "action": "elasticloadbalancing:SetSecurityGroups",
      "condition": null
    },
    {
      "action": "waf:ListTagsForResource",
      "condition": null
    },
    {
      "action": "waf-regional:ListTagsForResource",
      "condition": null
    },
    {
      "action": "wafv2:PutLoggingConfiguration",
      "condition": null
    },
    {
      "action": "wafv2:GetLoggingConfiguration",
      "condition": null
    },
    {
      "action": "wafv2:ListLoggingConfigurations",
      "condition": null
    },
    {
      "action": "wafv2:DeleteLoggingConfiguration",
      "condition": null
    },
    {
      "action": "waf:CreateWebACL",
      "condition": null
    },
    {
      "action": "waf-regional:CreateWebACL",
      "condition": null
    },
    {
      "action": "waf:GetChangeToken",
      "condition": null
    },
    {
      "action": "waf-regional:GetChangeToken",
      "condition": null
    },
    {
      "action": "waf-regional:GetWebACLForResource",
      "condition": null
    },
    {
      "action": "elasticloadbalancing:ApplySecurityGroupsToLoadBalancer",
      "condition": null
    },
    {
      "action": "elasticloadbalancing:DescribeTags",
      "condition": null
    },
    {
      "action": "waf:PutPermissionPolicy",
      "condition": null
    },
    {
      "action": "waf:GetPermissionPolicy",
      "condition": null
    },
    {
      "action": "waf:DeletePermissionPolicy",
      "condition": null
    },
    {
      "action": "waf-regional:PutPermissionPolicy",
      "condition": null
    },
    {
      "action": "waf-regional:GetPermissionPolicy",
      "condition": null
    },
    {
      "action": "waf-regional:DeletePermissionPolicy",
      "condition": null
    },
    {
      "action": "cloudfront:GetDistribution",
      "condition": null
    },
    {
      "action": "cloudfront:UpdateDistribution",
      "condition": null
    },
    {
      "action": "cloudfront:ListDistributionsByWebACLId",
      "condition": null
    },
    {
      "action": "cloudfront:ListDistributions",
      "condition": null
    },
    {
      "action": "cloudfront:ListTagsForResource",
      "condition": null
    },
    {
      "action": "config:DeleteConfigRule",
      "condition": null
    },
    {
      "action": "config:GetComplianceDetailsByConfigRule",
      "condition": null
    },
    {
      "action": "config:PutConfigRule",
      "condition": null
    },
    {
      "action": "config:StartConfigRulesEvaluation",
      "condition": null
    },
    {
      "action": "config:DeleteEvaluationResults",
      "condition": null
    },
    {
      "action": "config:DescribeComplianceByConfigRule",
      "condition": null
    },
    {
      "action": "config:DescribeConfigurationRecorders",
      "condition": null
    },
    {
      "action": "config:DescribeConfigurationRecorderStatus",
      "condition": null
    },
    {
      "action": "config:DescribeConfigRules",
      "condition": null
    },
    {
      "action": "config:DescribeConfigRuleEvaluationStatus",
      "condition": null
    },
    {
      "action": "config:PutConfigurationRecorder",
      "condition": null
    },
    {
      "action": "config:StartConfigurationRecorder",
      "condition": null
    },
    {
      "action": "config:PutDeliveryChannel",
      "condition": null
    },
    {
      "action": "config:DescribeDeliveryChannels",
      "condition": null
    },
    {
      "action": "config:DescribeDeliveryChannelStatus",
      "condition": null
    },
    {
      "action": "config:GetComplianceSummaryByConfigRule",
      "condition": null
    },
    {
      "action": "config:GetDiscoveredResourceCounts",
      "condition": null
    },
    {
      "action": "config:PutEvaluations",
      "condition": null
    },
    {
      "action": "config:SelectResourceConfig",
      "condition": null
    },
    {
      "action": "iam:DeleteServiceLinkedRole",
      "condition": null
    },
    {
      "action": "iam:GetServiceLinkedRoleDeletionStatus",
      "condition": null
    },
    {
      "action": "organizations:DescribeAccount",
      "condition": null
    },
    {
      "action": "organizations:DescribeOrganization",
      "condition": null
    },
    {
      "action": "organizations:ListAccounts",
      "condition": null
    },
    {
      "action": "organizations:DescribeOrganizationalUnit",
      "condition": null
    },
    {
      "action": "organizations:ListChildren",
      "condition": null
    },
    {
      "action": "organizations:ListRoots",
      "condition": null
    },
    {
      "action": "organizations:ListParents",
      "condition": null
    },
    {
      "action": "organizations:ListOrganizationalUnitsForParent",
      "condition": null
    },
    {
      "action": "organizations:ListAWSServiceAccessForOrganization",
      "condition": null
    },
    {
      "action": "shield:CreateProtection",
      "condition": null
    },
    {
      "action": "shield:DeleteProtection",
      "condition": null
    },
    {
      "action": "shield:DescribeProtection",
      "condition": null
    },
    {
      "action": "shield:ListProtections",
      "condition": null
    },
    {
      "action": "shield:ListAttacks",
      "condition": null
    },
    {
      "action": "shield:CreateSubscription",
      "condition": null
    },
    {
      "action": "shield:DescribeSubscription",
      "condition": null
    },
    {
      "action": "shield:GetSubscriptionState",
      "condition": null
    },
    {
      "action": "shield:DescribeDRTAccess",
      "condition": null
    },
    {
      "action": "shield:DescribeEmergencyContactSettings",
      "condition": null
    },
    {
      "action": "shield:UpdateEmergencyContactSettings",
      "condition": null
    },
    {
      "action": "elasticloadbalancing:DescribeLoadBalancers",
      "condition": null
    },
    {
      "action": "ec2:DescribeAddresses",
      "condition": null
    },
    {
      "action": "shield:EnableApplicationLayerAutomaticResponse",
      "condition": null
    },
    {
      "action": "shield:DisableApplicationLayerAutomaticResponse",
      "condition": null
    },
    {
      "action": "shield:UpdateApplicationLayerAutomaticResponse",
      "condition": null
    },
    {
      "action": "ec2:AuthorizeSecurityGroupEgress",
      "condition": null
    },
    {
      "action": "ec2:AuthorizeSecurityGroupIngress",
      "condition": null
    },
    {
      "action": "ec2:DeleteSecurityGroup",
      "condition": null
    },
    {
      "action": "ec2:RevokeSecurityGroupEgress",
      "condition": null
    },
    {
      "action": "ec2:RevokeSecurityGroupIngress",
      "condition": null
    },
    {
      "action": "ec2:UpdateSecurityGroupRuleDescriptionsEgress",
      "condition": null
    },
    {
      "action": "ec2:UpdateSecurityGroupRuleDescriptionsIngress",
      "condition": null
    },
    {
      "action": "ec2:CreateTags",
      "condition": {
        "StringEquals": {
          "ec2:CreateAction": "CreateSecurityGroup"
        }
      }
    },
    {
      "action": "ec2:DeleteTags",
      "condition": {
        "StringLike": {
          "aws:ResourceTag/FMManaged": "*"
        }
      }
    },
    {
      "action": "ec2:CreateTags",
      "condition": {
        "StringLike": {
          "aws:ResourceTag/FMManaged": "*"
        }
      }
    },
    {
      "action": "ec2:CreateSecurityGroup",
      "condition": null
    },
    {
      "action": "ec2:DescribeSecurityGroupReferences",
      "condition": null
    },
    {
      "action": "ec2:DescribeSecurityGroups",
      "condition": null
    },
    {
      "action": "ec2:DescribeStaleSecurityGroups",
      "condition": null
    },
    {
      "action": "ec2:DescribeNetworkInterfaces",
      "condition": null
    },
    {
      "action": "ec2:ModifyNetworkInterfaceAttribute",
      "condition": null
    },
    {
      "action": "ec2:DescribeVpcs",
      "condition": null
    },
    {
      "action": "ec2:DescribeVpcPeeringConnections",
      "condition": null
    },
    {
      "action": "ec2:DescribeNetworkInterfaceAttribute",
      "condition": null
    },
    {
      "action": "ec2:DescribeInstances",
      "condition": null
    },
    {
      "action": "ec2:AssociateRouteTable",
      "condition": null
    },
    {
      "action": "ec2:CreateSubnet",
      "condition": null
    },
    {
      "action": "ec2:CreateRouteTable",
      "condition": null
    },
    {
      "action": "ec2:DeleteSubnet",
      "condition": null
    },
    {
      "action": "ec2:DisassociateRouteTable",
      "condition": null
    },
    {
      "action": "ec2:ReplaceRouteTableAssociation",
      "condition": null
    },
    {
      "action": "wafv2:TagResource",
      "condition": null
    },
    {
      "action": "wafv2:ListResourcesForWebACL",
      "condition": null
    },
    {
      "action": "wafv2:AssociateWebACL",
      "condition": null
    },
    {
      "action": "wafv2:ListTagsForResource",
      "condition": null
    },
    {
      "action": "wafv2:UntagResource",
      "condition": null
    },
    {
      "action": "wafv2:GetWebACL",
      "condition": null
    },
    {
      "action": "wafv2:DisassociateFirewallManager",
      "condition": null
    },
    {
      "action": "wafv2:DeleteWebACL",
      "condition": null
    },
    {
      "action": "wafv2:DisassociateWebACL",
      "condition": null
    },
    {
      "action": "wafv2:UpdateWebACL",
      "condition": null
    },
    {
      "action": "wafv2:CreateWebACL",
      "condition": null
    },
    {
      "action": "wafv2:DeleteFirewallManagerRuleGroups",
      "condition": null
    },
    {
      "action": "wafv2:PutFirewallManagerRuleGroups",
      "condition": null
    },
    {
      "action": "wafv2:PutPermissionPolicy",
      "condition": null
    },
    {
      "action": "wafv2:GetPermissionPolicy",
      "condition": null
    },
    {
      "action": "wafv2:DeletePermissionPolicy",
      "condition": null
    },
    {
      "action": "wafv2:GetWebACLForResource",
      "condition": null
    },
    {
      "action": "ec2:CreateTags",
      "condition": {
        "ForAllValues:StringEquals": {
          "aws:TagKeys": [
            "Name",
            "FMManaged"
          ]
        },
        "StringEquals": {
          "ec2:CreateAction": "CreateRouteTable"
        }
      }
    },
    {
      "action": "ec2:CreateTags",
      "condition": {
        "ForAllValues:StringEquals": {
          "aws:TagKeys": [
            "Name",
            "FMManaged"
          ]
        }
      }
    },
    {
      "action": "ec2:CreateTags",
      "condition": {
        "ForAllValues:StringEquals": {
          "aws:TagKeys": [
            "Name",
            "FMManaged"
          ]
        },
        "StringEquals": {
          "ec2:CreateAction": "CreateVpcEndpoint"
        }
      }
    },
    {
      "action": "ec2:DeleteRouteTable",
      "condition": {
        "StringEquals": {
          "ec2:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ec2:DescribeInternetGateways",
      "condition": null
    },
    {
      "action": "ec2:DescribeRouteTables",
      "condition": null
    },
    {
      "action": "ec2:DescribeSubnets",
      "condition": null
    },
    {
      "action": "ec2:DescribeTags",
      "condition": null
    },
    {
      "action": "ec2:DescribeVpcEndpoints",
      "condition": null
    },
    {
      "action": "ec2:DescribeAvailabilityZones",
      "condition": null
    },
    {
      "action": "ec2:CreateVpcEndpoint",
      "condition": {
        "StringEquals": {
          "aws:RequestTag/FMManaged": [
            "true"
          ]
        }
      }
    },
    {
      "action": "ec2:CreateVpcEndpoint",
      "condition": null
    },
    {
      "action": "ec2:DeleteVpcEndpoints",
      "condition": {
        "StringEquals": {
          "ec2:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ram:TagResource",
      "condition": {
        "ForAllValues:StringEquals": {
          "aws:TagKeys": [
            "Name",
            "FMManaged"
          ]
        }
      }
    },
    {
      "action": "ram:AssociateResourceShare",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ram:UpdateResourceShare",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ram:DeleteResourceShare",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ram:CreateResourceShare",
      "condition": {
        "ForAllValues:StringEquals": {
          "aws:TagKeys": [
            "Name",
            "FMManaged"
          ]
        },
        "StringEquals": {
          "aws:RequestTag/FMManaged": [
            "true"
          ]
        }
      }
    },
    {
      "action": "ram:GetResourceShareAssociations",
      "condition": null
    },
    {
      "action": "ram:GetResourceShares",
      "condition": null
    },
    {
      "action": "iam:CreateServiceLinkedRole",
      "condition": {
        "StringEquals": {
          "iam:AWSServiceName": [
            "network-firewall.amazonaws.com",
            "shield.amazonaws.com"
          ]
        }
      }
    },
    {
      "action": "iam:GetRole",
      "condition": null
    },
    {
      "action": "network-firewall:TagResource",
      "condition": {
        "ForAllValues:StringEquals": {
          "aws:TagKeys": [
            "Name",
            "FMManaged"
          ]
        }
      }
    },
    {
      "action": "network-firewall:AssociateSubnets",
      "condition": null
    },
    {
      "action": "network-firewall:CreateFirewall",
      "condition": null
    },
    {
      "action": "network-firewall:CreateFirewallPolicy",
      "condition": null
    },
    {
      "action": "network-firewall:DisassociateSubnets",
      "condition": null
    },
    {
      "action": "network-firewall:UpdateFirewallDeleteProtection",
      "condition": null
    },
    {
      "action": "network-firewall:UpdateFirewallPolicy",
      "condition": null
    },
    {
      "action": "network-firewall:UpdateFirewallPolicyChangeProtection",
      "condition": null
    },
    {
      "action": "network-firewall:UpdateSubnetChangeProtection",
      "condition": null
    },
    {
      "action": "network-firewall:AssociateFirewallPolicy",
      "condition": null
    },
    {
      "action": "network-firewall:DescribeFirewall",
      "condition": null
    },
    {
      "action": "network-firewall:DescribeFirewallPolicy",
      "condition": null
    },
    {
      "action": "network-firewall:DescribeRuleGroup",
      "condition": null
    },
    {
      "action": "network-firewall:ListFirewallPolicies",
      "condition": null
    },
    {
      "action": "network-firewall:ListFirewalls",
      "condition": null
    },
    {
      "action": "network-firewall:ListRuleGroups",
      "condition": null
    },
    {
      "action": "network-firewall:PutResourcePolicy",
      "condition": null
    },
    {
      "action": "network-firewall:DescribeResourcePolicy",
      "condition": null
    },
    {
      "action": "network-firewall:DeleteResourcePolicy",
      "condition": null
    },
    {
      "action": "network-firewall:DescribeLoggingConfiguration",
      "condition": null
    },
    {
      "action": "network-firewall:UpdateLoggingConfiguration",
      "condition": null
    },
    {
      "action": "network-firewall:DeleteFirewallPolicy",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "network-firewall:DeleteFirewall",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "logs:ListLogDeliveries",
      "condition": null
    },
    {
      "action": "logs:CreateLogDelivery",
      "condition": null
    },
    {
      "action": "logs:GetLogDelivery",
      "condition": null
    },
    {
      "action": "logs:UpdateLogDelivery",
      "condition": null
    },
    {
      "action": "logs:DeleteLogDelivery",
      "condition": null
    },
    {
      "action": "route53resolver:ListFirewallRuleGroupAssociations",
      "condition": null
    },
    {
      "action": "route53resolver:ListTagsForResource",
      "condition": null
    },
    {
      "action": "route53resolver:ListFirewallRuleGroups",
      "condition": null
    },
    {
      "action": "route53resolver:GetFirewallRuleGroupAssociation",
      "condition": null
    },
    {
      "action": "route53resolver:GetFirewallRuleGroup",
      "condition": null
    },
    {
      "action": "route53resolver:GetFirewallRuleGroupPolicy",
      "condition": null
    },
    {
      "action": "route53resolver:PutFirewallRuleGroupPolicy",
      "condition": null
    },
    {
      "action": "route53resolver:UpdateFirewallRuleGroupAssociation",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "route53resolver:DisassociateFirewallRuleGroup",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "route53resolver:AssociateFirewallRuleGroup",
      "condition": {
        "StringEquals": {
          "aws:RequestTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "route53resolver:TagResource",
      "condition": {
        "StringEquals": {
          "aws:RequestTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ec2:CreateTags",
      "condition": {
        "ForAllValues:StringEquals": {
          "aws:TagKeys": [
            "Name",
            "FMManaged",
            "FMPolicies"
          ]
        },
        "StringEquals": {
          "ec2:CreateAction": "CreateNetworkAcl"
        }
      }
    },
    {
      "action": "ec2:CreateTags",
      "condition": {
        "ForAllValues:StringEquals": {
          "aws:TagKeys": [
            "Name",
            "FMManaged",
            "FMPolicies"
          ]
        },
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ec2:DeleteTags",
      "condition": {
        "ForAllValues:StringEquals": {
          "aws:TagKeys": [
            "Name",
            "FMManaged",
            "FMPolicies"
          ]
        },
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ec2:DeleteNetworkAclEntry",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ec2:CreateNetworkAclEntry",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ec2:ReplaceNetworkAclEntry",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ec2:DeleteNetworkAcl",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/FMManaged": "true"
        }
      }
    },
    {
      "action": "ec2:ReplaceNetworkAclAssociation",
      "condition": null
    },
    {
      "action": "ec2:DescribeNetworkAcls",
      "condition": null
    },
    {
      "action": "ec2:CreateNetworkAcl",
      "condition": null
    }
  ],
  "updatedate": "2024-04-22T19:12:13+00:00",
  "version": "v29"
}